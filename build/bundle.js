var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function i(){return Object.create(null)}function s(t){t.forEach(n)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a;function l(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function h(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function u(t){let e;return h(t,(t=>e=t))(),e}function c(t,e,n){t.$$.on_destroy.push(h(e,n))}function p(t){return null==t?"":t}function d(t,e,n){return t.set(n),e}const f="undefined"!=typeof window;let _=f?()=>window.performance.now():()=>Date.now(),m=f?t=>requestAnimationFrame(t):t;const g=new Set;function v(t){g.forEach((e=>{e.c(t)||(g.delete(e),e.f())})),0!==g.size&&m(v)}function y(t,e){t.appendChild(e)}function w(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function b(t){const e=A("style");return function(t,e){y(t.head||t,e)}(w(t),e),e.sheet}function x(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode.removeChild(t)}function C(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function A(t){return document.createElement(t)}function k(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function S(t){return document.createTextNode(t)}function M(){return S(" ")}function E(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function P(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function O(t){return""===t?null:+t}function I(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function D(t,e){t.value=null==e?"":e}function N(t,e){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e)return void(i.selected=!0)}t.selectedIndex=-1}function R(t,e,n){t.classList[n?"add":"remove"](e)}const z=new Map;let B,V=0;function F(t,e,n,i,s,o,r,a=0){const l=16.666/i;let h="{\n";for(let t=0;t<=1;t+=l){const i=e+(n-e)*o(t);h+=100*t+`%{${r(i,1-i)}}\n`}const u=h+`100% {${r(n,1-n)}}\n}`,c=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${a}`,p=w(t),{stylesheet:d,rules:f}=z.get(p)||function(t,e){const n={stylesheet:b(e),rules:{}};return z.set(t,n),n}(p,t);f[c]||(f[c]=!0,d.insertRule(`@keyframes ${c} ${u}`,d.cssRules.length));const _=t.style.animation||"";return t.style.animation=`${_?`${_}, `:""}${c} ${i}ms linear ${s}ms 1 both`,V+=1,c}function Z(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-i.length;s&&(t.style.animation=i.join(", "),V-=s,V||m((()=>{V||(z.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),z.clear())})))}function j(t){B=t}function q(t){(function(){if(!B)throw new Error("Function called outside component initialization");return B})().$$.on_mount.push(t)}const G=[],U=[],$=[],W=[],H=Promise.resolve();let X=!1;function Y(t){$.push(t)}const K=new Set;let Q,J=0;function tt(){const t=B;do{for(;J<G.length;){const t=G[J];J++,j(t),et(t.$$)}for(j(null),G.length=0,J=0;U.length;)U.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];K.has(e)||(K.add(e),e())}$.length=0}while(G.length);for(;W.length;)W.pop()();X=!1,K.clear(),j(t)}function et(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Y)}}function nt(t,e,n){t.dispatchEvent(function(t,e,n=!1){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,!1,e),i}(`${e?"intro":"outro"}${n}`))}const it=new Set;let st;function ot(){st={r:0,c:[],p:st}}function rt(){st.r||s(st.c),st=st.p}function at(t,e){t&&t.i&&(it.delete(t),t.i(e))}function lt(t,e,n,i){if(t&&t.o){if(it.has(t))return;it.add(t),st.c.push((()=>{it.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}const ht={duration:0};function ut(n,i,r,a){let l=i(n,r),h=a?0:1,u=null,c=null,p=null;function d(){p&&Z(n,p)}function f(t,e){const n=t.b-h;return e*=Math.abs(n),{a:h,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function y(i){const{delay:o=0,duration:r=300,easing:a=e,tick:y=t,css:w}=l||ht,b={start:_()+o,b:i};i||(b.group=st,st.r+=1),u||c?c=b:(w&&(d(),p=F(n,h,i,r,o,a,w)),i&&y(0,1),u=f(b,r),Y((()=>nt(n,i,"start"))),function(t){let e;0===g.size&&m(v),new Promise((n=>{g.add(e={c:t,f:n})}))}((t=>{if(c&&t>c.start&&(u=f(c,r),c=null,nt(n,u.b,"start"),w&&(d(),p=F(n,h,u.b,u.duration,0,a,l.css))),u)if(t>=u.end)y(h=u.b,1-h),nt(n,u.b,"end"),c||(u.b?d():--u.group.r||s(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;h=u.a+u.d*a(e/u.duration),y(h,1-h)}return!(!u&&!c)})))}return{run(t){o(l)?(Q||(Q=Promise.resolve(),Q.then((()=>{Q=null}))),Q).then((()=>{l=l(),y(t)})):y(t)},end(){d(),u=c=null}}}function ct(t){t&&t.c()}function pt(t,e,i,r){const{fragment:a,on_mount:l,on_destroy:h,after_update:u}=t.$$;a&&a.m(e,i),r||Y((()=>{const e=l.map(n).filter(o);h?h.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(Y)}function dt(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ft(t,e){-1===t.$$.dirty[0]&&(G.push(t),X||(X=!0,H.then(tt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function _t(e,n,o,r,a,l,h,u=[-1]){const c=B;j(e);const p=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(c?c.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||c.$$.root};h&&h(p.root);let d=!1;if(p.ctx=o?o(e,n.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),d&&ft(e,t)),n})):[],p.update(),d=!0,s(p.before_update),p.fragment=!!r&&r(p.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);p.fragment&&p.fragment.l(t),t.forEach(T)}else p.fragment&&p.fragment.c();n.intro&&at(e.$$.fragment),pt(e,n.target,n.anchor,n.customElement),tt()}j(c)}class mt{$destroy(){dt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const gt=[];function vt(e,n=t){let i;const s=new Set;function o(t){if(r(e,t)&&(e=t,i)){const t=!gt.length;for(const t of s)t[1](),gt.push(t,e);if(t){for(let t=0;t<gt.length;t+=2)gt[t][0](gt[t+1]);gt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(r,a=t){const l=[r,a];return s.add(l),1===s.size&&(i=n(o)||t),r(e),()=>{s.delete(l),0===s.size&&(i(),i=null)}}}}function yt(e,n,i){const r=!Array.isArray(e),a=r?[e]:e,l=n.length<2;return function(t,e){return{subscribe:vt(t,e).subscribe}}(i,(e=>{let i=!1;const u=[];let c=0,p=t;const d=()=>{if(c)return;p();const i=n(r?u[0]:u,e);l?e(i):p=o(i)?i:t},f=a.map(((t,e)=>h(t,(t=>{u[e]=t,c&=~(1<<e),i&&d()}),(()=>{c|=1<<e}))));return i=!0,d(),function(){s(f),p()}}))}var wt=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===bt}(t)}(t)};var bt="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function xt(t,e){return!1!==e.clone&&e.isMergeableObject(t)?St((n=t,Array.isArray(n)?[]:{}),t,e):t;var n}function Tt(t,e,n){return t.concat(e).map((function(t){return xt(t,n)}))}function Ct(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function At(t,e){try{return e in t}catch(t){return!1}}function kt(t,e,n){var i={};return n.isMergeableObject(t)&&Ct(t).forEach((function(e){i[e]=xt(t[e],n)})),Ct(e).forEach((function(s){(function(t,e){return At(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,s)||(At(t,s)&&n.isMergeableObject(e[s])?i[s]=function(t,e){if(!e.customMerge)return St;var n=e.customMerge(t);return"function"==typeof n?n:St}(s,n)(t[s],e[s],n):i[s]=xt(e[s],n))})),i}function St(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||Tt,n.isMergeableObject=n.isMergeableObject||wt,n.cloneUnlessOtherwiseSpecified=xt;var i=Array.isArray(e);return i===Array.isArray(t)?i?n.arrayMerge(t,e,n):kt(t,e,n):xt(e,n)}St.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,n){return St(t,n,e)}),{})};var Mt=St,Et=function(t,e){return Et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Et(t,e)};function Lt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Et(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Pt,Ot,It,Dt=function(){return Dt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},Dt.apply(this,arguments)};function Nt(t,e,n,i){var s,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(o<3?s(r):o>3?s(e,n,r):s(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r}function Rt(t,e,n,i){return new(n||(n=Promise))((function(s,o){function r(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))}function zt(t,e,n){if(n||2===arguments.length)for(var i,s=0,o=e.length;s<o;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}function Bt(t){return t.type===Ot.literal}function Vt(t){return t.type===Ot.argument}function Ft(t){return t.type===Ot.number}function Zt(t){return t.type===Ot.date}function jt(t){return t.type===Ot.time}function qt(t){return t.type===Ot.select}function Gt(t){return t.type===Ot.plural}function Ut(t){return t.type===Ot.pound}function $t(t){return t.type===Ot.tag}function Wt(t){return!(!t||"object"!=typeof t||t.type!==It.number)}function Ht(t){return!(!t||"object"!=typeof t||t.type!==It.dateTime)}!function(t){t[t.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",t[t.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",t[t.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",t[t.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",t[t.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",t[t.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",t[t.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",t[t.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",t[t.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",t[t.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",t[t.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",t[t.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",t[t.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",t[t.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",t[t.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",t[t.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",t[t.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",t[t.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",t[t.INVALID_TAG=23]="INVALID_TAG",t[t.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",t[t.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",t[t.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(Pt||(Pt={})),function(t){t[t.literal=0]="literal",t[t.argument=1]="argument",t[t.number=2]="number",t[t.date=3]="date",t[t.time=4]="time",t[t.select=5]="select",t[t.plural=6]="plural",t[t.pound=7]="pound",t[t.tag=8]="tag"}(Ot||(Ot={})),function(t){t[t.number=0]="number",t[t.dateTime=1]="dateTime"}(It||(It={}));var Xt=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Yt=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Kt(t){var e={};return t.replace(Yt,(function(t){var n=t.length;switch(t[0]){case"G":e.era=4===n?"long":5===n?"narrow":"short";break;case"y":e.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":e.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":e.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":e.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");e.weekday=["short","long","narrow","short"][n-4];break;case"a":e.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":e.hourCycle="h12",e.hour=["numeric","2-digit"][n-1];break;case"H":e.hourCycle="h23",e.hour=["numeric","2-digit"][n-1];break;case"K":e.hourCycle="h11",e.hour=["numeric","2-digit"][n-1];break;case"k":e.hourCycle="h24",e.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":e.minute=["numeric","2-digit"][n-1];break;case"s":e.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":e.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),e}var Qt=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function Jt(t){return t.replace(/^(.*?)-/,"")}var te,ee=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,ne=/^(@+)?(\+|#+)?[rs]?$/g,ie=/(\*)(0+)|(#+)(0+)|(0+)/g,se=/^(0+)$/;function oe(t){var e={};return"r"===t[t.length-1]?e.roundingPriority="morePrecision":"s"===t[t.length-1]&&(e.roundingPriority="lessPrecision"),t.replace(ne,(function(t,n,i){return"string"!=typeof i?(e.minimumSignificantDigits=n.length,e.maximumSignificantDigits=n.length):"+"===i?e.minimumSignificantDigits=n.length:"#"===n[0]?e.maximumSignificantDigits=n.length:(e.minimumSignificantDigits=n.length,e.maximumSignificantDigits=n.length+("string"==typeof i?i.length:0)),""})),e}function re(t){switch(t){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function ae(t){var e;if("E"===t[0]&&"E"===t[1]?(e={notation:"engineering"},t=t.slice(2)):"E"===t[0]&&(e={notation:"scientific"},t=t.slice(1)),e){var n=t.slice(0,2);if("+!"===n?(e.signDisplay="always",t=t.slice(2)):"+?"===n&&(e.signDisplay="exceptZero",t=t.slice(2)),!se.test(t))throw new Error("Malformed concise eng/scientific notation");e.minimumIntegerDigits=t.length}return e}function le(t){var e=re(t);return e||{}}function he(t){for(var e={},n=0,i=t;n<i.length;n++){var s=i[n];switch(s.stem){case"percent":case"%":e.style="percent";continue;case"%x100":e.style="percent",e.scale=100;continue;case"currency":e.style="currency",e.currency=s.options[0];continue;case"group-off":case",_":e.useGrouping=!1;continue;case"precision-integer":case".":e.maximumFractionDigits=0;continue;case"measure-unit":case"unit":e.style="unit",e.unit=Jt(s.options[0]);continue;case"compact-short":case"K":e.notation="compact",e.compactDisplay="short";continue;case"compact-long":case"KK":e.notation="compact",e.compactDisplay="long";continue;case"scientific":e=Dt(Dt(Dt({},e),{notation:"scientific"}),s.options.reduce((function(t,e){return Dt(Dt({},t),le(e))}),{}));continue;case"engineering":e=Dt(Dt(Dt({},e),{notation:"engineering"}),s.options.reduce((function(t,e){return Dt(Dt({},t),le(e))}),{}));continue;case"notation-simple":e.notation="standard";continue;case"unit-width-narrow":e.currencyDisplay="narrowSymbol",e.unitDisplay="narrow";continue;case"unit-width-short":e.currencyDisplay="code",e.unitDisplay="short";continue;case"unit-width-full-name":e.currencyDisplay="name",e.unitDisplay="long";continue;case"unit-width-iso-code":e.currencyDisplay="symbol";continue;case"scale":e.scale=parseFloat(s.options[0]);continue;case"integer-width":if(s.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");s.options[0].replace(ie,(function(t,n,i,s,o,r){if(n)e.minimumIntegerDigits=i.length;else{if(s&&o)throw new Error("We currently do not support maximum integer digits");if(r)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(se.test(s.stem))e.minimumIntegerDigits=s.stem.length;else if(ee.test(s.stem)){if(s.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");s.stem.replace(ee,(function(t,n,i,s,o,r){return"*"===i?e.minimumFractionDigits=n.length:s&&"#"===s[0]?e.maximumFractionDigits=s.length:o&&r?(e.minimumFractionDigits=o.length,e.maximumFractionDigits=o.length+r.length):(e.minimumFractionDigits=n.length,e.maximumFractionDigits=n.length),""}));var o=s.options[0];"w"===o?e=Dt(Dt({},e),{trailingZeroDisplay:"stripIfInteger"}):o&&(e=Dt(Dt({},e),oe(o)))}else if(ne.test(s.stem))e=Dt(Dt({},e),oe(s.stem));else{var r=re(s.stem);r&&(e=Dt(Dt({},e),r));var a=ae(s.stem);a&&(e=Dt(Dt({},e),a))}}return e}var ue=new RegExp("^".concat(Xt.source,"*")),ce=new RegExp("".concat(Xt.source,"*$"));function pe(t,e){return{start:t,end:e}}var de=!!String.prototype.startsWith,fe=!!String.fromCodePoint,_e=!!Object.fromEntries,me=!!String.prototype.codePointAt,ge=!!String.prototype.trimStart,ve=!!String.prototype.trimEnd,ye=!!Number.isSafeInteger?Number.isSafeInteger:function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<=9007199254740991},we=!0;try{we="a"===(null===(te=Me("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===te?void 0:te[0])}catch(t){we=!1}var be,xe=de?function(t,e,n){return t.startsWith(e,n)}:function(t,e,n){return t.slice(n,n+e.length)===e},Te=fe?String.fromCodePoint:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,i="",s=t.length,o=0;s>o;){if((n=t[o++])>1114111)throw RangeError(n+" is not a valid code point");i+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return i},Ce=_e?Object.fromEntries:function(t){for(var e={},n=0,i=t;n<i.length;n++){var s=i[n],o=s[0],r=s[1];e[o]=r}return e},Ae=me?function(t,e){return t.codePointAt(e)}:function(t,e){var n=t.length;if(!(e<0||e>=n)){var i,s=t.charCodeAt(e);return s<55296||s>56319||e+1===n||(i=t.charCodeAt(e+1))<56320||i>57343?s:i-56320+(s-55296<<10)+65536}},ke=ge?function(t){return t.trimStart()}:function(t){return t.replace(ue,"")},Se=ve?function(t){return t.trimEnd()}:function(t){return t.replace(ce,"")};function Me(t,e){return new RegExp(t,e)}if(we){var Ee=Me("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");be=function(t,e){var n;return Ee.lastIndex=e,null!==(n=Ee.exec(t)[1])&&void 0!==n?n:""}}else be=function(t,e){for(var n=[];;){var i=Ae(t,e);if(void 0===i||Ie(i)||De(i))break;n.push(i),e+=i>=65536?2:1}return Te.apply(void 0,n)};var Le=function(){function t(t,e){void 0===e&&(e={}),this.message=t,this.position={offset:0,line:1,column:1},this.ignoreTag=!!e.ignoreTag,this.requiresOtherClause=!!e.requiresOtherClause,this.shouldParseSkeletons=!!e.shouldParseSkeletons}return t.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},t.prototype.parseMessage=function(t,e,n){for(var i=[];!this.isEOF();){var s=this.char();if(123===s){if((o=this.parseArgument(t,n)).err)return o;i.push(o.val)}else{if(125===s&&t>0)break;if(35!==s||"plural"!==e&&"selectordinal"!==e){if(60===s&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(Pt.UNMATCHED_CLOSING_TAG,pe(this.clonePosition(),this.clonePosition()))}if(60===s&&!this.ignoreTag&&Pe(this.peek()||0)){if((o=this.parseTag(t,e)).err)return o;i.push(o.val)}else{var o;if((o=this.parseLiteral(t,e)).err)return o;i.push(o.val)}}else{var r=this.clonePosition();this.bump(),i.push({type:Ot.pound,location:pe(r,this.clonePosition())})}}}return{val:i,err:null}},t.prototype.parseTag=function(t,e){var n=this.clonePosition();this.bump();var i=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Ot.literal,value:"<".concat(i,"/>"),location:pe(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var s=this.parseMessage(t+1,e,!0);if(s.err)return s;var o=s.val,r=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!Pe(this.char()))return this.error(Pt.INVALID_TAG,pe(r,this.clonePosition()));var a=this.clonePosition();return i!==this.parseTagName()?this.error(Pt.UNMATCHED_CLOSING_TAG,pe(a,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Ot.tag,value:i,children:o,location:pe(n,this.clonePosition())},err:null}:this.error(Pt.INVALID_TAG,pe(r,this.clonePosition())))}return this.error(Pt.UNCLOSED_TAG,pe(n,this.clonePosition()))}return this.error(Pt.INVALID_TAG,pe(n,this.clonePosition()))},t.prototype.parseTagName=function(){var t=this.offset();for(this.bump();!this.isEOF()&&Oe(this.char());)this.bump();return this.message.slice(t,this.offset())},t.prototype.parseLiteral=function(t,e){for(var n=this.clonePosition(),i="";;){var s=this.tryParseQuote(e);if(s)i+=s;else{var o=this.tryParseUnquoted(t,e);if(o)i+=o;else{var r=this.tryParseLeftAngleBracket();if(!r)break;i+=r}}}var a=pe(n,this.clonePosition());return{val:{type:Ot.literal,value:i,location:a},err:null}},t.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(Pe(t=this.peek()||0)||47===t)?null:(this.bump(),"<");var t},t.prototype.tryParseQuote=function(t){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===t||"selectordinal"===t)break;return null;default:return null}this.bump();var e=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}e.push(39),this.bump()}else e.push(n);this.bump()}return Te.apply(void 0,e)},t.prototype.tryParseUnquoted=function(t,e){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===e||"selectordinal"===e)||125===n&&t>0?null:(this.bump(),Te(n))},t.prototype.parseArgument=function(t,e){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(Pt.EXPECT_ARGUMENT_CLOSING_BRACE,pe(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(Pt.EMPTY_ARGUMENT,pe(n,this.clonePosition()));var i=this.parseIdentifierIfPossible().value;if(!i)return this.error(Pt.MALFORMED_ARGUMENT,pe(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(Pt.EXPECT_ARGUMENT_CLOSING_BRACE,pe(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Ot.argument,value:i,location:pe(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(Pt.EXPECT_ARGUMENT_CLOSING_BRACE,pe(n,this.clonePosition())):this.parseArgumentOptions(t,e,i,n);default:return this.error(Pt.MALFORMED_ARGUMENT,pe(n,this.clonePosition()))}},t.prototype.parseIdentifierIfPossible=function(){var t=this.clonePosition(),e=this.offset(),n=be(this.message,e),i=e+n.length;return this.bumpTo(i),{value:n,location:pe(t,this.clonePosition())}},t.prototype.parseArgumentOptions=function(t,e,n,i){var s,o=this.clonePosition(),r=this.parseIdentifierIfPossible().value,a=this.clonePosition();switch(r){case"":return this.error(Pt.EXPECT_ARGUMENT_TYPE,pe(o,a));case"number":case"date":case"time":this.bumpSpace();var l=null;if(this.bumpIf(",")){this.bumpSpace();var h=this.clonePosition();if((m=this.parseSimpleArgStyleIfPossible()).err)return m;if(0===(p=Se(m.val)).length)return this.error(Pt.EXPECT_ARGUMENT_STYLE,pe(this.clonePosition(),this.clonePosition()));l={style:p,styleLocation:pe(h,this.clonePosition())}}if((g=this.tryParseArgumentClose(i)).err)return g;var u=pe(i,this.clonePosition());if(l&&xe(null==l?void 0:l.style,"::",0)){var c=ke(l.style.slice(2));if("number"===r)return(m=this.parseNumberSkeletonFromString(c,l.styleLocation)).err?m:{val:{type:Ot.number,value:n,location:u,style:m.val},err:null};if(0===c.length)return this.error(Pt.EXPECT_DATE_TIME_SKELETON,u);var p={type:It.dateTime,pattern:c,location:l.styleLocation,parsedOptions:this.shouldParseSkeletons?Kt(c):{}};return{val:{type:"date"===r?Ot.date:Ot.time,value:n,location:u,style:p},err:null}}return{val:{type:"number"===r?Ot.number:"date"===r?Ot.date:Ot.time,value:n,location:u,style:null!==(s=null==l?void 0:l.style)&&void 0!==s?s:null},err:null};case"plural":case"selectordinal":case"select":var d=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(Pt.EXPECT_SELECT_ARGUMENT_OPTIONS,pe(d,Dt({},d)));this.bumpSpace();var f=this.parseIdentifierIfPossible(),_=0;if("select"!==r&&"offset"===f.value){if(!this.bumpIf(":"))return this.error(Pt.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,pe(this.clonePosition(),this.clonePosition()));var m;if(this.bumpSpace(),(m=this.tryParseDecimalInteger(Pt.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,Pt.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return m;this.bumpSpace(),f=this.parseIdentifierIfPossible(),_=m.val}var g,v=this.tryParsePluralOrSelectOptions(t,r,e,f);if(v.err)return v;if((g=this.tryParseArgumentClose(i)).err)return g;var y=pe(i,this.clonePosition());return"select"===r?{val:{type:Ot.select,value:n,options:Ce(v.val),location:y},err:null}:{val:{type:Ot.plural,value:n,options:Ce(v.val),offset:_,pluralType:"plural"===r?"cardinal":"ordinal",location:y},err:null};default:return this.error(Pt.INVALID_ARGUMENT_TYPE,pe(o,a))}},t.prototype.tryParseArgumentClose=function(t){return this.isEOF()||125!==this.char()?this.error(Pt.EXPECT_ARGUMENT_CLOSING_BRACE,pe(t,this.clonePosition())):(this.bump(),{val:!0,err:null})},t.prototype.parseSimpleArgStyleIfPossible=function(){for(var t=0,e=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(Pt.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,pe(n,this.clonePosition()));this.bump();break;case 123:t+=1,this.bump();break;case 125:if(!(t>0))return{val:this.message.slice(e.offset,this.offset()),err:null};t-=1;break;default:this.bump()}}return{val:this.message.slice(e.offset,this.offset()),err:null}},t.prototype.parseNumberSkeletonFromString=function(t,e){var n=[];try{n=function(t){if(0===t.length)throw new Error("Number skeleton cannot be empty");for(var e=t.split(Qt).filter((function(t){return t.length>0})),n=[],i=0,s=e;i<s.length;i++){var o=s[i].split("/");if(0===o.length)throw new Error("Invalid number skeleton");for(var r=o[0],a=o.slice(1),l=0,h=a;l<h.length;l++)if(0===h[l].length)throw new Error("Invalid number skeleton");n.push({stem:r,options:a})}return n}(t)}catch(t){return this.error(Pt.INVALID_NUMBER_SKELETON,e)}return{val:{type:It.number,tokens:n,location:e,parsedOptions:this.shouldParseSkeletons?he(n):{}},err:null}},t.prototype.tryParsePluralOrSelectOptions=function(t,e,n,i){for(var s,o=!1,r=[],a=new Set,l=i.value,h=i.location;;){if(0===l.length){var u=this.clonePosition();if("select"===e||!this.bumpIf("="))break;var c=this.tryParseDecimalInteger(Pt.EXPECT_PLURAL_ARGUMENT_SELECTOR,Pt.INVALID_PLURAL_ARGUMENT_SELECTOR);if(c.err)return c;h=pe(u,this.clonePosition()),l=this.message.slice(u.offset,this.offset())}if(a.has(l))return this.error("select"===e?Pt.DUPLICATE_SELECT_ARGUMENT_SELECTOR:Pt.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,h);"other"===l&&(o=!0),this.bumpSpace();var p=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===e?Pt.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:Pt.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,pe(this.clonePosition(),this.clonePosition()));var d=this.parseMessage(t+1,e,n);if(d.err)return d;var f=this.tryParseArgumentClose(p);if(f.err)return f;r.push([l,{value:d.val,location:pe(p,this.clonePosition())}]),a.add(l),this.bumpSpace(),l=(s=this.parseIdentifierIfPossible()).value,h=s.location}return 0===r.length?this.error("select"===e?Pt.EXPECT_SELECT_ARGUMENT_SELECTOR:Pt.EXPECT_PLURAL_ARGUMENT_SELECTOR,pe(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(Pt.MISSING_OTHER_CLAUSE,pe(this.clonePosition(),this.clonePosition())):{val:r,err:null}},t.prototype.tryParseDecimalInteger=function(t,e){var n=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var s=!1,o=0;!this.isEOF();){var r=this.char();if(!(r>=48&&r<=57))break;s=!0,o=10*o+(r-48),this.bump()}var a=pe(i,this.clonePosition());return s?ye(o*=n)?{val:o,err:null}:this.error(e,a):this.error(t,a)},t.prototype.offset=function(){return this.position.offset},t.prototype.isEOF=function(){return this.offset()===this.message.length},t.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},t.prototype.char=function(){var t=this.position.offset;if(t>=this.message.length)throw Error("out of bound");var e=Ae(this.message,t);if(void 0===e)throw Error("Offset ".concat(t," is at invalid UTF-16 code unit boundary"));return e},t.prototype.error=function(t,e){return{val:null,err:{kind:t,message:this.message,location:e}}},t.prototype.bump=function(){if(!this.isEOF()){var t=this.char();10===t?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=t<65536?1:2)}},t.prototype.bumpIf=function(t){if(xe(this.message,t,this.offset())){for(var e=0;e<t.length;e++)this.bump();return!0}return!1},t.prototype.bumpUntil=function(t){var e=this.offset(),n=this.message.indexOf(t,e);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},t.prototype.bumpTo=function(t){if(this.offset()>t)throw Error("targetOffset ".concat(t," must be greater than or equal to the current offset ").concat(this.offset()));for(t=Math.min(t,this.message.length);;){var e=this.offset();if(e===t)break;if(e>t)throw Error("targetOffset ".concat(t," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},t.prototype.bumpSpace=function(){for(;!this.isEOF()&&Ie(this.char());)this.bump()},t.prototype.peek=function(){if(this.isEOF())return null;var t=this.char(),e=this.offset(),n=this.message.charCodeAt(e+(t>=65536?2:1));return null!=n?n:null},t}();function Pe(t){return t>=97&&t<=122||t>=65&&t<=90}function Oe(t){return 45===t||46===t||t>=48&&t<=57||95===t||t>=97&&t<=122||t>=65&&t<=90||183==t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function Ie(t){return t>=9&&t<=13||32===t||133===t||t>=8206&&t<=8207||8232===t||8233===t}function De(t){return t>=33&&t<=35||36===t||t>=37&&t<=39||40===t||41===t||42===t||43===t||44===t||45===t||t>=46&&t<=47||t>=58&&t<=59||t>=60&&t<=62||t>=63&&t<=64||91===t||92===t||93===t||94===t||96===t||123===t||124===t||125===t||126===t||161===t||t>=162&&t<=165||166===t||167===t||169===t||171===t||172===t||174===t||176===t||177===t||182===t||187===t||191===t||215===t||247===t||t>=8208&&t<=8213||t>=8214&&t<=8215||8216===t||8217===t||8218===t||t>=8219&&t<=8220||8221===t||8222===t||8223===t||t>=8224&&t<=8231||t>=8240&&t<=8248||8249===t||8250===t||t>=8251&&t<=8254||t>=8257&&t<=8259||8260===t||8261===t||8262===t||t>=8263&&t<=8273||8274===t||8275===t||t>=8277&&t<=8286||t>=8592&&t<=8596||t>=8597&&t<=8601||t>=8602&&t<=8603||t>=8604&&t<=8607||8608===t||t>=8609&&t<=8610||8611===t||t>=8612&&t<=8613||8614===t||t>=8615&&t<=8621||8622===t||t>=8623&&t<=8653||t>=8654&&t<=8655||t>=8656&&t<=8657||8658===t||8659===t||8660===t||t>=8661&&t<=8691||t>=8692&&t<=8959||t>=8960&&t<=8967||8968===t||8969===t||8970===t||8971===t||t>=8972&&t<=8991||t>=8992&&t<=8993||t>=8994&&t<=9e3||9001===t||9002===t||t>=9003&&t<=9083||9084===t||t>=9085&&t<=9114||t>=9115&&t<=9139||t>=9140&&t<=9179||t>=9180&&t<=9185||t>=9186&&t<=9254||t>=9255&&t<=9279||t>=9280&&t<=9290||t>=9291&&t<=9311||t>=9472&&t<=9654||9655===t||t>=9656&&t<=9664||9665===t||t>=9666&&t<=9719||t>=9720&&t<=9727||t>=9728&&t<=9838||9839===t||t>=9840&&t<=10087||10088===t||10089===t||10090===t||10091===t||10092===t||10093===t||10094===t||10095===t||10096===t||10097===t||10098===t||10099===t||10100===t||10101===t||t>=10132&&t<=10175||t>=10176&&t<=10180||10181===t||10182===t||t>=10183&&t<=10213||10214===t||10215===t||10216===t||10217===t||10218===t||10219===t||10220===t||10221===t||10222===t||10223===t||t>=10224&&t<=10239||t>=10240&&t<=10495||t>=10496&&t<=10626||10627===t||10628===t||10629===t||10630===t||10631===t||10632===t||10633===t||10634===t||10635===t||10636===t||10637===t||10638===t||10639===t||10640===t||10641===t||10642===t||10643===t||10644===t||10645===t||10646===t||10647===t||10648===t||t>=10649&&t<=10711||10712===t||10713===t||10714===t||10715===t||t>=10716&&t<=10747||10748===t||10749===t||t>=10750&&t<=11007||t>=11008&&t<=11055||t>=11056&&t<=11076||t>=11077&&t<=11078||t>=11079&&t<=11084||t>=11085&&t<=11123||t>=11124&&t<=11125||t>=11126&&t<=11157||11158===t||t>=11159&&t<=11263||t>=11776&&t<=11777||11778===t||11779===t||11780===t||11781===t||t>=11782&&t<=11784||11785===t||11786===t||11787===t||11788===t||11789===t||t>=11790&&t<=11798||11799===t||t>=11800&&t<=11801||11802===t||11803===t||11804===t||11805===t||t>=11806&&t<=11807||11808===t||11809===t||11810===t||11811===t||11812===t||11813===t||11814===t||11815===t||11816===t||11817===t||t>=11818&&t<=11822||11823===t||t>=11824&&t<=11833||t>=11834&&t<=11835||t>=11836&&t<=11839||11840===t||11841===t||11842===t||t>=11843&&t<=11855||t>=11856&&t<=11857||11858===t||t>=11859&&t<=11903||t>=12289&&t<=12291||12296===t||12297===t||12298===t||12299===t||12300===t||12301===t||12302===t||12303===t||12304===t||12305===t||t>=12306&&t<=12307||12308===t||12309===t||12310===t||12311===t||12312===t||12313===t||12314===t||12315===t||12316===t||12317===t||t>=12318&&t<=12319||12320===t||12336===t||64830===t||64831===t||t>=65093&&t<=65094}function Ne(t){t.forEach((function(t){if(delete t.location,qt(t)||Gt(t))for(var e in t.options)delete t.options[e].location,Ne(t.options[e].value);else Ft(t)&&Wt(t.style)||(Zt(t)||jt(t))&&Ht(t.style)?delete t.style.location:$t(t)&&Ne(t.children)}))}function Re(t,e){void 0===e&&(e={}),e=Dt({shouldParseSkeletons:!0,requiresOtherClause:!0},e);var n=new Le(t,e).parse();if(n.err){var i=SyntaxError(Pt[n.err.kind]);throw i.location=n.err.location,i.originalMessage=n.err.message,i}return(null==e?void 0:e.captureLocation)||Ne(n.val),n.val}function ze(t,e){var n=e&&e.cache?e.cache:Ue,i=e&&e.serializer?e.serializer:je;return(e&&e.strategy?e.strategy:Ze)(t,{cache:n,serializer:i})}function Be(t,e,n,i){var s,o=null==(s=i)||"number"==typeof s||"boolean"==typeof s?i:n(i),r=e.get(o);return void 0===r&&(r=t.call(this,i),e.set(o,r)),r}function Ve(t,e,n){var i=Array.prototype.slice.call(arguments,3),s=n(i),o=e.get(s);return void 0===o&&(o=t.apply(this,i),e.set(s,o)),o}function Fe(t,e,n,i,s){return n.bind(e,t,i,s)}function Ze(t,e){return Fe(t,this,1===t.length?Be:Ve,e.cache.create(),e.serializer)}var je=function(){return JSON.stringify(arguments)};function qe(){this.cache=Object.create(null)}qe.prototype.get=function(t){return this.cache[t]},qe.prototype.set=function(t,e){this.cache[t]=e};var Ge,Ue={create:function(){return new qe}},$e={variadic:function(t,e){return Fe(t,this,Ve,e.cache.create(),e.serializer)},monadic:function(t,e){return Fe(t,this,Be,e.cache.create(),e.serializer)}};!function(t){t.MISSING_VALUE="MISSING_VALUE",t.INVALID_VALUE="INVALID_VALUE",t.MISSING_INTL_API="MISSING_INTL_API"}(Ge||(Ge={}));var We,He=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.code=n,s.originalMessage=i,s}return Lt(e,t),e.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},e}(Error),Xe=function(t){function e(e,n,i,s){return t.call(this,'Invalid values for "'.concat(e,'": "').concat(n,'". Options are "').concat(Object.keys(i).join('", "'),'"'),Ge.INVALID_VALUE,s)||this}return Lt(e,t),e}(He),Ye=function(t){function e(e,n,i){return t.call(this,'Value for "'.concat(e,'" must be of type ').concat(n),Ge.INVALID_VALUE,i)||this}return Lt(e,t),e}(He),Ke=function(t){function e(e,n){return t.call(this,'The intl string context variable "'.concat(e,'" was not provided to the string "').concat(n,'"'),Ge.MISSING_VALUE,n)||this}return Lt(e,t),e}(He);function Qe(t){return"function"==typeof t}function Je(t,e,n,i,s,o,r){if(1===t.length&&Bt(t[0]))return[{type:We.literal,value:t[0].value}];for(var a=[],l=0,h=t;l<h.length;l++){var u=h[l];if(Bt(u))a.push({type:We.literal,value:u.value});else if(Ut(u))"number"==typeof o&&a.push({type:We.literal,value:n.getNumberFormat(e).format(o)});else{var c=u.value;if(!s||!(c in s))throw new Ke(c,r);var p=s[c];if(Vt(u))p&&"string"!=typeof p&&"number"!=typeof p||(p="string"==typeof p||"number"==typeof p?String(p):""),a.push({type:"string"==typeof p?We.literal:We.object,value:p});else if(Zt(u)){var d="string"==typeof u.style?i.date[u.style]:Ht(u.style)?u.style.parsedOptions:void 0;a.push({type:We.literal,value:n.getDateTimeFormat(e,d).format(p)})}else if(jt(u)){d="string"==typeof u.style?i.time[u.style]:Ht(u.style)?u.style.parsedOptions:void 0;a.push({type:We.literal,value:n.getDateTimeFormat(e,d).format(p)})}else if(Ft(u)){(d="string"==typeof u.style?i.number[u.style]:Wt(u.style)?u.style.parsedOptions:void 0)&&d.scale&&(p*=d.scale||1),a.push({type:We.literal,value:n.getNumberFormat(e,d).format(p)})}else{if($t(u)){var f=u.children,_=u.value,m=s[_];if(!Qe(m))throw new Ye(_,"function",r);var g=m(Je(f,e,n,i,s,o).map((function(t){return t.value})));Array.isArray(g)||(g=[g]),a.push.apply(a,g.map((function(t){return{type:"string"==typeof t?We.literal:We.object,value:t}})))}if(qt(u)){if(!(v=u.options[p]||u.options.other))throw new Xe(u.value,p,Object.keys(u.options),r);a.push.apply(a,Je(v.value,e,n,i,s))}else if(Gt(u)){var v;if(!(v=u.options["=".concat(p)])){if(!Intl.PluralRules)throw new He('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',Ge.MISSING_INTL_API,r);var y=n.getPluralRules(e,{type:u.pluralType}).select(p-(u.offset||0));v=u.options[y]||u.options.other}if(!v)throw new Xe(u.value,p,Object.keys(u.options),r);a.push.apply(a,Je(v.value,e,n,i,s,p-(u.offset||0)))}else;}}}return function(t){return t.length<2?t:t.reduce((function(t,e){var n=t[t.length-1];return n&&n.type===We.literal&&e.type===We.literal?n.value+=e.value:t.push(e),t}),[])}(a)}function tn(t,e){return e?Object.keys(t).reduce((function(n,i){var s,o;return n[i]=(s=t[i],(o=e[i])?Dt(Dt(Dt({},s||{}),o||{}),Object.keys(s).reduce((function(t,e){return t[e]=Dt(Dt({},s[e]),o[e]||{}),t}),{})):s),n}),Dt({},t)):t}function en(t){return{create:function(){return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}}}!function(t){t[t.literal=0]="literal",t[t.object=1]="object"}(We||(We={}));var nn=function(){function t(e,n,i,s){var o,r=this;if(void 0===n&&(n=t.defaultLocale),this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(t){var e=r.formatToParts(t);if(1===e.length)return e[0].value;var n=e.reduce((function(t,e){return t.length&&e.type===We.literal&&"string"==typeof t[t.length-1]?t[t.length-1]+=e.value:t.push(e.value),t}),[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(t){return Je(r.ast,r.locales,r.formatters,r.formats,t,void 0,r.message)},this.resolvedOptions=function(){return{locale:Intl.NumberFormat.supportedLocalesOf(r.locales)[0]}},this.getAst=function(){return r.ast},"string"==typeof e){if(this.message=e,!t.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=t.__parse(e,{ignoreTag:null==s?void 0:s.ignoreTag})}else this.ast=e;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=tn(t.formats,i),this.locales=n,this.formatters=s&&s.formatters||(void 0===(o=this.formatterCache)&&(o={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:ze((function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new((t=Intl.NumberFormat).bind.apply(t,zt([void 0],e,!1)))}),{cache:en(o.number),strategy:$e.variadic}),getDateTimeFormat:ze((function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new((t=Intl.DateTimeFormat).bind.apply(t,zt([void 0],e,!1)))}),{cache:en(o.dateTime),strategy:$e.variadic}),getPluralRules:ze((function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new((t=Intl.PluralRules).bind.apply(t,zt([void 0],e,!1)))}),{cache:en(o.pluralRules),strategy:$e.variadic})})}return Object.defineProperty(t,"defaultLocale",{get:function(){return t.memoizedDefaultLocale||(t.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),t.memoizedDefaultLocale},enumerable:!1,configurable:!0}),t.memoizedDefaultLocale=null,t.__parse=Re,t.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},t}(),sn=nn;const on={},rn=(t,e,n)=>n?(e in on||(on[e]={}),t in on[e]||(on[e][t]=n),n):n,an=(t,e)=>{if(null==e)return;if(e in on&&t in on[e])return on[e][t];const n=An(e);for(let i=0;i<n.length;i++){const s=cn(n[i],t);if(s)return rn(t,e,s)}};let ln;const hn=vt({});function un(t){return t in ln}function cn(t,e){return un(t)?function(t,e){if(null==e)return;if(e in t)return t[e];const n=e.split(".");let i=t;for(let t=0;t<n.length;t++)if("object"==typeof i){if(t>0){const e=n.slice(t,n.length).join(".");if(e in i){i=i[e];break}}i=i[n[t]]}else i=void 0;return i}(function(t){return ln[t]||null}(t),e):null}function pn(t,...e){delete on[t],hn.update((n=>(n[t]=Mt.all([n[t]||{},...e]),n)))}yt([hn],(([t])=>Object.keys(t))),hn.subscribe((t=>ln=t));const dn={};function fn(t){return dn[t]}function _n(t){return null!=t&&An(t).some((t=>{var e;return null===(e=fn(t))||void 0===e?void 0:e.size}))}const mn={};function gn(t){if(!_n(t))return t in mn?mn[t]:Promise.resolve();const e=function(t){return An(t).map((t=>{const e=fn(t);return[t,e?[...e]:[]]})).filter((([,t])=>t.length>0))}(t);return mn[t]=Promise.all(e.map((([t,e])=>function(t,e){return Promise.all(e.map((e=>(function(t,e){dn[t].delete(e),0===dn[t].size&&delete dn[t]}(t,e),e().then((t=>t.default||t)))))).then((e=>pn(t,...e)))}(t,e)))).then((()=>{if(_n(t))return gn(t);delete mn[t]})),mn[t]}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function vn(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}const yn={fallbackLocale:null,loadingDelay:200,formats:{number:{scientific:{notation:"scientific"},engineering:{notation:"engineering"},compactLong:{notation:"compact",compactDisplay:"long"},compactShort:{notation:"compact",compactDisplay:"short"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},warnOnMissingMessages:!0,ignoreTag:!0};function wn(){return yn}const bn=vt(!1);let xn;const Tn=vt(null);function Cn(t){return t.split("-").map(((t,e,n)=>n.slice(0,e+1).join("-"))).reverse()}function An(t,e=wn().fallbackLocale){const n=Cn(t);return e?[...new Set([...n,...Cn(e)])]:n}function kn(){return null!=xn?xn:void 0}Tn.subscribe((t=>{xn=null!=t?t:void 0,"undefined"!=typeof window&&null!=t&&document.documentElement.setAttribute("lang",t)}));const Sn=Object.assign(Object.assign({},Tn),{set:t=>{if(t&&function(t){if(null==t)return;const e=An(t);for(let t=0;t<e.length;t++){const n=e[t];if(un(n))return n}}(t)&&_n(t)){const{loadingDelay:e}=wn();let n;return"undefined"!=typeof window&&null!=kn()&&e?n=window.setTimeout((()=>bn.set(!0)),e):bn.set(!0),gn(t).then((()=>{Tn.set(t)})).finally((()=>{clearTimeout(n),bn.set(!1)}))}return Tn.set(t)}}),Mn=t=>{const e=Object.create(null);return n=>{const i=JSON.stringify(n);return i in e?e[i]:e[i]=t(n)}},En=(t,e)=>{const{formats:n}=wn();if(t in n&&e in n[t])return n[t][e];throw new Error(`[svelte-i18n] Unknown "${e}" ${t} format.`)},Ln=Mn((t=>{var{locale:e,format:n}=t,i=vn(t,["locale","format"]);if(null==e)throw new Error('[svelte-i18n] A "locale" must be set to format numbers');return n&&(i=En("number",n)),new Intl.NumberFormat(e,i)})),Pn=Mn((t=>{var{locale:e,format:n}=t,i=vn(t,["locale","format"]);if(null==e)throw new Error('[svelte-i18n] A "locale" must be set to format dates');return n?i=En("date",n):0===Object.keys(i).length&&(i=En("date","short")),new Intl.DateTimeFormat(e,i)})),On=Mn((t=>{var{locale:e,format:n}=t,i=vn(t,["locale","format"]);if(null==e)throw new Error('[svelte-i18n] A "locale" must be set to format time values');return n?i=En("time",n):0===Object.keys(i).length&&(i=En("time","short")),new Intl.DateTimeFormat(e,i)})),In=Mn(((t,e=kn())=>new sn(t,e,wn().formats,{ignoreTag:wn().ignoreTag}))),Dn=(t,e={})=>{let n=e;"object"==typeof t&&(n=t,t=n.id);const{values:i,locale:s=kn(),default:o}=n;if(null==s)throw new Error("[svelte-i18n] Cannot format a message without first setting the initial locale.");let r=an(t,s);if(r){if("string"!=typeof r)return r}else wn().warnOnMissingMessages,r=null!=o?o:t;if(!i)return r;let a=r;try{a=In(r,s).format(i)}catch(e){}return a},Nn=(t,e)=>((t={})=>{var{locale:e=kn()}=t,n=vn(t,["locale"]);return On(Object.assign({locale:e},n))})(e).format(t),Rn=(t,e)=>((t={})=>{var{locale:e=kn()}=t,n=vn(t,["locale"]);return Pn(Object.assign({locale:e},n))})(e).format(t),zn=(t,e)=>((t={})=>{var{locale:e=kn()}=t,n=vn(t,["locale"]);return Ln(Object.assign({locale:e},n))})(e).format(t),Bn=(t,e=kn())=>an(t,e),Vn=yt([Sn,hn],(()=>Dn));function Fn(t){return new Promise((async(e,n)=>{let i=await fetch(t);e(await i.json())}))}yt([Sn],(()=>Nn)),yt([Sn],(()=>Rn)),yt([Sn],(()=>zn)),yt([Sn,hn],(()=>Bn));const Zn=[{id:"en",file:"i18n/en.json",label:"English"},{id:"fr",file:"i18n/fr.json",label:"Français"}];async function jn(){for(let t of Zn)pn(t.id,await Fn(t.file));let t="undefined"==typeof window?null:window.navigator.language||window.navigator.languages[0];if(!Zn.map((t=>t.id)).includes("local")){let e=t.split("-");t=e.length>1?e[0]:t}!function(t){const{formats:e}=t,n=vn(t,["formats"]),i=t.initialLocale||t.fallbackLocale;Object.assign(yn,n,{initialLocale:i}),e&&("number"in e&&Object.assign(yn.formats.number,e.number),"date"in e&&Object.assign(yn.formats.date,e.date),"time"in e&&Object.assign(yn.formats.time,e.time)),Sn.set(i)}({fallbackLocale:"en",initialLocale:t})}const qn="14.7.77";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Gn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Un(t){var e={exports:{}};return t(e,e.exports),e.exports}var $n=Un((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),Wn=Un((function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,s,o=[],r=!0,a=!1;try{for(n=n.call(t);!(r=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);r=!0);}catch(t){a=!0,s=t}finally{try{r||null==n.return||n.return()}finally{if(a)throw s}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports})),Hn=Un((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports})),Xn=Un((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return Hn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hn(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),Yn=Un((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),Kn=Un((function(t){t.exports=function(t,e){return $n(t)||Wn(t,e)||Xn(t,e)||Yn()},t.exports.__esModule=!0,t.exports.default=t.exports})),Qn=Un((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),Jn=Un((function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),ti=Un((function(t,e){!function(t,e,n,i){function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=s(e),r=s(n),a=s(i),l=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},h=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},u=function(t,e){return{startTime:e,type:"setValue",value:t}},c=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var i=n.startTime,s=n.target,o=n.timeConstant;return s+(e-s)*Math.exp((i-t)/o)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},_=function(t){return d(t)||f(t)},m=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,i,s){var o=e[n];return void 0===o?s:_(o)||m(o)?o.value:g(o)?o.values[o.values.length-1]:p(i,t(e,n-1,o.startTime,s),o)},y=function(t,e,n,i,s){return void 0===n?[i.insertTime,s]:_(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,s)]},w=function(t){return"cancelAndHold"===t.type},b=function(t){return"cancelScheduledValues"===t.type},x=function(t){return w(t)||b(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},T=function(t,e,n,i){var s=i.endTime,o=i.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(t-e)/(s-e)):0},C=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},A=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},k=function(t,e){var n=e.duration,i=e.startTime,s=e.values,o=(t-i)/n*(s.length-1);return A(s,o)},S=function(t){return"setTarget"===t.type},M=function(t){function e(t){r.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=x(t);if(w(t)||b(t)){var n=this._automationEvents.findIndex((function(n){return b(t)&&g(n)?n.startTime+n.duration>=e:x(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),w(t)){var s=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&_(i)){if(S(s))throw new Error("The internal list is malformed.");var o=g(s)?s.startTime+s.duration:x(s),r=g(s)?s.values[s.values.length-1]:s.value,a=d(i)?T(e,o,r,i):C(e,o,r,i),p=d(i)?l(a,e,this._currenTime):h(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==s&&S(s)&&this._automationEvents.push(u(this.getValue(e),e)),void 0!==s&&g(s)&&s.startTime+s.duration>e&&(this._automationEvents[this._automationEvents.length-1]=c(new Float32Array([6,7]),s.startTime,e-s.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return x(t)>e})),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&x(v)+v.duration>e)return!1;var y=d(t)?l(t.value,t.endTime,this._currenTime):f(t)?h(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>x(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return x(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];S(i)&&n.unshift(u(v(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return x(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,s=this._automationEvents[i];if(void 0!==s&&S(s)&&(void 0===n||!_(n)||n.insertTime>t))return p(t,v(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(void 0!==s&&m(s)&&(void 0===n||!_(n)))return s.value;if(void 0!==s&&g(s)&&(void 0===n||!_(n)||s.startTime+s.duration>t))return t<s.startTime+s.duration?k(t,s):s.values[s.values.length-1];if(void 0!==s&&_(s)&&(void 0===n||!_(n)))return s.value;if(void 0!==n&&d(n)){var r=y(this._automationEvents,i,s,n,this._defaultValue),a=o.default(r,2),l=a[0],h=a[1];return T(t,l,h,n)}if(void 0!==n&&f(n)){var u=y(this._automationEvents,i,s,n,this._defaultValue),c=o.default(u,2),w=c[0],b=c[1];return C(t,w,b,n)}return this._defaultValue}}]),e}(Symbol.iterator),E=function(t){return{cancelTime:t,type:"cancelAndHold"}},L=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},P=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},O=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},I=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=M,t.createCancelAndHoldAutomationEvent=E,t.createCancelScheduledValuesAutomationEvent=L,t.createExponentialRampToValueAutomationEvent=P,t.createLinearRampToValueAutomationEvent=O,t.createSetTargetAutomationEvent=I,t.createSetValueAutomationEvent=u,t.createSetValueCurveAutomationEvent=c,Object.defineProperty(t,"__esModule",{value:!0})}(e,Kn,Qn,Jn)}));const ei=new WeakSet,ni=new WeakMap,ii=new WeakMap,si=new WeakMap,oi=new WeakMap,ri=new WeakMap,ai=new WeakMap,li=new WeakMap,hi=new WeakMap,ui=new WeakMap,ci={construct:()=>ci},pi=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,di=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),s=i.match(pi);for(;null!==s;){const t=s[1].slice(1,-1),o=s[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(o),i=i.slice(s[0].length).replace(/^[\s]+/,""),s=i.match(pi)}return[n.join(";"),i]},fi=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},_i=t=>{if(!(t=>{try{new new Proxy(t,ci)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},mi=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},gi=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},vi=(t,e,n,i)=>{const s=mi(t,e),o=gi(s,(t=>t[0]===n&&t[1]===i));return 0===s.size&&t.delete(e),o},yi=t=>mi(ai,t),wi=t=>{if(ei.has(t))throw new Error("The AudioNode is already stored.");ei.add(t),yi(t).forEach((t=>t(!0)))},bi=t=>"port"in t,xi=t=>{if(!ei.has(t))throw new Error("The AudioNode is not stored.");ei.delete(t),yi(t).forEach((t=>t(!1)))},Ti=(t,e)=>{!bi(t)&&e.every((t=>0===t.size))&&xi(t)},Ci={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Ai=(t,e)=>t.context===e,ki=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Si=()=>new DOMException("","IndexSizeError"),Mi=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw Si();throw t}})},Ei={numberOfChannels:1},Li=-34028234663852886e22,Pi=-Li,Oi=t=>ei.has(t),Ii={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Di=t=>mi(ni,t),Ni=t=>mi(si,t),Ri=(t,e)=>{const{activeInputs:n}=Di(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||Ri(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:bi(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=Ni(t);void 0!==n&&n.activeInputs.forEach((([t])=>Ri(t,e)))}Oi(t)&&xi(t)},zi=t=>{Ri(t.destination,[])},Bi=t=>"context"in t,Vi=t=>Bi(t[0]),Fi=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Zi=(t,e,[n,i],s)=>{Fi(t,[e,n,i],(t=>t[0]===e&&t[1]===n),s)},ji=(t,[e,n,i],s)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[n,i]])):Fi(o,[n,i],(t=>t[0]===n),s)},qi=t=>"inputs"in t,Gi=(t,e,n,i)=>{if(qi(e)){const s=e.inputs[i];return t.connect(s,n,0),[s,n,0]}return t.connect(e,n,i),[e,n,i]},Ui=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},$i=(t,e)=>{if(!yi(t).delete(e))throw new Error("Missing the expected event listener.")},Wi=(t,e,n)=>{const i=mi(t,e),s=gi(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),s},Hi=(t,e,n,i)=>{qi(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Xi=t=>mi(ii,t),Yi=t=>mi(oi,t),Ki=t=>li.has(t),Qi=t=>!ei.has(t),Ji=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=s,r.loop=!0,r.connect(e).connect(t.destination),r.connect(i),r.disconnect(i),e.onaudioprocess=i=>{const s=i.inputBuffer.getChannelData(0);Array.prototype.some.call(s,(t=>1===t))?n(!0):n(!1),r.stop(),e.onaudioprocess=null,r.disconnect(e),e.disconnect(t.destination)},r.start()}})),ts=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},es=t=>"context"in t,ns=(t,e,n,i)=>{const{activeInputs:s,passiveInputs:o}=Ni(e),{outputs:r}=Di(t),a=yi(t),l=r=>{const a=Xi(t),l=Yi(e);if(r){const e=Wi(o,t,n);Zi(s,t,e,!1),i||Ki(t)||a.connect(l,n)}else{const e=((t,e,n)=>gi(t,(t=>t[0]===e&&t[1]===n)))(s,t,n);ji(o,e,!1),i||Ki(t)||a.disconnect(l,n)}};return!!Fi(r,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(l),Oi(t)?Zi(s,t,[n,l],!0):ji(o,[t,n,l],!0),!0)},is=(t,e,n,i,s)=>{const[o,r]=((t,e,n,i)=>{const{activeInputs:s,passiveInputs:o}=Di(e),r=Ui(s[i],t,n);if(null===r)return[vi(o,t,n,i)[2],!1];return[r[2],!0]})(t,n,i,s);if(null!==o&&($i(t,o),!r||e||Ki(t)||Hi(Xi(t),Xi(n),i,s)),Oi(n)){const{activeInputs:t}=Di(n);Ti(n,t)}},ss=(t,e,n,i)=>{const[s,o]=((t,e,n)=>{const{activeInputs:i,passiveInputs:s}=Ni(e),o=Ui(i,t,n);if(null===o)return[Wi(s,t,n)[1],!1];return[o[2],!0]})(t,n,i);null!==s&&($i(t,s),!o||e||Ki(t)||Xi(t).disconnect(Yi(n),i))};class os{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const rs={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function as(t,e,n,i,s){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,s);else{const o=t.getChannelData(i);if(0===e[n].byteLength)e[n]=o.slice(s,s+128);else{const t=new Float32Array(o.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const ls=(t,e,n,i,s)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,s):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],s)},hs=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],s="number"==typeof e?e:e[i];for(let e=0;e<s;e+=1)t.push(new Float32Array(128));n.push(t)}return n},us=async(t,e,n,i,s,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,l=i.channelCount*i.numberOfInputs,h=s.reduce(((t,e)=>t+e),0),u=0===h?null:n.createBuffer(h,a,n.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const c=Di(t),p=await((t,e)=>{const n=mi(ui,t),i=Xi(e);return mi(n,i)})(n,t),d=hs(i.numberOfInputs,i.channelCount),f=hs(i.numberOfOutputs,s),_=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let h=0;h<a;h+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)as(e,d[t],n,n,h);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach((({name:t},n)=>{as(e,_,t,l+n,h)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<s[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===c.activeInputs[e].size?[]:t)),e=r(h/n.sampleRate,n.sampleRate,(()=>p.process(t,f,_)));if(null!==u)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<s[t];n+=1)ls(u,f[t],n,e+n,h);e+=s[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return u},cs={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ps={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ds={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},fs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},_s={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},ms=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const s=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>s();try{e.postMessage(t,[t])}finally{s()}}))},gs={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},vs=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},ys={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},ws={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},bs=()=>new DOMException("","InvalidStateError"),xs=()=>new DOMException("","InvalidAccessError"),Ts={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Cs=(t,e,n,i,s,o,r,a,l,h,u)=>{const c=h.length;let p=a;for(let a=0;a<c;a+=1){let c=n[0]*h[a];for(let e=1;e<s;e+=1){const i=p-e&l-1;c+=n[e]*o[i],c-=t[e]*r[i]}for(let t=s;t<i;t+=1)c+=n[t]*o[p-t&l-1];for(let n=s;n<e;n+=1)c-=t[n]*r[p-n&l-1];o[p]=h[a],r[p]=c,p=p+1&l-1,u[a]=c}return p},As={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},ks=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Ss=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Ms=(t,e)=>{Ss(t,e,"channelCount"),Ss(t,e,"channelCountMode"),Ss(t,e,"channelInterpretation")},Es=t=>"function"==typeof t.getFloatTimeDomainData,Ls=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},Ps=t=>{t.start=(e=>(n=0,i=0,s)=>{if("number"==typeof s&&s<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,s)})(t.start)},Os=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Is=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Ds=async(t,e)=>{const n=await(t=>new Promise(((e,n)=>{const{port1:i,port2:s}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),s.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),s.close(),n(t)},s.postMessage(t)})))(e);return new t(n)},Ns=(t,e)=>{const n=t.createBiquadFilter();return Ms(n,e),Ls(n,e,"Q"),Ls(n,e,"detune"),Ls(n,e,"frequency"),Ls(n,e,"gain"),Ss(n,e,"type"),n},Rs=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ms(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw bs()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw bs()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw bs()}})})(n),n},zs=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Bs=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Ms(n,e),Ls(n,e,"delayTime"),n},Vs=(t,e)=>{const n=t.createGain();return Ms(n,e),Ls(n,e,"gain"),n};function Fs(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Zs(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function js(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=Zs(n,e),n[0]+=t[i];return n}const qs=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Gs=()=>new DOMException("","NotSupportedError"),Us={numberOfChannels:1},$s={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Ws={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Hs={disableNormalization:!1},Xs={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Ys={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Ks=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Qs=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},Js=(t,e,n,i)=>{let s=t;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:o,set:r}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(t,e,{get:n(o),set:i(r)})},to=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;to(t,e,n+1e-7)}},eo=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},no=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},io=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},so=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),zs(t,n),t.stop=(e=>{let i=!1;return(s=0)=>{if(i)try{e.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else e.call(t,s),i=!0}})(t.stop)},oo=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},ro=(t=>(e,n,[i,s,o],r)=>{t(e[s],[n,i,o],(t=>t[0]===n&&t[1]===i),r)})(Fi),ao=(t=>(e,n,[i,s,o],r)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[s,n,o]])):t(a,[s,n,o],(t=>t[0]===s&&t[1]===n),r)})(Fi),lo=(t=>(e,n,i,s)=>t(e[s],(t=>t[0]===n&&t[1]===i)))(gi),ho=new WeakMap,uo=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(ho),co=(po=new Map,fo=new WeakMap,(t,e)=>{const n=fo.get(t);if(void 0!==n)return n;const i=po.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(po.set(t,n),n.catch((()=>!1)).then((e=>(po.delete(t),fo.set(t,e),e)))):(fo.set(t,n),n)}catch{return fo.set(t,!1),!1}});var po,fo;const _o="undefined"==typeof window?null:window,mo=((t,e)=>(n,i)=>{const s=n.createAnalyser();if(Ms(s,i),!(i.maxDecibels>i.minDecibels))throw e();return Ss(s,i,"fftSize"),Ss(s,i,"maxDecibels"),Ss(s,i,"minDecibels"),Ss(s,i,"smoothingTimeConstant"),t(Es,(()=>Es(s)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(s),s})(co,Si),go=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(Di),vo=((t,e,n)=>async(i,s,o)=>{const r=t(i);await Promise.all(r.activeInputs.map(((t,r)=>Array.from(t).map((async([t,a])=>{const l=e(t),h=await l.render(t,s),u=i.context.destination;n(t)||i===u&&n(i)||h.connect(o,a,r)})))).reduce(((t,e)=>[...t,...e]),[]))})(Di,go,Ki),yo=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,o){const r=i.get(o);return void 0!==r?Promise.resolve(r):(async(s,o)=>{let r=e(s);if(!Ai(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,fftSize:r.fftSize,maxDecibels:r.maxDecibels,minDecibels:r.minDecibels,smoothingTimeConstant:r.smoothingTimeConstant};r=t(o,e)}return i.set(o,r),await n(s,o,r),r})(s,o)}}})(mo,Xi,vo),wo=(bo=ri,t=>{const e=bo.get(t);if(void 0===e)throw bs();return e});var bo;const xo=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(_o),To=(t=>e=>null!==t&&e instanceof t)(xo),Co=new WeakMap,Ao=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let s=this._listeners.get(n);void 0===s&&(s=t(this,n),"function"==typeof n&&this._listeners.set(n,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(oo),ko=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(_o),So=(t=>e=>null!==t&&e instanceof t)(ko),Mo=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(_o),Eo=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(_o),Lo=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(_o),Po=((t,e,n,i,s,o,r,a,l,h,u,c,p,d,f,_)=>class extends h{constructor(e,i,s,o){super(s),this._context=e,this._nativeAudioNode=s;const r=u(e);c(r)&&!0!==n(Ji,(()=>Ji(r,_)))&&(t=>{const e=new Map;t.connect=(t=>(n,i=0,s=0)=>{const o=es(n)?t(n,i,s):t(n,i),r=e.get(n);return void 0===r?e.set(n,[{input:s,output:i}]):r.every((t=>t.input!==s||t.output!==i))&&r.push({input:s,output:i}),o})(t.connect.bind(t)),t.disconnect=(n=>(i,s,o)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const s=n.filter((t=>t.output!==i));0===s.length?e.delete(t):e.set(t,s)}else if(e.has(i))if(void 0===s)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==s&&(t.input!==o||void 0===o)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,i]of e)i.forEach((e=>{es(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)})(s),ii.set(this,s),ai.set(this,new Set),"closed"!==e.state&&i&&wi(this),t(this,o,s)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();const h=u(this._context),c=f(h);if(p(t)||d(t))throw o();if(Bi(t)){const s=Xi(t);try{const e=Gi(this._nativeAudioNode,s,n,a),i=Qi(this);(c||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&Qi(t)&&wi(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,n,a,c)){const e=l([this],t);ts(e,i(c))}return t}const _=Yi(t);if("playbackRate"===_.name&&1024===_.maxValue)throw r();try{this._nativeAudioNode.connect(_,n),(c||Qi(this))&&this._nativeAudioNode.disconnect(_,n)}catch(t){if(12===t.code)throw o();throw t}if(ns(this,t,n,c)){const e=l([this],t);ts(e,i(c))}}disconnect(t,e,n){let i;const r=u(this._context),h=f(r);if(void 0===t)i=((t,e)=>{const n=Di(t),i=[];for(const s of n.outputs)Vi(s)?is(t,e,...s):ss(t,e,...s),i.push(s[0]);return n.outputs.clear(),i})(this,h);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=((t,e,n)=>{const i=Di(t),s=[];for(const o of i.outputs)o[1]===n&&(Vi(o)?is(t,e,...o):ss(t,e,...o),s.push(o[0]),i.outputs.delete(o));return s})(this,h,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(Bi(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(i=((t,e,n,i,s)=>{const o=Di(t);return Array.from(o.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==s&&t[2]!==s))).map((n=>(Vi(n)?is(t,e,...n):ss(t,e,...n),o.outputs.delete(n),n[0])))})(this,h,t,e,n),0===i.length)throw o()}for(const t of i){const e=l([this],t);ts(e,a)}}})((Oo=ni,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);Oo.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,s,o,r,a,l,h,u,c,p)=>{const d=new WeakMap;return(f,_,m,g,v)=>{const{activeInputs:y,passiveInputs:w}=o(_),{outputs:b}=o(f),x=a(f),T=o=>{const a=l(_),h=l(f);if(o){const e=vi(w,f,m,g);t(y,f,e,!1),v||c(f)||n(h,a,m,g),p(_)&&wi(_)}else{const t=i(y,f,m,g);e(w,g,t,!1),v||c(f)||s(h,a,m,g);const n=r(_);if(0===n)u(_)&&Ti(_,y);else{const t=d.get(_);void 0!==t&&clearTimeout(t),d.set(_,setTimeout((()=>{u(_)&&Ti(_,y)}),1e3*n))}}};return!!h(b,[_,m,g],(t=>t[0]===_&&t[1]===m&&t[2]===g),!0)&&(x.add(T),u(f)?t(y,f,[m,g,T],!0):e(w,g,[f,m,T],!0),!0)}})(ro,ao,Gi,lo,Hi,Di,uo,yi,Xi,Fi,Oi,Ki,Qi),co,((t,e,n,i,s,o)=>r=>(a,l)=>{const h=t.get(a);if(void 0===h){if(!r&&o(a)){const t=i(a),{outputs:o}=n(a);for(const n of o)if(Vi(n)){const s=i(n[0]);e(t,s,n[1],n[2])}else{const e=s(n[0]);t.disconnect(e,n[1])}}t.set(a,l)}else t.set(a,h+l)})(li,Hi,Di,Xi,Yi,Oi),Si,xs,Gs,((t,e,n,i,s,o,r,a)=>(l,h)=>{const u=e.get(l);if(void 0===u)throw new Error("Missing the expected cycle count.");const c=o(l.context),p=a(c);if(u===h){if(e.delete(l),!p&&r(l)){const e=i(l),{outputs:o}=n(l);for(const n of o)if(Vi(n)){const s=i(n[0]);t(e,s,n[1],n[2])}else{const t=s(n[0]);e.connect(t,n[1])}}}else e.set(l,u-h)})(Gi,li,Di,Xi,Yi,wo,Oi,To),((t,e,n)=>function i(s,o){const r=Bi(o)?o:n(t,o);if((t=>"delayTime"in t)(r))return[];if(s[0]===r)return[s];if(s.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map((t=>i([...s,r],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Co,Di,mi),Ao,wo,So,Mo,Eo,To,Lo);var Oo;const Io=((t,e,n,i,s,o)=>class extends t{constructor(t,n){const r=s(t),a={...Ci,...n},l=i(r,a);super(t,!1,l,o(r)?e():null),this._nativeAnalyserNode=l}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Po,yo,Si,mo,wo,To),Do=new WeakSet,No=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(_o),Ro=(zo=new Uint32Array(1),t=>(zo[0]=t,zo[0]));var zo;const Bo=((t,e)=>n=>{n.copyFromChannel=(i,s,o=0)=>{const r=t(o),a=t(s);if(a>=n.numberOfChannels)throw e();const l=n.length,h=n.getChannelData(a),u=i.length;for(let t=r<0?-r:0;t+r<l&&t<u;t+=1)i[t]=h[t+r]},n.copyToChannel=(i,s,o=0)=>{const r=t(o),a=t(s);if(a>=n.numberOfChannels)throw e();const l=n.length,h=n.getChannelData(a),u=i.length;for(let t=r<0?-r:0;t+r<l&&t<u;t+=1)h[t+r]=i[t]}})(Ro,Si),Vo=(t=>e=>{e.copyFromChannel=(n=>(i,s,o=0)=>{const r=t(o),a=t(s);if(r<e.length)return n.call(e,i,a,r)})(e.copyFromChannel),e.copyToChannel=(n=>(i,s,o=0)=>{const r=t(o),a=t(s);if(r<e.length)return n.call(e,i,a,r)})(e.copyToChannel)})(Ro),Fo=((t,e,n,i,s,o,r,a)=>{let l=null;return class h{constructor(h){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:c,sampleRate:p}={...Ei,...h};null===l&&(l=new s(1,1,44100));const d=null!==i&&e(o,o)?new i({length:u,numberOfChannels:c,sampleRate:p}):l.createBuffer(c,u,p);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(r(d),Mi(d)):e(ki,(()=>ki(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}})(Do,co,Gs,No,xo,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(No),Bo,Vo),Zo=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const s=()=>{n.removeEventListener("ended",s),n.disconnect(i),i.disconnect()};n.addEventListener("ended",s)})(Vs),jo=((t,e,n)=>async(i,s,o)=>{const r=e(i);await Promise.all(Array.from(r.activeInputs).map((async([e,i])=>{const r=t(e),a=await r.render(e,s);n(e)||a.connect(o,i)})))})(go,Ni,Ki),qo=(t=>(e,n,i)=>t(n,e,i))(jo),Go=((t,e,n,i,s,o,r,a,l,h,u)=>(c,p)=>{const d=c.createBufferSource();return Ms(d,p),Ls(d,p,"playbackRate"),Ss(d,p,"buffer"),Ss(d,p,"loop"),Ss(d,p,"loopEnd"),Ss(d,p,"loopStart"),e(n,(()=>n(c)))||(t=>{t.start=(e=>{let n=!1;return(i=0,s=0,o)=>{if(n)throw bs();e.call(t,i,s,o),n=!0}})(t.start)})(d),e(i,(()=>i(c)))||l(d),e(s,(()=>s(c)))||h(d,c),e(o,(()=>o(c)))||Ps(d),e(r,(()=>r(c)))||u(d,c),e(a,(()=>a(c)))||Os(d),t(c,d),d})(Zo,co,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),eo,no,io,(t=>{t.start=(e=>(n=0,i=0,s)=>{const o=t.buffer,r=null===o?i:Math.min(o.duration,i);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,r,s)})(t.start)}),(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(Js),so),Uo=((t,e)=>(n,i,s)=>(t(i).replay(s),e(i,n,s)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(Ni),jo),$o=((t,e,n,i,s)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(l,h){const u=o.get(h);return void 0!==u?Promise.resolve(u):(async(l,h)=>{let u=n(l);const c=Ai(u,h);if(!c){const t={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=e(h,t),null!==r&&u.start(...r),null!==a&&u.stop(a)}return o.set(h,u),c?await t(h,l.playbackRate,u.playbackRate):await i(h,l.playbackRate,u.playbackRate),await s(l,h,u),u})(l,h)}}})(qo,Go,Xi,Uo,vo),Wo=((t,e,n,i,s,o,r,a,l,h,u,c,p)=>(d,f,_,m=null,g=null)=>{const v=new ti.AutomationEventList(_.defaultValue),y=f?i(v):null,w={get defaultValue(){return _.defaultValue},get maxValue(){return null===m?_.maxValue:m},get minValue(){return null===g?_.minValue:g},get value(){return _.value},set value(t){_.value=t,w.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof _.cancelAndHoldAtTime)null===y&&v.flush(d.context.currentTime),v.add(s(t)),_.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(d.context.currentTime),v.add(s(t));const n=Array.from(v).pop();_.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?_.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?_.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?_.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&_.setValueCurveAtTime(n.values,n.startTime,n.duration))}return w},cancelScheduledValues:t=>(null===y&&v.flush(d.context.currentTime),v.add(o(t)),_.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(d.context.currentTime),v.add(r(t,e)),_.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(a(t,e)),_.linearRampToValueAtTime(t,e),w),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(d.context.currentTime),v.add(l(t,e,n)),_.setTargetAtTime(t,e,n),w),setValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(h(t,e)),_.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==c&&"webkitAudioContext"===c.name){const t=e+n,s=d.context.sampleRate,o=Math.ceil(e*s),r=Math.floor(t*s),a=r-o,l=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(i.length-1)/n*((o+t)/s-e),a=Math.floor(r),h=Math.ceil(r);l[t]=a===h?i[a]:(1-(r-a))*i[a]+(1-(h-r))*i[h]}null===y&&v.flush(d.context.currentTime),v.add(u(l,e,n)),_.setValueCurveAtTime(l,e,n);const h=r/s;h<t&&p(w,l[l.length-1],h),p(w,i[i.length-1],t)}else null===y&&v.flush(d.context.currentTime),v.add(u(i,e,n)),_.setValueCurveAtTime(i,e,n);return w}};return n.set(w,_),e.set(w,d),t(w,y),w})((Ho=si,(t,e)=>{Ho.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Co,oi,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:s}=n;e.setTargetAtTime(i,t,s)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,t)}}}})),ti.createCancelAndHoldAutomationEvent,ti.createCancelScheduledValuesAutomationEvent,ti.createExponentialRampToValueAutomationEvent,ti.createLinearRampToValueAutomationEvent,ti.createSetTargetAutomationEvent,ti.createSetValueAutomationEvent,ti.createSetValueCurveAutomationEvent,ko,to);var Ho;const Xo=((t,e,n,i,s,o,r,a)=>class extends t{constructor(t,i){const a=o(t),l={...Ii,...i},h=s(a,l),u=r(a),c=u?e():null;super(t,!1,h,c),this._audioBufferSourceNodeRenderer=c,this._isBufferNullified=!1,this._isBufferSet=null!==l.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,u,h.playbackRate,Pi,Li)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){wi(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),Oi(this)&&xi(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Po,$o,Wo,bs,Go,wo,To,oo),Yo=((t,e,n,i,s,o,r,a)=>class extends t{constructor(t,n){const i=o(t),l=r(i),h=s(i,n,l);super(t,!1,h,l?e(a):null),this._isNodeOfNativeOfflineAudioContext=l,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Po,(t=>{const e=new WeakMap;return{render(n,i){const s=e.get(i);return void 0!==s?Promise.resolve(s):(async(n,i)=>{const s=i.destination;return e.set(i,s),await t(n,i,s),s})(n,i)}}}),Si,bs,((t,e)=>(n,i,s)=>{const o=n.destination;if(o.channelCount!==i)try{o.channelCount=i}catch{}s&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:i});const r=t(n,{channelCount:i,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}})),e(r,"channelCountMode",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelCountMode=e})),e(r,"channelInterpretation",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelInterpretation=e})),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})(Vs,Js),wo,To,vo),Ko=((t,e,n,i,s)=>()=>{const o=new WeakMap;return{render(r,a){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a)=>{let l=n(r);const h=Ai(l,a);if(!h){const t={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(a,t)}return o.set(a,l),h?(await t(a,r.Q,l.Q),await t(a,r.detune,l.detune),await t(a,r.frequency,l.frequency),await t(a,r.gain,l.gain)):(await i(a,r.Q,l.Q),await i(a,r.detune,l.detune),await i(a,r.frequency,l.frequency),await i(a,r.gain,l.gain)),await s(r,a,l),l})(r,a)}}})(qo,Ns,Xi,Uo,vo),Qo=(t=>(e,n)=>t.set(e,n))(ho),Jo=((t,e,n,i,s,o,r,a)=>class extends t{constructor(t,i){const l=o(t),h={...cs,...i},u=s(l,h),c=r(l);super(t,!1,u,c?n():null),this._Q=e(this,c,u.Q,Pi,Li),this._detune=e(this,c,u.detune,1200*Math.log2(Pi),-1200*Math.log2(Pi)),this._frequency=e(this,c,u.frequency,t.sampleRate/2,0),this._gain=e(this,c,u.gain,40*Math.log10(Pi),Li),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw i();throw t}if(t.length!==e.length||e.length!==n.length)throw i()}})(Po,Wo,Ko,xs,Ns,wo,To,Qo),tr=((t,e)=>(n,i,s)=>{const o=new Set;return n.connect=(s=>(r,a=0,l=0)=>{const h=0===o.size;if(e(r))return s.call(n,r,a,l),t(o,[r,a,l],(t=>t[0]===r&&t[1]===a&&t[2]===l),!0),h&&i(),r;s.call(n,r,a),t(o,[r,a],(t=>t[0]===r&&t[1]===a),!0),h&&i()})(n.connect),n.disconnect=(t=>(i,r,a)=>{const l=o.size>0;if(void 0===i)t.apply(n),o.clear();else if("number"==typeof i){t.call(n,i);for(const t of o)t[1]===i&&o.delete(t)}else{e(i)?t.call(n,i,r,a):t.call(n,i,r);for(const t of o)t[0]!==i||void 0!==r&&t[1]!==r||void 0!==a&&t[2]!==a||o.delete(t)}const h=0===o.size;l&&h&&s()})(n.disconnect),n})(Fi,Mo),er=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const s=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)s.connect(i,0,e)}),(()=>s.disconnect(i)))})(bs,tr),nr=((t,e)=>(n,i)=>{const s=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,s),Ms(s,i),s})(ko,er),ir=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,o){const r=i.get(o);return void 0!==r?Promise.resolve(r):(async(s,o)=>{let r=e(s);if(!Ai(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfInputs:r.numberOfInputs};r=t(o,e)}return i.set(o,r),await n(s,o,r),r})(s,o)}}})(nr,Xi,vo),sr=((t,e,n,i,s)=>class extends t{constructor(t,o){const r=i(t),a={...ps,...o};super(t,!1,n(r,a),s(r)?e():null)}})(Po,ir,nr,wo,To),or=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,o){const r=i.get(o);return void 0!==r?Promise.resolve(r):(async(s,o)=>{let r=e(s);if(!Ai(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfOutputs:r.numberOfOutputs};r=t(o,e)}return i.set(o,r),await n(s,o,r),r})(s,o)}}})(Rs,Xi,vo),rr=((t,e,n,i,s,o)=>class extends t{constructor(t,r){const a=i(t),l=o({...ds,...r});super(t,!1,n(a,l),s(a)?e():null)}})(Po,or,Rs,wo,To,(t=>({...t,channelCount:t.numberOfOutputs}))),ar=((t,e,n,i)=>(s,{offset:o,...r})=>{const a=s.createBuffer(1,2,44100),l=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=n(s,{...r,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,l.buffer=a,l.loop=!0;const c={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return l.onended},set onended(t){l.onended=t},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2]),start(t=0){l.start.call(l,t)},stop(t=0){l.stop.call(l,t)}};return t(s,l),i(zs(c,h),(()=>l.connect(h)),(()=>l.disconnect(h)))})(Zo,Go,Vs,tr),lr=((t,e,n,i,s)=>(o,r)=>{if(void 0===o.createConstantSource)return n(o,r);const a=o.createConstantSource();return Ms(a,r),Ls(a,r,"offset"),e(i,(()=>i(o)))||Ps(a),e(s,(()=>s(o)))||Os(a),t(o,a),a})(Zo,co,ar,eo,io),hr=((t,e,n,i,s)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(l,h){const u=o.get(h);return void 0!==u?Promise.resolve(u):(async(l,h)=>{let u=n(l);const c=Ai(u,h);if(!c){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=e(h,t),null!==r&&u.start(r),null!==a&&u.stop(a)}return o.set(h,u),c?await t(h,l.offset,u.offset):await i(h,l.offset,u.offset),await s(l,h,u),u})(l,h)}}})(qo,lr,Xi,Uo,vo),ur=((t,e,n,i,s,o,r)=>class extends t{constructor(t,r){const a=s(t),l={...fs,...r},h=i(a,l),u=o(a),c=u?n():null;super(t,!1,h,c),this._constantSourceNodeRenderer=c,this._nativeConstantSourceNode=h,this._offset=e(this,u,h.offset,Pi,Li),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){wi(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),Oi(this)&&xi(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Po,Wo,hr,lr,wo,To,oo),cr=((t,e)=>(n,i)=>{const s=n.createConvolver();if(Ms(s,i),i.disableNormalization===s.normalize&&(s.normalize=!i.disableNormalization),Ss(s,i,"buffer"),i.channelCount>2)throw t();if(e(s,"channelCount",(t=>()=>t.call(s)),(e=>n=>{if(n>2)throw t();return e.call(s,n)})),"max"===i.channelCountMode)throw t();return e(s,"channelCountMode",(t=>()=>t.call(s)),(e=>n=>{if("max"===n)throw t();return e.call(s,n)})),s})(Gs,Js),pr=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,o){const r=i.get(o);return void 0!==r?Promise.resolve(r):(async(s,o)=>{let r=e(s);if(!Ai(r,o)){const e={buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,disableNormalization:!r.normalize};r=t(o,e)}return i.set(o,r),qi(r)?await n(s,o,r.inputs[0]):await n(s,o,r),r})(s,o)}}})(cr,Xi,vo),dr=((t,e,n,i,s,o)=>class extends t{constructor(t,r){const a=i(t),l={..._s,...r},h=n(a,l);super(t,!1,h,s(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=h,null!==l.buffer&&o(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Po,pr,cr,wo,To,Qo),fr=((t,e,n,i,s)=>o=>{const r=new WeakMap;return{render(a,l){const h=r.get(l);return void 0!==h?Promise.resolve(h):(async(a,l)=>{let h=n(a);const u=Ai(h,l);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o};h=e(l,t)}return r.set(l,h),u?await t(l,a.delayTime,h.delayTime):await i(l,a.delayTime,h.delayTime),await s(a,l,h),h})(a,l)}}})(qo,Bs,Xi,Uo,vo),_r=((t,e,n,i,s,o,r)=>class extends t{constructor(t,a){const l=s(t),h={...gs,...a},u=i(l,h),c=o(l);super(t,!1,u,c?n(h.maxDelayTime):null),this._delayTime=e(this,c,u.delayTime),r(this,h.maxDelayTime)}get delayTime(){return this._delayTime}})(Po,Wo,fr,Bs,wo,To,Qo),mr=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Ms(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Ls(i,n,"attack"),Ls(i,n,"knee"),Ls(i,n,"ratio"),Ls(i,n,"release"),Ls(i,n,"threshold"),i})(Gs),gr=((t,e,n,i,s)=>()=>{const o=new WeakMap;return{render(r,a){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a)=>{let l=n(r);const h=Ai(l,a);if(!h){const t={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(a,t)}return o.set(a,l),h?(await t(a,r.attack,l.attack),await t(a,r.knee,l.knee),await t(a,r.ratio,l.ratio),await t(a,r.release,l.release),await t(a,r.threshold,l.threshold)):(await i(a,r.attack,l.attack),await i(a,r.knee,l.knee),await i(a,r.ratio,l.ratio),await i(a,r.release,l.release),await i(a,r.threshold,l.threshold)),await s(r,a,l),l})(r,a)}}})(qo,mr,Xi,Uo,vo),vr=((t,e,n,i,s,o,r,a)=>class extends t{constructor(t,s){const l=o(t),h={...ys,...s},u=i(l,h),c=r(l);super(t,!1,u,c?n():null),this._attack=e(this,c,u.attack),this._knee=e(this,c,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,c,u.ratio),this._release=e(this,c,u.release),this._threshold=e(this,c,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Po,Wo,gr,mr,Gs,wo,To,Qo),yr=((t,e,n,i,s)=>()=>{const o=new WeakMap;return{render(r,a){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a)=>{let l=n(r);const h=Ai(l,a);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(a,t)}return o.set(a,l),h?await t(a,r.gain,l.gain):await i(a,r.gain,l.gain),await s(r,a,l),l})(r,a)}}})(qo,Vs,Xi,Uo,vo),wr=((t,e,n,i,s,o)=>class extends t{constructor(t,r){const a=s(t),l={...ws,...r},h=i(a,l),u=o(a);super(t,!1,h,u?n():null),this._gain=e(this,u,h.gain,Pi,Li)}get gain(){return this._gain}})(Po,Wo,yr,Vs,wo,To),br=((t,e,n,i)=>(s,o,{channelCount:r,channelCountMode:a,channelInterpretation:l,feedback:h,feedforward:u})=>{const c=Is(o,s.sampleRate),p=h instanceof Float64Array?h:new Float64Array(h),d=u instanceof Float64Array?u:new Float64Array(u),f=p.length,_=d.length,m=Math.min(f,_);if(0===f||f>20)throw i();if(0===p[0])throw e();if(0===_||_>20)throw i();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<_;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=n(s,c,r,r);g.channelCount=r,g.channelCountMode=a,g.channelInterpretation=l;const v=[],y=[],w=[];for(let t=0;t<r;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),w.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),s=n.getChannelData(t);v[t]=Cs(p,f,d,_,m,y[t],w[t],v[t],32,i,s)}};const b=s.sampleRate/2,x={get bufferSize(){return c},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const s=e.length;for(let t=0;t<s;t+=1){const s=-Math.PI*(e[t]/b),o=[Math.cos(s),Math.sin(s)],r=Fs(js(d,o),js(p,o));n[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),i[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])};return zs(x,g)})(xs,bs,qs,Gs),xr=((t,e,n,i)=>s=>t(ks,(()=>ks(s)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(s,512,0,1);s.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>s.currentTime,t.connect(s.destination)}return s.startRendering()})):new Promise((t=>{const n=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(s.destination),s.startRendering()})))(co,Vs,qs,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Vs,xo)),Tr=((t,e,n,i,s)=>(o,r)=>{const a=new WeakMap;let l=null;const h=async(h,u)=>{let c=null,p=e(h);const d=Ai(p,u);if(void 0===u.createIIRFilter?c=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(p=u.createIIRFilter(r,o)),a.set(u,null===c?p:c),null!==c){if(null===l){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(h.context.destination.channelCount,h.context.length,u.sampleRate);l=(async()=>{await i(h,t,t.destination);return((t,e,n,i)=>{const s=n instanceof Float64Array?n:new Float64Array(n),o=i instanceof Float64Array?i:new Float64Array(i),r=s.length,a=o.length,l=Math.min(r,a);if(1!==s[0]){for(let t=0;t<r;t+=1)o[t]/=s[0];for(let t=1;t<a;t+=1)s[t]/=s[0]}const h=new Float32Array(32),u=new Float32Array(32),c=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const n=t.getChannelData(e),i=c.getChannelData(e);h.fill(0),u.fill(0),Cs(s,r,o,a,l,h,u,0,32,n,i)}return c})(await s(t),u,o,r)})()}const t=await l;return c.buffer=t,c.start(0),c}return await i(h,u,p),p};return{render(t,e){const n=a.get(e);return void 0!==n?Promise.resolve(n):h(t,e)}}})(Go,Xi,xo,vo,xr),Cr=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const s=e.createIIRFilter(i.feedforward,i.feedback);return Ms(s,i),s})(br),Ar=((t,e,n,i,s,o)=>class extends t{constructor(t,r){const a=i(t),l=s(a),h={...Ts,...r},u=e(a,l?null:t.baseLatency,h);super(t,!1,u,l?n(h.feedback,h.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,s)=>{if(n.length!==i.length||i.length!==s.length)throw xs();return e.call(t,n,i,s)})})(u),this._nativeIIRFilterNode=u,o(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Po,Cr,Tr,wo,To,Qo),kr=((t,e,n,i,s,o,r,a)=>(l,h)=>{const u=h.listener,{forwardX:c,forwardY:p,forwardZ:d,positionX:f,positionY:_,positionZ:m,upX:g,upY:v,upZ:y}=void 0===u.forwardX?(()=>{const c=new Float32Array(1),p=e(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),d=r(h);let f=!1,_=[0,0,-1,0,1,0],m=[0,0,0];const g=()=>{if(f)return;f=!0;const t=i(h,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[o(t,c,0),o(t,c,1),o(t,c,2),o(t,c,3),o(t,c,4),o(t,c,5)];e.some(((t,e)=>t!==_[e]))&&(u.setOrientation(...e),_=e);const n=[o(t,c,6),o(t,c,7),o(t,c,8)];n.some(((t,e)=>t!==m[e]))&&(u.setPosition(...n),m=n)},p.connect(t)},v=t=>e=>{e!==_[t]&&(_[t]=e,u.setOrientation(..._))},y=t=>e=>{e!==m[t]&&(m[t]=e,u.setPosition(...m))},w=(e,i,o)=>{const r=n(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});r.connect(p,0,e),r.start(),Object.defineProperty(r.offset,"defaultValue",{get:()=>i});const u=t({context:l},d,r.offset,Pi,Li);var c,f,_,m,v,y,w;return a(u,"value",(t=>()=>t.call(u)),(t=>e=>{try{t.call(u,e)}catch(t){if(9!==t.code)throw t}g(),d&&o(e)})),u.cancelAndHoldAtTime=(c=u.cancelAndHoldAtTime,d?()=>{throw s()}:(...t)=>{const e=c.apply(u,t);return g(),e}),u.cancelScheduledValues=(f=u.cancelScheduledValues,d?()=>{throw s()}:(...t)=>{const e=f.apply(u,t);return g(),e}),u.exponentialRampToValueAtTime=(_=u.exponentialRampToValueAtTime,d?()=>{throw s()}:(...t)=>{const e=_.apply(u,t);return g(),e}),u.linearRampToValueAtTime=(m=u.linearRampToValueAtTime,d?()=>{throw s()}:(...t)=>{const e=m.apply(u,t);return g(),e}),u.setTargetAtTime=(v=u.setTargetAtTime,d?()=>{throw s()}:(...t)=>{const e=v.apply(u,t);return g(),e}),u.setValueAtTime=(y=u.setValueAtTime,d?()=>{throw s()}:(...t)=>{const e=y.apply(u,t);return g(),e}),u.setValueCurveAtTime=(w=u.setValueCurveAtTime,d?()=>{throw s()}:(...t)=>{const e=w.apply(u,t);return g(),e}),u};return{forwardX:w(0,0,v(0)),forwardY:w(1,0,v(1)),forwardZ:w(2,-1,v(2)),positionX:w(6,0,y(0)),positionY:w(7,0,y(1)),positionZ:w(8,0,y(2)),upX:w(3,0,v(3)),upY:w(4,1,v(4)),upZ:w(5,0,v(5))}})():u;return{get forwardX(){return c},get forwardY(){return p},get forwardZ(){return d},get positionX(){return f},get positionY(){return _},get positionZ(){return m},get upX(){return g},get upY(){return v},get upZ(){return y}}})(Wo,nr,lr,qs,Gs,Ks,To,Js),Sr=new WeakMap,Mr=((t,e,n,i,s,o)=>class extends n{constructor(n,o){super(n),this._nativeContext=n,ri.set(this,n),i(n)&&s.set(n,new Set),this._destination=new t(this,o),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Yo,kr,Ao,To,Sr,oo),Er=((t,e,n,i,s,o)=>(r,a)=>{const l=r.createOscillator();return Ms(l,a),Ls(l,a,"detune"),Ls(l,a,"frequency"),void 0!==a.periodicWave?l.setPeriodicWave(a.periodicWave):Ss(l,a,"type"),e(n,(()=>n(r)))||Ps(l),e(i,(()=>i(r)))||o(l,r),e(s,(()=>s(r)))||Os(l),t(r,l),l})(Zo,co,eo,no,io,so),Lr=((t,e,n,i,s)=>()=>{const o=new WeakMap;let r=null,a=null,l=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){l=t},render(h,u){const c=o.get(u);return void 0!==c?Promise.resolve(c):(async(h,u)=>{let c=n(h);const p=Ai(c,u);if(!p){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,periodicWave:null===r?void 0:r,type:c.type};c=e(u,t),null!==a&&c.start(a),null!==l&&c.stop(l)}return o.set(u,c),p?(await t(u,h.detune,c.detune),await t(u,h.frequency,c.frequency)):(await i(u,h.detune,c.detune),await i(u,h.frequency,c.frequency)),await s(h,u,c),c})(h,u)}}})(qo,Er,Xi,Uo,vo),Pr=((t,e,n,i,s,o,r)=>class extends t{constructor(t,r){const a=s(t),l={...$s,...r},h=n(a,l),u=o(a),c=u?i():null,p=t.sampleRate/2;super(t,!1,h,c),this._detune=e(this,u,h.detune,153600,-153600),this._frequency=e(this,u,h.frequency,p,-p),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=c,null!==this._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=l.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){wi(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),Oi(this)&&xi(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Po,Wo,Er,Lr,wo,To,oo),Or=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return i.buffer=s,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(Go),Ir=((t,e,n,i,s)=>(o,{curve:r,oversample:a,...l})=>{const h=o.createWaveShaper(),u=o.createWaveShaper();Ms(h,l),Ms(u,l);const c=n(o,{...l,gain:1}),p=n(o,{...l,gain:-1}),d=n(o,{...l,gain:1}),f=n(o,{...l,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){c.channelCount=t,p.channelCount=t,h.channelCount=t,d.channelCount=t,u.channelCount=t,f.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){c.channelCountMode=t,p.channelCountMode=t,h.channelCountMode=t,d.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t,p.channelInterpretation=t,h.channelInterpretation=t,d.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t},get context(){return h.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)h.curve=n,u.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const s=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<s;r+=1){const a=r/s*o,l=Math.floor(a),h=Math.ceil(a);e[r]=l===h?n[l]:(1-(a-l))*n[l]+(1-(h-a))*n[h],i[r]=l===h?-n[t-1-l]:-(1-(a-l))*n[t-1-l]-(1-(h-a))*n[t-1-h]}e[s]=t%2==1?n[s-1]:(n[s-2]+n[s-1])/2,h.curve=e,u.curve=i}g=n,m&&(i(g)&&null===_?_=t(o,c):null!==_&&(_(),_=null))},get inputs(){return[c]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(t){h.oversample=t,u.oversample=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2])};null!==r&&(v.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==v.oversample&&(v.oversample=a);return s(zs(v,d),(()=>{c.connect(h).connect(d),c.connect(p).connect(u).connect(f).connect(d),m=!0,i(g)&&(_=t(o,c))}),(()=>{c.disconnect(h),h.disconnect(d),c.disconnect(p),p.disconnect(u),u.disconnect(f),f.disconnect(d),m=!1,null!==_&&(_(),_=null)}))})(Or,bs,Vs,Qs,tr),Dr=((t,e,n,i,s,o,r)=>(a,l)=>{const h=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name&&void 0===a.createGain().gain.automationRate)return n(a,l);Ms(h,l);const u=null===l.curve||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(null!==u&&u.length<2)throw e();Ss(h,{curve:u},"curve"),Ss(h,l,"oversample");let c=null,p=!1;r(h,"curve",(t=>()=>t.call(h)),(e=>n=>(e.call(h,n),p&&(i(n)&&null===c?c=t(a,h):i(n)||null===c||(c(),c=null)),n)));return s(h,(()=>{p=!0,i(h.curve)&&(c=t(a,h))}),(()=>{p=!1,null!==c&&(c(),c=null)}))})(Or,bs,Ir,Qs,tr,ko,Js),Nr=((t,e,n,i,s,o,r,a,l,h)=>(u,{coneInnerAngle:c,coneOuterAngle:p,coneOuterGain:d,distanceModel:f,maxDistance:_,orientationX:m,orientationY:g,orientationZ:v,panningModel:y,positionX:w,positionY:b,positionZ:x,refDistance:T,rolloffFactor:C,...A})=>{const k=u.createPanner();if(A.channelCount>2)throw r();if("max"===A.channelCountMode)throw r();Ms(k,A);const S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},M=n(u,{...S,channelInterpretation:"speakers",numberOfInputs:6}),E=i(u,{...A,gain:1}),L=i(u,{...S,gain:1}),P=i(u,{...S,gain:0}),O=i(u,{...S,gain:0}),I=i(u,{...S,gain:0}),D=i(u,{...S,gain:0}),N=i(u,{...S,gain:0}),R=s(u,256,6,1),z=o(u,{...S,curve:new Float32Array([1,1]),oversample:"none"});let B=[m,g,v],V=[w,b,x];const F=new Float32Array(1);R.onaudioprocess=({inputBuffer:t})=>{const e=[l(t,F,0),l(t,F,1),l(t,F,2)];e.some(((t,e)=>t!==B[e]))&&(k.setOrientation(...e),B=e);const n=[l(t,F,3),l(t,F,4),l(t,F,5)];n.some(((t,e)=>t!==V[e]))&&(k.setPosition(...n),V=n)},Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0});const Z={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(t){if(t>2)throw r();E.channelCount=t,k.channelCount=t},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){if("max"===t)throw r();E.channelCountMode=t,k.channelCountMode=t},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(t){E.channelInterpretation=t,k.channelInterpretation=t},get coneInnerAngle(){return k.coneInnerAngle},set coneInnerAngle(t){k.coneInnerAngle=t},get coneOuterAngle(){return k.coneOuterAngle},set coneOuterAngle(t){k.coneOuterAngle=t},get coneOuterGain(){return k.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();k.coneOuterGain=t},get context(){return k.context},get distanceModel(){return k.distanceModel},set distanceModel(t){k.distanceModel=t},get inputs(){return[E]},get maxDistance(){return k.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;k.maxDistance=t},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get orientationX(){return L.gain},get orientationY(){return P.gain},get orientationZ(){return O.gain},get panningModel(){return k.panningModel},set panningModel(t){k.panningModel=t},get positionX(){return I.gain},get positionY(){return D.gain},get positionZ(){return N.gain},get refDistance(){return k.refDistance},set refDistance(t){if(t<0)throw new RangeError;k.refDistance=t},get rolloffFactor(){return k.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;k.rolloffFactor=t},addEventListener:(...t)=>E.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>E.dispatchEvent(t[0]),removeEventListener:(...t)=>E.removeEventListener(t[0],t[1],t[2])};c!==Z.coneInnerAngle&&(Z.coneInnerAngle=c),p!==Z.coneOuterAngle&&(Z.coneOuterAngle=p),d!==Z.coneOuterGain&&(Z.coneOuterGain=d),f!==Z.distanceModel&&(Z.distanceModel=f),_!==Z.maxDistance&&(Z.maxDistance=_),m!==Z.orientationX.value&&(Z.orientationX.value=m),g!==Z.orientationY.value&&(Z.orientationY.value=g),v!==Z.orientationZ.value&&(Z.orientationZ.value=v),y!==Z.panningModel&&(Z.panningModel=y),w!==Z.positionX.value&&(Z.positionX.value=w),b!==Z.positionY.value&&(Z.positionY.value=b),x!==Z.positionZ.value&&(Z.positionZ.value=x),T!==Z.refDistance&&(Z.refDistance=T),C!==Z.rolloffFactor&&(Z.rolloffFactor=C),1===B[0]&&0===B[1]&&0===B[2]||k.setOrientation(...B),0===V[0]&&0===V[1]&&0===V[2]||k.setPosition(...V);return h(zs(Z,k),(()=>{E.connect(k),t(E,z,0,0),z.connect(L).connect(M,0,0),z.connect(P).connect(M,0,1),z.connect(O).connect(M,0,2),z.connect(I).connect(M,0,3),z.connect(D).connect(M,0,4),z.connect(N).connect(M,0,5),M.connect(R).connect(u.destination)}),(()=>{E.disconnect(k),a(E,z,0,0),z.disconnect(L),L.disconnect(M),z.disconnect(P),P.disconnect(M),z.disconnect(O),O.disconnect(M),z.disconnect(I),I.disconnect(M),z.disconnect(D),D.disconnect(M),z.disconnect(N),N.disconnect(M),M.disconnect(R),R.disconnect(u.destination)}))})(Gi,bs,nr,Vs,qs,Dr,Gs,Hi,Ks,tr),Rr=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(Ms(i,n),Ls(i,n,"orientationX"),Ls(i,n,"orientationY"),Ls(i,n,"orientationZ"),Ls(i,n,"positionX"),Ls(i,n,"positionY"),Ls(i,n,"positionZ"),Ss(i,n,"coneInnerAngle"),Ss(i,n,"coneOuterAngle"),Ss(i,n,"coneOuterGain"),Ss(i,n,"distanceModel"),Ss(i,n,"maxDistance"),Ss(i,n,"panningModel"),Ss(i,n,"refDistance"),Ss(i,n,"rolloffFactor"),i)})(Nr),zr=((t,e,n,i,s,o,r,a,l,h)=>()=>{const u=new WeakMap;let c=null;return{render(p,d){const f=u.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=null,_=o(p);const m={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},g={...m,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},v=Ai(_,d);if("bufferSize"in _)f=i(d,{...m,gain:1});else if(!v){const t={...g,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=s(d,t)}if(u.set(d,null===f?_:f),null!==f){if(null===c){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,p.context.length,d.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),c=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,i)=>{const s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,s.offset),s})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return h(t)})()}const t=await c,o=i(d,{...m,gain:1});await l(p,d,o);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let _=[u[0][0],u[1][0],u[2][0]],v=[u[3][0],u[4][0],u[5][0]],y=i(d,{...m,gain:1}),w=s(d,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]});o.connect(y).connect(w.inputs[0]),w.connect(f);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],n=[u[3][e],u[4][e],u[5][e]];if(t.some(((t,e)=>t!==_[e]))||n.some(((t,e)=>t!==v[e]))){_=t,v=n;const r=e/d.sampleRate;y.gain.setValueAtTime(0,r),y=i(d,{...m,gain:0}),w=s(d,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),y.gain.setValueAtTime(1,r),o.connect(y).connect(w.inputs[0]),w.connect(f)}}return f}return v?(await t(d,p.orientationX,_.orientationX),await t(d,p.orientationY,_.orientationY),await t(d,p.orientationZ,_.orientationZ),await t(d,p.positionX,_.positionX),await t(d,p.positionY,_.positionY),await t(d,p.positionZ,_.positionZ)):(await a(d,p.orientationX,_.orientationX),await a(d,p.orientationY,_.orientationY),await a(d,p.orientationZ,_.orientationZ),await a(d,p.positionX,_.positionX),await a(d,p.positionY,_.positionY),await a(d,p.positionZ,_.positionZ)),qi(_)?await l(p,d,_.inputs[0]):await l(p,d,_),_})(p,d)}}})(qo,nr,lr,Vs,Rr,Xi,xo,Uo,vo,xr),Br=((t,e,n,i,s,o,r)=>class extends t{constructor(t,a){const l=s(t),h={...Ws,...a},u=n(l,h),c=o(l);super(t,!1,u,c?i():null),this._nativePannerNode=u,this._orientationX=e(this,c,u.orientationX,Pi,Li),this._orientationY=e(this,c,u.orientationY,Pi,Li),this._orientationZ=e(this,c,u.orientationZ,Pi,Li),this._positionX=e(this,c,u.positionX,Pi,Li),this._positionY=e(this,c,u.positionY,Pi,Li),this._positionZ=e(this,c,u.positionZ,Pi,Li),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Po,Wo,Rr,zr,wo,To,Qo),Vr=(t=>(e,{disableNormalization:n,imag:i,real:s})=>{const o=i instanceof Float32Array?i:new Float32Array(i),r=s instanceof Float32Array?s:new Float32Array(s),a=e.createPeriodicWave(r,o,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(Si),Fr=((t,e,n,i)=>class s{constructor(s,o){const r=e(s),a=i({...Hs,...o}),l=t(r,a);return n.add(l),l}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===s.prototype||n.has(t)}})(Vr,wo,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Zr=((t,e,n,i,s,o)=>{const r=16385,a=new Float32Array([1,1]),l=Math.PI/2,h={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...h,oversample:"none"},c=(t,o,c,p,d)=>{if(1===o)return((t,e,s,o)=>{const c=new Float32Array(r),p=new Float32Array(r);for(let t=0;t<r;t+=1){const e=t/16384*l;c[t]=Math.cos(e),p[t]=Math.sin(e)}const d=n(t,{...h,gain:0}),f=i(t,{...u,curve:c}),_=i(t,{...u,curve:a}),m=n(t,{...h,gain:0}),g=i(t,{...u,curve:p});return{connectGraph(){e.connect(d),e.connect(void 0===_.inputs?_:_.inputs[0]),e.connect(m),_.connect(s),s.connect(void 0===f.inputs?f:f.inputs[0]),s.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(d.gain),g.connect(m.gain),d.connect(o,0,0),m.connect(o,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(void 0===_.inputs?_:_.inputs[0]),e.disconnect(m),_.disconnect(s),s.disconnect(void 0===f.inputs?f:f.inputs[0]),s.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(d.gain),g.disconnect(m.gain),d.disconnect(o,0,0),m.disconnect(o,0,1)}}})(t,c,p,d);if(2===o)return((t,s,o,c)=>{const p=new Float32Array(r),d=new Float32Array(r),f=new Float32Array(r),_=new Float32Array(r),m=Math.floor(8192.5);for(let t=0;t<r;t+=1)if(t>m){const e=(t-m)/(16384-m)*l;p[t]=Math.cos(e),d[t]=Math.sin(e),f[t]=0,_[t]=1}else{const e=t/(16384-m)*l;p[t]=1,d[t]=0,f[t]=Math.cos(e),_[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...h,gain:0}),y=i(t,{...u,curve:p}),w=n(t,{...h,gain:0}),b=i(t,{...u,curve:d}),x=i(t,{...u,curve:a}),T=n(t,{...h,gain:0}),C=i(t,{...u,curve:f}),A=n(t,{...h,gain:0}),k=i(t,{...u,curve:_});return{connectGraph(){s.connect(g),s.connect(void 0===x.inputs?x:x.inputs[0]),g.connect(v,0),g.connect(w,0),g.connect(T,1),g.connect(A,1),x.connect(o),o.connect(void 0===y.inputs?y:y.inputs[0]),o.connect(void 0===b.inputs?b:b.inputs[0]),o.connect(void 0===C.inputs?C:C.inputs[0]),o.connect(void 0===k.inputs?k:k.inputs[0]),y.connect(v.gain),b.connect(w.gain),C.connect(T.gain),k.connect(A.gain),v.connect(c,0,0),T.connect(c,0,0),w.connect(c,0,1),A.connect(c,0,1)},disconnectGraph(){s.disconnect(g),s.disconnect(void 0===x.inputs?x:x.inputs[0]),g.disconnect(v,0),g.disconnect(w,0),g.disconnect(T,1),g.disconnect(A,1),x.disconnect(o),o.disconnect(void 0===y.inputs?y:y.inputs[0]),o.disconnect(void 0===b.inputs?b:b.inputs[0]),o.disconnect(void 0===C.inputs?C:C.inputs[0]),o.disconnect(void 0===k.inputs?k:k.inputs[0]),y.disconnect(v.gain),b.disconnect(w.gain),C.disconnect(T.gain),k.disconnect(A.gain),v.disconnect(c,0,0),T.disconnect(c,0,0),w.disconnect(c,0,1),A.disconnect(c,0,1)}}})(t,c,p,d);throw s()};return(e,{channelCount:i,channelCountMode:r,pan:a,...l})=>{if("max"===r)throw s();const h=t(e,{...l,channelCount:1,channelCountMode:r,numberOfInputs:2}),u=n(e,{...l,channelCount:i,channelCountMode:r,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=c(e,i,u,p,h);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount!==t&&(m&&f(),({connectGraph:d,disconnectGraph:f}=c(e,t,u,p,h)),m&&d()),u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw s();u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2])};let m=!1;return o(zs(_,h),(()=>{d(),m=!0}),(()=>{f(),m=!1}))}})(nr,Rs,Vs,Dr,Gs,tr),jr=((t,e)=>(n,i)=>{const s=i.channelCountMode;if("clamped-max"===s)throw e();if(void 0===n.createStereoPanner)return t(n,i);const o=n.createStereoPanner();return Ms(o,i),Ls(o,i,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>s,set:t=>{if(t!==s)throw e()}}),o})(Zr,Gs),qr=((t,e,n,i,s)=>()=>{const o=new WeakMap;return{render(r,a){const l=o.get(a);return void 0!==l?Promise.resolve(l):(async(r,a)=>{let l=n(r);const h=Ai(l,a);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(a,t)}return o.set(a,l),h?await t(a,r.pan,l.pan):await i(a,r.pan,l.pan),qi(l)?await s(r,a,l.inputs[0]):await s(r,a,l),l})(r,a)}}})(qo,jr,Xi,Uo,vo),Gr=((t,e,n,i,s,o)=>class extends t{constructor(t,r){const a=s(t),l={...Xs,...r},h=n(a,l),u=o(a);super(t,!1,h,u?i():null),this._pan=e(this,u,h.pan)}get pan(){return this._pan}})(Po,Wo,jr,qr,wo,To),Ur=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,o){const r=i.get(o);return void 0!==r?Promise.resolve(r):(async(s,o)=>{let r=e(s);if(!Ai(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,curve:r.curve,oversample:r.oversample};r=t(o,e)}return i.set(o,r),qi(r)?await n(s,o,r.inputs[0]):await n(s,o,r),r})(s,o)}}})(Dr,Xi,vo),$r=((t,e,n,i,s,o,r)=>class extends t{constructor(t,e){const a=s(t),l={...Ys,...e},h=n(a,l);super(t,!0,h,o(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Po,bs,Dr,Ur,wo,To,Qo),Wr=(t=>null!==t&&t.isSecureContext)(_o),Hr=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(_o),Xr=new WeakMap,Yr=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(Xr,xo),Kr=Wr?((t,e,n,i,s,o,r,a,l,h,u,c,p)=>{let d=0;return(f,_,m={credentials:"omit"})=>{const g=u.get(f);if(void 0!==g&&g.has(_))return Promise.resolve();const v=h.get(f);if(void 0!==v){const t=v.get(_);if(void 0!==t)return t}const y=o(f),w=void 0===y.audioWorklet?s(_).then((([t,e])=>{const[i,s]=di(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${s}\n})})(window,'_AWGS')`)})).then((()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;i(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=hi.get(y);if(void 0!==i){if(i.has(t))throw e();_i(n),fi(n.parameterDescriptors),i.set(t,n)}else _i(n),fi(n.parameterDescriptors),hi.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))})):Promise.all([s(_),Promise.resolve(t(c,c))]).then((([[t,e],n])=>{const i=d+1;d=i;const[s,o]=di(t,e),h=new Blob([`${s};((AudioWorkletProcessor,registerProcessor)=>{${o}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(h);return y.audioWorklet.addModule(u,m).then((()=>{if(a(y))return y;const t=r(y);return t.audioWorklet.addModule(u,m).then((()=>t))})).then((t=>{if(null===l)throw new SyntaxError;try{new l(t,`__sac${i}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(u)))}));return void 0===v?h.set(f,new Map([[_,w]])):v.set(_,w),w.then((()=>{const t=u.get(f);void 0===t?u.set(f,new Set([_])):t.add(_)})).finally((()=>{const t=h.get(f);void 0!==t&&t.delete(_)})),w}})(co,Gs,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const s=t.document.head;if(null===s)i(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),l=t.onerror,h=()=>{t.onerror=l,URL.revokeObjectURL(a)};t.onerror=(e,n,s,o,r)=>n===a||n===t.location.href&&1===s&&1===o?(h(),i(r),!1):null!==l?l(e,n,s,o,r):void 0,o.onerror=()=>{h(),i(new SyntaxError)},o.onload=()=>{h(),n()},o.src=a,o.type="module",s.appendChild(o)}})))(_o),Hr,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),wo,Yr,To,Lo,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),s=URL.createObjectURL(n);let o=!1,r=!1;try{await i.audioWorklet.addModule(s);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,n.connect(e),n.start(0),await i.startRendering()}catch{}finally{URL.revokeObjectURL(s)}return o&&!r})(Lo,xo),_o):void 0,Qr=((t,e)=>n=>t(n)||e(n))(So,To),Jr=((t,e,n,i,s,o,r,a,l,h,u)=>(c,p)=>{const d=r(c)?c:o(c);if(s.has(p)){const t=n();return Promise.reject(t)}try{s.add(p)}catch{}return e(l,(()=>l(d)))?d.decodeAudioData(p).then((n=>(ms(p).catch((()=>{})),e(a,(()=>a(n)))||u(n),t.add(n),n))):new Promise(((e,n)=>{const s=async()=>{try{await ms(p)}catch{}},o=t=>{n(t),s()};try{d.decodeAudioData(p,(n=>{"function"!=typeof n.copyFromChannel&&(h(n),Mi(n)),t.add(n),s().then((()=>e(n)))}),(t=>{o(null===t?i():t)}))}catch(t){o(t)}}))})(Do,co,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,wo,Qr,ki,ks,Bo,Vo),ta=((t,e,n,i,s,o,r,a,l,h,u,c,p,d,f,_,m,g,v,y)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new c(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new _(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return h(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}})(Kr,Io,Fo,Xo,Jo,sr,rr,ur,dr,Jr,_r,vr,wr,Ar,Mr,Pr,Br,Fr,Gr,$r),ea=((t,e,n,i)=>class extends t{constructor(t,s){const o=n(t),r=e(o,s);if(i(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Po,((t,e)=>t.createMediaElementSource(e.mediaElement)),wo,To),na=((t,e,n,i)=>class extends t{constructor(t,s){const o=n(t);if(i(o))throw new TypeError;const r={...As,...s},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Po,((t,e)=>{const n=t.createMediaStreamDestination();return Ms(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),wo,To),ia=((t,e,n,i)=>class extends t{constructor(t,s){const o=n(t),r=e(o,s);if(i(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Po,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),s=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(s,"mediaStream",{value:e}),s}),wo,To),sa=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const s=new MediaStream([i]),o=n.createMediaStreamSource(s);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return o})(bs,To),oa=((t,e,n)=>class extends t{constructor(t,i){const s=n(t);super(t,!0,e(s,i),null)}})(Po,sa,wo),ra=((t,e,n,i,s,o,r,a,l)=>class extends t{constructor(t={}){if(null===l)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new l(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:s}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===s?512/o:"interactive"===s||void 0===s?256/o:"playback"===s?1024/o:128*Math.max(2,Math.min(128,Math.round(s*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===l.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),zi(this)})))}createMediaElementSource(t){return new s(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(ta,bs,Gs,(()=>new DOMException("","UnknownError")),ea,na,ia,oa,ko),aa=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Sr),la=(t=>(e,n)=>{t(e).add(n)})(aa),ha=(t=>(e,n,i=0,s=0)=>{const o=e[i];if(void 0===o)throw t();return es(n)?o.connect(n,0,s):o.connect(n,0)})(Si),ua=(t=>(e,n)=>{t(e).delete(n)})(aa),ca=(t=>(e,n,i,s=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?vs(t,e,n).disconnect():es(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===s?vs(t,e,i).disconnect(n,0):vs(t,e,i).disconnect(n,0,s):void 0===i?e.forEach((t=>t.disconnect(n))):vs(t,e,i).disconnect(n,0))(Si),pa=new WeakMap,da=((t,e)=>n=>e(t,n))(pa,mi),fa=((t,e,n,i,s,o,r,a,l,h,u,c,p)=>(d,f,_,m)=>{if(0===m.numberOfInputs&&0===m.numberOfOutputs)throw l();const g=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(g.some((t=>t<1)))throw l();if(g.length!==m.numberOfOutputs)throw e();if("explicit"!==m.channelCountMode)throw l();const v=m.channelCount*m.numberOfInputs,y=g.reduce(((t,e)=>t+e),0),w=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length;if(v+w>6||y>6)throw l();const b=new MessageChannel,x=[],T=[];for(let t=0;t<m.numberOfInputs;t+=1)x.push(r(d,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),T.push(s(d,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const C=[];if(void 0!==_.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of _.parameterDescriptors){const s=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==m.parameterData[i]?m.parameterData[i]:void 0===t?0:t});Object.defineProperties(s.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?Pi:e},minValue:{get:()=>void 0===n?Li:n}}),C.push(s)}const A=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+w)}),k=Is(f,d.sampleRate),S=a(d,k,v+w,Math.max(1,y)),M=s(d,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),E=[];for(let t=0;t<m.numberOfOutputs;t+=1)E.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[t]}));for(let t=0;t<m.numberOfInputs;t+=1){x[t].connect(T[t]);for(let e=0;e<m.channelCount;e+=1)T[t].connect(A,e,t*m.channelCount+e)}const L=new os(void 0===_.parameterDescriptors?[]:_.parameterDescriptors.map((({name:t},e)=>{const n=C[e];return n.connect(A,0,v+e),n.start(0),[t,n.offset]})));A.connect(S);let P=m.channelInterpretation,O=null;const I=0===m.numberOfOutputs?[S]:E,D={get bufferSize(){return k},get channelCount(){return m.channelCount},set channelCount(t){throw n()},get channelCountMode(){return m.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return P},set channelInterpretation(t){for(const e of x)e.channelInterpretation=t;P=t},get context(){return S.context},get inputs(){return x},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return O},set onprocessorerror(t){"function"==typeof O&&D.removeEventListener("processorerror",O),O="function"==typeof t?t:null,"function"==typeof O&&D.addEventListener("processorerror",O)},get parameters(){return L},get port(){return b.port2},addEventListener:(...t)=>S.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,I),disconnect:h.bind(null,I),dispatchEvent:(...t)=>S.dispatchEvent(t[0]),removeEventListener:(...t)=>S.removeEventListener(t[0],t[1],t[2])},N=new Map;var R,z;b.port1.addEventListener=(R=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=N.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(d.currentTime,d.sampleRate,(()=>e(t)))},N.set(e,t[1]))}}return R.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(z=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=N.get(t[1]);void 0!==e&&(N.delete(t[1]),t[1]=e)}return z.call(b.port1,t[0],t[1],t[2])});let B=null;Object.defineProperty(b.port1,"onmessage",{get:()=>B,set:t=>{"function"==typeof B&&b.port1.removeEventListener("message",B),B="function"==typeof t?t:null,"function"==typeof B&&(b.port1.addEventListener("message",B),b.port1.start())}}),_.prototype.port=b.port1;let V=null;const F=((t,e,n,i)=>{let s=ui.get(t);void 0===s&&(s=new WeakMap,ui.set(t,s));const o=Ds(n,i);return s.set(e,o),o})(d,D,_,m);F.then((t=>V=t));const Z=hs(m.numberOfInputs,m.channelCount),j=hs(m.numberOfOutputs,g),q=void 0===_.parameterDescriptors?[]:_.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let G=!0;const U=()=>{m.numberOfOutputs>0&&S.disconnect(M);for(let t=0,e=0;t<m.numberOfOutputs;t+=1){const n=E[t];for(let i=0;i<g[t];i+=1)M.disconnect(n,e+i,i);e+=g[t]}},$=new Map;S.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==V){const n=c(D);for(let i=0;i<k;i+=128){for(let e=0;e<m.numberOfInputs;e+=1)for(let n=0;n<m.channelCount;n+=1)as(t,Z[e],n,n,i);void 0!==_.parameterDescriptors&&_.parameterDescriptors.forEach((({name:e},n)=>{as(t,q,e,v+n,i)}));for(let t=0;t<m.numberOfInputs;t+=1)for(let e=0;e<g[t];e+=1)0===j[t][e].byteLength&&(j[t][e]=new Float32Array(128));try{const t=Z.map(((t,e)=>{if(n[e].size>0)return $.set(e,k/128),t;const i=$.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?$.delete(e):$.set(e,i-1)),t)})),s=u(d.currentTime+i/d.sampleRate,d.sampleRate,(()=>V.process(t,j,q)));G=s;for(let t=0,n=0;t<m.numberOfOutputs;t+=1){for(let s=0;s<g[t];s+=1)ls(e,j[t],s,n+s,i);n+=g[t]}}catch(t){G=!1,D.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!G){for(let t=0;t<m.numberOfInputs;t+=1){x[t].disconnect(T[t]);for(let e=0;e<m.channelCount;e+=1)T[i].disconnect(A,e,t*m.channelCount+e)}if(void 0!==_.parameterDescriptors){const t=_.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=C[e];t.disconnect(A,0,v+e),t.stop()}}A.disconnect(S),S.onaudioprocess=null,W?U():Y();break}}}};let W=!1;const H=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),X=()=>S.connect(H).connect(d.destination),Y=()=>{S.disconnect(H),H.disconnect()};return X(),p(D,(()=>{if(G){Y(),m.numberOfOutputs>0&&S.connect(M);for(let t=0,e=0;t<m.numberOfOutputs;t+=1){const n=E[t];for(let i=0;i<g[t];i+=1)M.connect(n,e+i,i);e+=g[t]}}W=!0}),(()=>{G&&(X(),U()),W=!1}))})(ha,Si,bs,nr,Rs,lr,Vs,qs,Gs,ca,Hr,da,tr),_a=((t,e,n,i,s)=>(o,r,a,l,h,u)=>{if(null!==a)try{const e=new a(o,l,u),i=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(c=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return c.call(e,"error",t[1],t[2]),c.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return s(e,(()=>t.disconnect()),(()=>t.connect(o.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var c,p;if(void 0===h)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(o,r,h,u)})(bs,fa,Vs,Gs,tr),ma=((t,e,n,i,s,o,r,a,l,h,u,c,p,d,f,_)=>(m,g,v)=>{const y=new WeakMap;let w=null;return{render(b,x){a(x,b);const T=y.get(x);return void 0!==T?Promise.resolve(T):(async(a,b)=>{let x=u(a),T=null;const C=Ai(x,b),A=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===c){const t=A.reduce(((t,e)=>t+e),0),n=s(b,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(i(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:A[t]}));const h=r(b,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=e.bind(null,o),h.disconnect=l.bind(null,o),T=[n,o,h]}else C||(x=new c(b,m));if(y.set(b,null===T?x:T[2]),null!==T){if(null===w){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,l=async()=>{const l=new p(n,128*Math.ceil(a.context.length/128),b.sampleRate),h=[],u=[];for(let t=0;t<g.numberOfInputs;t+=1)h.push(r(l,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),u.push(s(l,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const c=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=o(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(l,t,e.offset),e}))),m=i(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){h[t].connect(u[t]);for(let e=0;e<g.channelCount;e+=1)u[t].connect(m,e,t*g.channelCount+e)}for(const[e,n]of c.entries())n.connect(m,0,t+e),n.start(0);return m.connect(l.destination),await Promise.all(h.map((t=>f(a,l,t)))),_(l)};w=us(a,0===n?null:await l(),b,g,A,v,h)}const t=await w,e=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[l,u,c]=T;null!==t&&(e.buffer=t,e.start(0)),e.connect(l);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=u[t];for(let i=0;i<A[t];i+=1)l.connect(n,e+i,i);e+=A[t]}return c}if(C)for(const[e,n]of a.parameters.entries())await t(b,n,x.parameters.get(e));else for(const[t,e]of a.parameters.entries())await d(b,e,x.parameters.get(t));return await f(a,b,x),x})(b,x)}}})(qo,ha,Go,nr,Rs,lr,Vs,ua,ca,Hr,Xi,Lo,xo,Uo,vo,xr),ga=(t=>e=>t.get(e))(Xr),va=(t=>(e,n)=>{t.set(e,n)})(pa),ya=Wr?((t,e,n,i,s,o,r,a,l,h,u,c,p,d)=>class extends e{constructor(e,d,f){var _;const m=a(e),g=l(m),v=u({...rs,...f});p(v);const y=hi.get(m),w=null==y?void 0:y.get(d),b=g||"closed"!==m.state?m:null!==(_=r(m))&&void 0!==_?_:m,x=s(b,g?null:e.baseLatency,h,d,w,v);super(e,!0,x,g?i(d,v,w):null);const T=[];x.parameters.forEach(((t,e)=>{const i=n(this,g,t);T.push([e,i])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new os(T),g&&t(m,this);const{activeInputs:C}=o(this);c(x,C)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(la,Po,Wo,ma,_a,Di,ga,wo,To,Lo,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),va,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),oo):void 0,wa=((t,e)=>(n,i,s)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,s)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Gs,xo),ba=((t,e,n,i,s,o,r,a)=>(l,h)=>n(l).render(l,h).then((()=>Promise.all(Array.from(i(h)).map((t=>n(t).render(t,h)))))).then((()=>s(h))).then((n=>("function"!=typeof n.copyFromChannel?(r(n),Mi(n)):e(o,(()=>o(n)))||a(n),t.add(n),n))))(Do,co,go,aa,xr,ki,Bo,Vo),xa=((t,e,n,i,s)=>class extends t{constructor(t,n,s){let o;if("number"==typeof t&&void 0!==n&&void 0!==s)o={length:n,numberOfChannels:t,sampleRate:s};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:l}={...Us,...o},h=i(a,r,l);e(ks,(()=>ks(h)))||h.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(h.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(h,a),this._length=r,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,zi(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(ta,co,bs,wa,ba),Ta=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(ri,So),Ca=((t,e)=>n=>t.has(n)||e(n))(ii,Mo),Aa=((t,e)=>n=>t.has(n)||e(n))(oi,Eo),ka=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(ri,To);function Sa(t,e){if(!t)throw new Error(e)}function Ma(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function Ea(t){t.isOffline||"running"===t.state||Pa('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let La=console;function Pa(...t){La.warn(...t)}function Oa(t){return void 0===t}function Ia(t){return!Oa(t)}function Da(t){return"number"==typeof t}function Na(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Ra(t){return"boolean"==typeof t}function za(t){return Array.isArray(t)}function Ba(t){return"string"==typeof t}function Va(t){return Ba(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const Fa="object"==typeof self?self:null,Za=Fa&&(Fa.hasOwnProperty("AudioContext")||Fa.hasOwnProperty("webkitAudioContext"));class ja{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function qa(t){return Aa(t)}function Ga(t){return Ca(t)}function Ua(t){return ka(t)}function $a(t){return Ta(t)}function Wa(t){return t instanceof AudioBuffer}function Ha(t,e){return"value"===t||qa(e)||Ga(e)||Wa(e)}function Xa(t,...e){if(!e.length)return t;const n=e.shift();if(Na(t)&&Na(n))for(const e in n)Ha(e,n[e])?t[e]=n[e]:Na(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Xa(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Xa(t,...e)}function Ya(t,e,n=[],i){const s={},o=Array.from(e);if(Na(o[0])&&i&&!Reflect.has(o[0],i)){Object.keys(o[0]).some((e=>Reflect.has(t,e)))||(Xa(s,{[i]:o[0]}),n.splice(n.indexOf(i),1),o.shift())}if(1===o.length&&Na(o[0]))Xa(s,o[0]);else for(let t=0;t<n.length;t++)Ia(o[t])&&(s[n[t]]=o[t]);return Xa(t,s)}function Ka(t,e){return Oa(t)?e:t}function Qa(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}
/**
     * Tone.js
     * @author Yotam Mann
     * @license http://opensource.org/licenses/MIT MIT License
     * @copyright 2014-2019 Yotam Mann
     */class Ja{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Fa&&this.toString()===Fa.TONE_DEBUG_CLASS)&&function(...t){La.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ja.version=qn;const tl=1e-6;function el(t,e){return t>e+tl}function nl(t,e){return el(t,e)||sl(t,e)}function il(t,e){return t+tl<e}function sl(t,e){return Math.abs(t-e)<tl}class ol extends Ja{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Ya(ol.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Sa(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Sa(nl(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(sl(this._timeline[e].time,t)){for(let n=e;n>=0&&sl(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&nl(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<s;){let i=Math.floor(n+(s-n)/2);const o=this._timeline[i],r=this._timeline[i+1];if(sl(o[e],t)){for(let n=i;n<this._timeline.length;n++){if(!sl(this._timeline[n][e],t))break;i=n}return i}if(il(o[e],t)&&el(r[e],t))return i;el(o[e],t)?s=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),s=this._search(e);return-1!==i&&-1!==s?(this._timeline[i].time!==t&&(i+=1),this._timeline[s].time===e&&(s-=1),this._iterate(n,i,s)):-1===i&&this._iterate(n,0,s),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&sl(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&sl(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const rl=[];function al(t){rl.push(t)}const ll=[];function hl(t){ll.push(t)}class ul extends Ja{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Oa(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Oa(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Oa(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(ul.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class cl extends ul{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class pl extends cl{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new ol,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Ya(pl.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new ra(t)}({latencyHint:t.latencyHint}),this._ticker=new ja(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,rl.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){Sa($a(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){Sa($a(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){Sa($a(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Sa(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Sa(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Sa(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Sa(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return Sa(Ia(ya),"This node only works in a secure context (https or localhost)"),new ya(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Rt(this,void 0,void 0,(function*(){Sa(Ia(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Rt(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Ba(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return $a(this._context)?this._context.resume():Promise.resolve()}close(){return Rt(this,void 0,void 0,(function*(){var t;$a(this._context)&&(yield this._context.close()),this._initialized&&(t=this,ll.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:s+e})};return i(),n}}function dl(t,e){za(e)?e.forEach((e=>dl(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function fl(t,e){za(e)?e.forEach((e=>fl(t,e))):Object.defineProperty(t,e,{writable:!0})}const _l=()=>{};class ml extends Ja{constructor(){super(),this.name="ToneAudioBuffer",this.onload=_l;const t=Ya(ml.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Wa(t.url)||t.url instanceof ml?this.set(t.url):Ba(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:_l,onload:_l,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:wl().sampleRate}set(t){return t instanceof ml?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Rt(this,void 0,void 0,(function*(){const e=ml.load(t).then((t=>{this.set(t),this.onload(this)}));ml.downloads.push(e);try{yield e}finally{const t=ml.downloads.indexOf(e);ml.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=za(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,s=wl(),o=s.createBuffer(n,i,s.sampleRate),r=e||1!==n?t:[t];for(let t=0;t<n;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(Da(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(Da(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Sa(n<i,"The start time must be less than the end time");const s=i-n,o=wl().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new ml(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new ml).fromArray(t)}static fromUrl(t){return Rt(this,void 0,void 0,(function*(){const e=new ml;return yield e.load(t)}))}static load(t){return Rt(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(ml.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===ml.baseUrl||ml.baseUrl.endsWith("/")?ml.baseUrl:ml.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const s=yield i.arrayBuffer();return yield wl().decodeAudioData(s)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Rt(this,void 0,void 0,(function*(){for(yield Promise.resolve();ml.downloads.length;)yield ml.downloads[0]}))}}ml.baseUrl="",ml.downloads=[];class gl extends pl{constructor(){var t,e,n;super({clockSource:"offline",context:Ua(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new xa(t,e,n)),lookAhead:0,updateInterval:Ua(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ua(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Rt(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Rt(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new ml(e)}))}close(){return Promise.resolve()}}const vl=new class extends cl{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Rt(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let yl=vl;function wl(){var t;return yl===vl&&Za&&(t=new pl,yl=$a(t)?new pl(t):Ua(t)?new gl(t):t),yl}if(Fa&&!Fa.TONE_SILENCE_LOGGING){}function bl(t){return Math.pow(2,t/12)}let xl=440;function Tl(t){return Math.round(Cl(t))}function Cl(t){return 69+12*Math.log2(t/xl)}class Al extends Ja{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Al&&this.fromType(this._val),Oa(this._val))return this._noArg();if(Ba(this._val)&&Oa(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Na(this._val)){let t=0;for(const e in this._val)if(Ia(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Ia(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Ba(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class kl extends Al{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new kl(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new kl(this.context,e[0]).toSeconds();return e.forEach((e=>{const s=new kl(this.context,e).toSeconds();Math.abs(s-t)<Math.abs(i-t)&&(n=e,i=s)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const s=i.toString();s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Tl(this.toFrequency())}_now(){return this.context.now()}}class Sl extends kl{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return xl}static set A4(t){!function(t){xl=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Sl.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Ml[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Sl.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Sl(this.context,this.valueOf()*bl(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return Tl(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Sl.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return El[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return function(t){return xl*Math.pow(2,(t-69)/12)}(t)}static ftom(t){return Tl(t)}}const Ml={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},El=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Ll extends kl{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Pl extends Ja{constructor(){super();const t=Ya(Pl.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:wl()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new kl(this.context,t).toSeconds()}toFrequency(t){return new Sl(this.context,t).toFrequency()}toTicks(t){return new Ll(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Oa(t[n])&&delete e[n]})),e}get(){const t=function(t){return t.constructor.getDefaults()}(this);return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Ia(n)&&Ia(n.value)&&Ia(n.setValueAtTime)?t[e]=n.value:n instanceof Pl?t[e]=n._getPartialProperties(t[e]):za(n)||Da(n)||Ba(n)||Ra(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Ia(this[e])&&(this[e]&&Ia(this[e].value)&&Ia(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Pl?this[e].set(t[e]):this[e]=t[e])})),this}}class Ol extends ol{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return Ma(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Il extends Pl{constructor(){super(Ya(Il.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Ya(Il.getDefaults(),arguments,["param","units","convert"]);for(Sa(Ia(t.param)&&(qa(t.param)||t.param instanceof Il),"param must be an AudioParam");!qa(t.param);)t.param=t.param._param;this._swappable=!!Ia(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new ol(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Ia(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Pl.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Ia(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Ia(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Ia(this.maxValue)&&Ia(this.minValue)&&Ma(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?(e=t,Math.log(e)/Math.LN10*20):t;var e}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Sa(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let s=this._initialValue;if(null===i)s=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)s=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}s="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else s=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(s=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Sa(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=sl(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Sa(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Sa(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(e);return this._assertRange(i),Sa(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const s=this._fromType(t[0])*i;this.setValueAtTime(this._toType(s),e);const o=n/(t.length-1);for(let n=1;n<t.length;n++){const s=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(s),e+n*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Sa(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Sa(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),s=this._events.getAfter(e);return i&&sl(i.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),"linearRampToValueAtTime"===s.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===s.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),s=i?i.time:e+2,o=(s-e)/10;for(let n=e;n<s;n+=o)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){Sa(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,s){return n+(e-n)*Math.exp(-(s-t)/i)}_linearInterpolate(t,e,n,i,s){return e+(s-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,s){return e*Math.pow(i/e,(s-t)/(n-t))}}class Dl extends Pl{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Ia(this.input)?qa(this.input)||this.input instanceof Il?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ia(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Ia(t)&&(t instanceof Dl||Ga(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();Sa(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Rl(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Pa("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(Ia(e))for(;e instanceof Dl;)e=e.input;for(;!Ga(t);)Ia(t.output)&&(t=t.output);qa(e)?t.disconnect(e,n):Ga(e)?t.disconnect(e,n,i):t.disconnect()}(this,t,e,n),this}chain(...t){return Nl(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Ia(this.input)&&(this.input instanceof Dl?this.input.dispose():Ga(this.input)&&this.input.disconnect()),Ia(this.output)&&(this.output instanceof Dl?this.output.dispose():Ga(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Nl(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Dl?t.connect(e):Ga(t)&&Rl(t,e),e)),e)}function Rl(t,e,n=0,i=0){for(Sa(Ia(t),"Cannot connect from undefined node"),Sa(Ia(e),"Cannot connect to undefined node"),(e instanceof Dl||Ga(e))&&Sa(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Sa(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Dl||e instanceof Il;)Ia(e.input)&&(e=e.input);for(;t instanceof Dl;)Ia(t.output)&&(t=t.output);qa(e)?t.connect(e,n):t.connect(e,n,i)}class zl extends Dl{constructor(){super(Ya(zl.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Ya(zl.getDefaults(),arguments,["gain","units"]);this.gain=new Il({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),dl(this,"gain")}static getDefaults(){return Object.assign(Dl.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Bl extends Dl{constructor(t){super(t),this.onended=_l,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new zl({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Dl.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:_l})}_startGain(t,e=1){Sa(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Sa(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==_l&&(this.onended(this),this.onended=_l,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Sa(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Vl extends Bl{constructor(){super(Ya(Vl.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Ya(Vl.getDefaults(),arguments,["offset"]);Rl(this._source,this._gainNode),this.offset=new Il({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Bl.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Fl extends Dl{constructor(){super(Ya(Fl.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Ya(Fl.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Vl({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Dl.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Zl(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Zl(t,e,n,i){(e instanceof Il||qa(e)||e instanceof Fl&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Fl&&(e.overridden=!0)),Rl(t,e,n,i)}class jl extends Il{constructor(){super(Ya(jl.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new ol(1/0),this._multiplier=1;const t=Ya(jl.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Il.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),s=this._events.get(e),o=Math.round(Math.max(1/n,1));for(let t=0;t<=o;t++){const o=n*t+e,r=this._exponentialApproach(s.time,s.value,i,n,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max(10*(e-i.time),1)),o=(e-i.time)/s;for(let t=0;t<=s;t++){const s=o*t+i.time,r=this._exponentialInterpolate(i.time,i.value,e,n,s);this.linearRampToValueAtTime(this._toType(r),s)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Oa(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const s=this._events.get(e);return s&&s.time===e&&"setValueAtTime"===s.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),s=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),o=Math.sqrt(Math.pow(i,2)-2*s*(e.ticks-t)),r=(-i+o)/s,a=(-i-o)/s;return(r>0?r:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),s=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-s}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class ql extends Fl{constructor(){super(Ya(ql.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Ya(ql.getDefaults(),arguments,["value"]);this.input=this._param=new jl({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Fl.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Gl extends Pl{constructor(){super(Ya(Gl.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Ol,this._tickOffset=new ol;const t=Ya(Gl.getDefaults(),arguments,["frequency"]);this.frequency=new ql({context:this.context,units:t.units,value:t.frequency}),dl(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Pl.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Ia(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let s=n,o=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(o=n.ticks,e=n.time),"started"===s.state&&"started"!==t.state&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),s=t})),this._state.remove(i),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(s=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(s+=t.time-e),i=t})),this._state.remove(n),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),s=Math.max(n.time,i.time),o=this.frequency.getTicksAtTime(s)+t-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let s=null;if(i&&"started"===i.state){const o=Math.max(i.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(i.time);let l=Math.ceil(a)-a;l=sl(l,1)?0:l;let h=this.frequency.getTimeOfTick(r+l);for(;h<e;){try{n(h,Math.round(this.getTicksAtTime(h)))}catch(t){s=t;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Ul extends Pl{constructor(){super(Ya(Ul.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=_l,this._lastUpdate=0,this._state=new Ol("stopped"),this._boundLoop=this._loop.bind(this);const t=Ya(Ul.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Gl({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,dl(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Pl.getDefaults(),{callback:_l,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Ea(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ul.mixin(Ul);class $l extends Ja{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Ya($l.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:_l,onload:_l,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Sa(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=_l,i=_l){return Ba(e)?this._buffers.set(t.toString(),new ml(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new ml(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Wl extends Ll{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Hl extends Pl{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new ol,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}al((t=>{t.draw=new Hl({context:t})})),hl((t=>{t.draw.dispose()}));class Xl extends Ja{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Sa(Ia(t.time),"Events must have a time property"),Sa(Ia(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Yl(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Yl{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Kl extends Dl{constructor(){super(Ya(Kl.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Ya(Kl.getDefaults(),arguments,["volume"]);this.input=this.output=new zl({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,dl(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Dl.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Ql extends Dl{constructor(){super(Ya(Ql.getDefaults(),arguments)),this.name="Destination",this.input=new Kl({context:this.context}),this.output=new zl({context:this.context}),this.volume=this.input.volume;const t=Ya(Ql.getDefaults(),arguments);Nl(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Dl.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Nl(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}al((t=>{t.destination=new Ql({context:t})})),hl((t=>{t.destination.dispose()}));class Jl extends Ja{constructor(t){super(),this.name="TimelineValue",this._timeline=new ol({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class th{constructor(t,e){this.id=th._eventId++;const n=Object.assign(th.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:_l,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}th._eventId=0;class eh extends th{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(eh.getDefaults(),e);this.duration=new Wl(t.context,n.duration).valueOf(),this._interval=new Wl(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},th.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Wl(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Wl(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Wl(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class nh extends Pl{constructor(){super(Ya(nh.getDefaults(),arguments)),this.name="Transport",this._loop=new Jl(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new ol,this._repeatedEvents=new Xl,this._syncedSignals=[],this._swingAmount=0;const t=Ya(nh.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Ul({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),dl(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Pl.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Wl(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new th(this,{callback:t,time:new Ll(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const s=new eh(this,{callback:t,duration:new kl(this.context,i).toTicks(),interval:new kl(this.context,e).toTicks(),time:new Ll(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){const n=new th(this,{callback:t,once:!0,time:new Ll(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new Wl(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Ia(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){za(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new kl(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new kl(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Wl(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Wl(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new zl(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),fl(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ul.mixin(nh),al((t=>{t.transport=new nh({context:t})})),hl((t=>{t.transport.dispose()}));class ih extends Dl{constructor(t){super(t),this.input=void 0,this._state=new Ol("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=_l,this._syncedStop=_l,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Kl({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,dl(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Dl.getDefaults(),{mute:!1,onstop:_l,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Oa(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(Ka(e,0)),t.duration=n?this.toSeconds(n):void 0);const s=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Ea(this.context),this._start(i,e,n);else Sa(el(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=Oa(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Ia(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let s;n.duration&&(s=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,s)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=_l,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class sh extends Bl{constructor(){super(Ya(sh.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Ya(sh.getDefaults(),arguments,["url","onload"]);Rl(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Il({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new ml(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Bl.getDefaults(),{url:new ml,loop:!1,loopEnd:0,loopStart:0,onload:_l,onerror:_l,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Sa(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(t);this._startGain(s,i),e=this.loop?Ka(e,this.loopStart):Ka(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;nl(o,t)&&(o=(o-e)%n+e),sl(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,il(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,o)),Ia(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(s+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function oh(t,e){return Rt(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new gl(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class rh extends Bl{constructor(){super(Ya(rh.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Ya(rh.getDefaults(),arguments,["frequency","type"]);Rl(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Il({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Il({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),dl(this,["frequency","detune"])}static getDefaults(){return Object.assign(Bl.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ah extends ih{constructor(){super(Ya(ah.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Ya(ah.getDefaults(),arguments,["frequency","type"]);this.frequency=new Fl({context:this.context,units:"frequency",value:t.frequency}),dl(this,"frequency"),this.detune=new Fl({context:this.context,units:"cents",value:t.detune}),dl(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ih.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new rh({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){const t=ah._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}));return t}{const t=ah._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Ia(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),ah._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),ah._periodicWaveCache.length>100&&ah._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Ma(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),s=new Float32Array(n);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,n=o,0===this._partials.length)return[i,s]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),n=o):this._partialCount=0,this._partials=[]}for(let r=1;r<n;++r){const n=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*n:0,this._partials[r-1]=a;break;case"sawtooth":a=n*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?n*n*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[r]=-a*Math.sin(e*r),s[r]=a*Math.cos(e*r)):(i[r]=0,s[r]=0)}return[i,s]}_inverseFFT(t,e,n){let i=0;const s=t.length;for(let o=0;o<s;o++)i+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let s=0;s<32;s++)n=Math.max(this._inverseFFT(t,e,s/32*i),n);return function(t,e,n){return Math.max(Math.min(t,n),e)}(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ah._periodicWaveCache=[];class lh extends Dl{constructor(){super(Object.assign(Ya(lh.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Zl(this,t,e,n),this}}class hh extends lh{constructor(){super(Object.assign(Ya(hh.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Ya(hh.getDefaults(),arguments,["mapping","length"]);za(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Fl.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,s=e;i<s;i++){const e=i/(s-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Sa(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class uh extends lh{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new hh({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class ch extends Fl{constructor(){super(Object.assign(Ya(ch.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Ya(ch.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new zl({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Fl.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ph extends ih{constructor(){super(Ya(ph.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new uh({context:this.context}),this._modulationNode=new zl({context:this.context});const t=Ya(ph.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ah({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ah({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ch({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),dl(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ah.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class dh extends ih{constructor(){super(Ya(dh.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new zl({context:this.context,gain:0});const t=Ya(dh.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ah({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Fl({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ah({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new ch({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new ch({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),dl(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ah.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class fh extends ih{constructor(){super(Ya(fh.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new zl({context:this.context,gain:0}),this._thresh=new hh({context:this.context,mapping:t=>t<=0?-1:1});const t=Ya(fh.getDefaults(),arguments,["frequency","width"]);this.width=new Fl({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ah({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),dl(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ih.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class _h extends ih{constructor(){super(Ya(_h.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Ya(_h.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Fl({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Fl({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,dl(this,["frequency","detune"])}static getDefaults(){return Object.assign(ah.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(Ma(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new ah({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):_l});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class mh extends ih{constructor(){super(Ya(mh.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new ch({context:this.context,value:2});const t=Ya(mh.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new fh({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ah({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),dl(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ih.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const gh={am:ph,fat:_h,fm:dh,oscillator:ah,pulse:fh,pwm:mh};class vh extends ih{constructor(){super(Ya(vh.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Ya(vh.getDefaults(),arguments,["frequency","type"]);this.frequency=new Fl({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Fl({context:this.context,units:"cents",value:t.detune}),dl(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ah.getDefaults(),dh.getDefaults(),ph.getDefaults(),_h.getDefaults(),fh.getDefaults(),mh.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=gh[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof gh[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&Da(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&Da(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Ba(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){return oh(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function yh(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ma(i,t,e),n.set(this,i)}})}}function wh(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ma(this.toSeconds(i),t,e),n.set(this,i)}})}}class bh extends ih{constructor(){super(Ya(bh.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Ya(bh.getDefaults(),arguments,["url","onload"]);this._buffer=new ml({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ih.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:_l,onerror:_l,playbackRate:1,reverse:!1})}load(t){return Rt(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=_l){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Ka(e,this._loopStart):Ka(e,0);const i=this.toSeconds(e),s=n;n=Ka(n,Math.max(this._buffer.duration-i,0));let o=this.toSeconds(n);o/=this._playbackRate,t=this.toSeconds(t);const r=new sh({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&Oa(s)?r.start(t,i):r.start(t,i,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Ma(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Ma(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Nt([wh(0)],bh.prototype,"fadeIn",void 0),Nt([wh(0)],bh.prototype,"fadeOut",void 0);class xh extends Dl{constructor(){super(Ya(xh.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Fl({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Ya(xh.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Dl.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Ba(t))return t;{let n;for(n in Th)if(Th[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Ba(n)&&Reflect.has(Th,n)){const i=Th[n];Na(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!za(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Sa(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),s=this.getValueAtTime(t);if(s>0){n=(1-s)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=s&&s<=i[t]){i=this._attackCurve.slice(t),i[0]=s;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const s=e*this.sustain,o=t+n;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(s,i+o):this._sig.exponentialApproachValueAtTime(s,o,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Sa(za(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Zl(this,t,e,n),this}asArray(t=1024){return Rt(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new gl(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),o=.1*s,r=s+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+o)/r,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Nt([wh(0)],xh.prototype,"attack",void 0),Nt([wh(0)],xh.prototype,"decay",void 0),Nt([yh(0,1)],xh.prototype,"sustain",void 0),Nt([wh(0)],xh.prototype,"release",void 0);const Th=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const s=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;s[e]=t/10+.83*n}s[127]=1;const o=[];for(e=0;e<t;e++)o[e]=Math.ceil(e/127*5)/5;const r=[];for(e=0;e<t;e++)n=e/127,r[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function l(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:l(a),Out:a},cosine:{In:i,Out:(h=i,h.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:s,Out:l(s)},sine:{In:r,Out:l(r)},step:{In:o,Out:l(o)}};var h})();class Ch extends Dl{constructor(){super(Ya(Ch.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Ya(Ch.getDefaults(),arguments);this._volume=this.output=new Kl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,dl(this,"volume")}static getDefaults(){return Object.assign(Dl.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],s=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,s,i),this.triggerRelease(s+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Ah extends Ch{constructor(){super(Ya(Ah.getDefaults(),arguments));const t=Ya(Ah.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ch.getDefaults(),{detune:0,onsilence:_l,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Sl?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}Nt([wh(0)],Ah.prototype,"portamento",void 0);class kh extends xh{constructor(){super(Ya(kh.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new zl({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Sh extends Ah{constructor(){super(Ya(Sh.getDefaults(),arguments)),this.name="Synth";const t=Ya(Sh.getDefaults(),arguments);this.oscillator=new vh(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new kh(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),dl(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Ah.getDefaults(),{envelope:Object.assign(Qa(xh.getDefaults(),Object.keys(Dl.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Qa(vh.getDefaults(),[...Object.keys(ih.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Mh extends Sh{constructor(){super(Ya(Mh.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Ya(Mh.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,dl(this,["oscillator","envelope"])}static getDefaults(){return Xa(Ah.getDefaults(),Sh.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Sl?t.toFrequency():t),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Nt([yh(0)],Mh.prototype,"octaves",void 0),Nt([wh(0)],Mh.prototype,"pitchDecay",void 0);const Eh=new Set;function Lh(t){Eh.add(t)}function Ph(t,e){const n=`registerProcessor("${t}", ${e})`;Eh.add(n)}Lh('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Lh("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Lh("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");Ph("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Oh extends Ch{constructor(){super(Ya(Oh.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Ya(Oh.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(Sa(Va(n)||Da(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),Va(n)){const i=new Sl(this.context,n).toMidi();e[i]=t.urls[n]}else Da(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new $l({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ch.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:_l,onerror:_l,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Cl(new Sl(this.context,t).toFrequency()),s=Math.round(i),o=i-s,r=this._findClosest(s),a=s-r,l=this._buffers.get(a),h=bl(r+o),u=new sh({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);u.start(e,0,l.duration/h,n),za(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){const t=this._activeSources.get(s),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Sl(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const s=this.toSeconds(n);return this.triggerAttack(t,s,i),za(e)?(Sa(za(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,s+this.toSeconds(i))}))):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,n){if(Sa(Va(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Va(t)){const i=new Sl(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Nt([wh(0)],Oh.prototype,"attack",void 0),Nt([wh(0)],Oh.prototype,"release",void 0);class Ih extends Pl{constructor(){super(Ya(Ih.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Ol("stopped"),this._startOffset=0;const t=Ya(Ih.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(Pl.getDefaults(),{callback:_l,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Da(this._loop)&&this._loop>1){e=1/0,Da(this._loop)&&(e=this._loop*this._getLoopDuration());const i=this._state.getAfter(n);null!==i&&(e=Math.min(e,i.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new Wl(this.context,e));const s=new Wl(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),s,new Wl(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Wl(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=Ka(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;Ra(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Wl(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new Wl(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Dh extends Ih{constructor(){super(Ya(Dh.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new Ol("stopped"),this._events=new Set;const t=Ya(Dh.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach((t=>{za(t)?this.add(t[0],t[1]):this.add(t)}))}static getDefaults(){return Object.assign(Ih.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=Ka(e,this._loop?this._loopStart:0),e=this._loop?Ka(e,this._loopStart):Ka(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach((e=>{this._startNote(e,n,t)}))}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new Wl(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new Wl(this.context,e))):t.startOffset>=n&&t.start(new Wl(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach((t=>{t.startOffset+=this._startOffset}))}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((e=>{e.stop(t)})),this}at(t,e){const n=new Ll(this.context,t).toTicks(),i=new Wl(this.context,1).toSeconds(),s=this._events.values();let o=s.next();for(;!o.done;){const t=o.value;if(Math.abs(n-t.startOffset)<i)return Ia(e)&&(t.value=e),t;o=s.next()}return Ia(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let i;return e instanceof Ih?(i=e,i.callback=this._tick.bind(this)):i=new Ih({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach((e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new Wl(this.context,e.time))}))}remove(t,e){return Na(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((n=>{n.startOffset===t&&(Oa(e)||Ia(e)&&n.value===e)&&(this._events.delete(n),n.dispose())})),this}clear(){return this._forEach((t=>t.dispose())),this._events.clear(),this}cancel(t){return this._forEach((e=>e.cancel(t))),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach((e=>{e instanceof Dh?e._forEach(t):t(e)})),this}_setAll(t,e){this._forEach((n=>{n[t]=e}))}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach((e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)}))}get loopEnd(){return new Wl(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach((e=>{e.loopEnd=t,this._testLoopBoundries(e)}))}get loopStart(){return new Wl(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach((t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)}))}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class Nh extends Dl{constructor(){super(Object.assign(Ya(Nh.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Ya(Nh.getDefaults(),arguments,["pan"]);this.pan=new Il({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",dl(this,"pan")}static getDefaults(){return Object.assign(Dl.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}Ph("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Rh extends Dl{constructor(){super(Ya(Rh.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Ya(Rh.getDefaults(),arguments,["solo"]);this.input=this.output=new zl({context:this.context}),Rh._allSolos.has(this.context)||Rh._allSolos.set(this.context,new Set),Rh._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Dl.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Rh._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){Rh._soloed.has(this.context)||Rh._soloed.set(this.context,new Set),Rh._soloed.get(this.context).add(this)}_removeSolo(){Rh._soloed.has(this.context)&&Rh._soloed.get(this.context).delete(this)}_isSoloed(){return Rh._soloed.has(this.context)&&Rh._soloed.get(this.context).has(this)}_noSolos(){return!Rh._soloed.has(this.context)||Rh._soloed.has(this.context)&&0===Rh._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Rh._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Rh._allSolos=new Map,Rh._soloed=new Map;class zh extends Dl{constructor(){super(Ya(zh.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Ya(zh.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Nh({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Kl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,dl(this,["pan","volume"])}static getDefaults(){return Object.assign(Dl.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Bh extends Dl{constructor(){super(Ya(Bh.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Ya(Bh.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Rh({solo:t.solo,context:this.context}),this._panVol=this.output=new zh({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),dl(this,["pan","volume"])}static getDefaults(){return Object.assign(Dl.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return Bh.buses.has(t)||Bh.buses.set(t,new zl({context:this.context})),Bh.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new zl({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Bh.buses=new Map;class Vh extends Dl{constructor(){super(...arguments),this.name="Listener",this.positionX=new Il({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Il({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Il({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Il({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Il({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Il({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Il({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Il({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Il({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Dl.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}al((t=>{t.listener=new Vh({context:t})})),hl((t=>{t.listener.dispose()}));const Fh=wl().transport;wl().destination,wl().destination,wl().listener;const Zh=wl().draw;function jh(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qh(t){let e=t,n=t,i=t;function s(t,e,s=0,o=t.length){if(s<o){if(0!==n(e,e))return o;do{const n=s+o>>>1;i(t[n],e)<0?s=n+1:o=n}while(s<o)}return s}return 2!==t.length&&(e=(e,n)=>t(e)-n,n=jh,i=(e,n)=>jh(t(e),n)),{left:s,center:function(t,n,i=0,o=t.length){const r=s(t,n,i,o-1);return r>i&&e(t[r-1],n)>-e(t[r],n)?r-1:r},right:function(t,e,s=0,o=t.length){if(s<o){if(0!==n(e,e))return o;do{const n=s+o>>>1;i(t[n],e)<=0?s=n+1:o=n}while(s<o)}return s}}}wl();const Gh=qh(jh).right;qh((function(t){return null===t?NaN:+t})).center;var Uh=Gh;class $h extends Map{constructor(t,e=Kh){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Hh(this,t))}has(t){return super.has(Hh(this,t))}set(t,e){return super.set(Xh(this,t),e)}delete(t){return super.delete(Yh(this,t))}}class Wh extends Set{constructor(t,e=Kh){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(Hh(this,t))}add(t){return super.add(Xh(this,t))}delete(t){return super.delete(Yh(this,t))}}function Hh({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function Xh({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function Yh({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function Kh(t){return null!==t&&"object"==typeof t?t.valueOf():t}var Qh=Math.sqrt(50),Jh=Math.sqrt(10),tu=Math.sqrt(2);function eu(t,e,n){var i,s,o,r,a=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(s=t,t=e,e=s),0===(r=nu(t,e,n))||!isFinite(r))return[];if(r>0){let n=Math.round(t/r),i=Math.round(e/r);for(n*r<t&&++n,i*r>e&&--i,o=new Array(s=i-n+1);++a<s;)o[a]=(n+a)*r}else{r=-r;let n=Math.round(t*r),i=Math.round(e*r);for(n/r<t&&++n,i/r>e&&--i,o=new Array(s=i-n+1);++a<s;)o[a]=(n+a)/r}return i&&o.reverse(),o}function nu(t,e,n){var i=(e-t)/Math.max(0,n),s=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,s);return s>=0?(o>=Qh?10:o>=Jh?5:o>=tu?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(o>=Qh?10:o>=Jh?5:o>=tu?2:1)}function iu(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(n<s||void 0===n&&s>=s)&&(n=s)}return n}function su(t,e,n){t=+t,e=+e,n=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+n;for(var i=-1,s=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(s);++i<s;)o[i]=t+i*n;return o}function ou(t,e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof e)throw new TypeError("mapper is not a function");return Array.from(t,((n,i)=>e(n,i,t)))}function ru(t){return t}var au=1e-6;function lu(t){return"translate("+t+",0)"}function hu(t){return"translate(0,"+t+")"}function uu(t){return e=>+t(e)}function cu(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function pu(){return!this.__axis}function du(t,e){var n=[],i=null,s=null,o=6,r=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,h=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?lu:hu;function p(p){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,f=null==s?e.tickFormat?e.tickFormat.apply(e,n):ru:s,_=Math.max(o,0)+a,m=e.range(),g=+m[0]+l,v=+m[m.length-1]+l,y=(e.bandwidth?cu:uu)(e.copy(),l),w=p.selection?p.selection():p,b=w.selectAll(".domain").data([null]),x=w.selectAll(".tick").data(d,e).order(),T=x.exit(),C=x.enter().append("g").attr("class","tick"),A=x.select("line"),k=x.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(C),A=A.merge(C.append("line").attr("stroke","currentColor").attr(u+"2",h*o)),k=k.merge(C.append("text").attr("fill","currentColor").attr(u,h*_).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),p!==w&&(b=b.transition(p),x=x.transition(p),A=A.transition(p),k=k.transition(p),T=T.transition(p).attr("opacity",au).attr("transform",(function(t){return isFinite(t=y(t))?c(t+l):this.getAttribute("transform")})),C.attr("opacity",au).attr("transform",(function(t){var e=this.parentNode.__axis;return c((e&&isFinite(e=e(t))?e:y(t))+l)}))),T.remove(),b.attr("d",4===t||2===t?r?"M"+h*r+","+g+"H"+l+"V"+v+"H"+h*r:"M"+l+","+g+"V"+v:r?"M"+g+","+h*r+"V"+l+"H"+v+"V"+h*r:"M"+g+","+l+"H"+v),x.attr("opacity",1).attr("transform",(function(t){return c(y(t)+l)})),A.attr(u+"2",h*o),k.attr(u,h*_).text(f),w.filter(pu).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),w.each((function(){this.__axis=y}))}return p.scale=function(t){return arguments.length?(e=t,p):e},p.ticks=function(){return n=Array.from(arguments),p},p.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),p):n.slice()},p.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),p):i&&i.slice()},p.tickFormat=function(t){return arguments.length?(s=t,p):s},p.tickSize=function(t){return arguments.length?(o=r=+t,p):o},p.tickSizeInner=function(t){return arguments.length?(o=+t,p):o},p.tickSizeOuter=function(t){return arguments.length?(r=+t,p):r},p.tickPadding=function(t){return arguments.length?(a=+t,p):a},p.offset=function(t){return arguments.length?(l=+t,p):l},p}var fu={value:()=>{}};function _u(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new mu(i)}function mu(t){this._=t}function gu(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function vu(t,e){for(var n,i=0,s=t.length;i<s;++i)if((n=t[i]).name===e)return n.value}function yu(t,e,n){for(var i=0,s=t.length;i<s;++i)if(t[i].name===e){t[i]=fu,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}mu.prototype=_u.prototype={constructor:mu,on:function(t,e){var n,i=this._,s=gu(t+"",i),o=-1,r=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<r;)if(n=(t=s[o]).type)i[n]=yu(i[n],t.name,e);else if(null==e)for(n in i)i[n]=yu(i[n],t.name,null);return this}for(;++o<r;)if((n=(t=s[o]).type)&&(n=vu(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new mu(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,s=new Array(n),o=0;o<n;++o)s[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,s)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],s=0,o=i.length;s<o;++s)i[s].value.apply(e,n)}};var wu="http://www.w3.org/1999/xhtml",bu={svg:"http://www.w3.org/2000/svg",xhtml:wu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xu(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),bu.hasOwnProperty(e)?{space:bu[e],local:t}:t}function Tu(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===wu&&e.documentElement.namespaceURI===wu?e.createElement(t):e.createElementNS(n,t)}}function Cu(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Au(t){var e=xu(t);return(e.local?Cu:Tu)(e)}function ku(){}function Su(t){return null==t?ku:function(){return this.querySelector(t)}}function Mu(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function Eu(){return[]}function Lu(t){return null==t?Eu:function(){return this.querySelectorAll(t)}}function Pu(t){return function(){return this.matches(t)}}function Ou(t){return function(e){return e.matches(t)}}var Iu=Array.prototype.find;function Du(){return this.firstElementChild}var Nu=Array.prototype.filter;function Ru(){return Array.from(this.children)}function zu(t){return new Array(t.length)}function Bu(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Vu(t){return function(){return t}}function Fu(t,e,n,i,s,o){for(var r,a=0,l=e.length,h=o.length;a<h;++a)(r=e[a])?(r.__data__=o[a],i[a]=r):n[a]=new Bu(t,o[a]);for(;a<l;++a)(r=e[a])&&(s[a]=r)}function Zu(t,e,n,i,s,o,r){var a,l,h,u=new Map,c=e.length,p=o.length,d=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(d[a]=h=r.call(l,l.__data__,a,e)+"",u.has(h)?s[a]=l:u.set(h,l));for(a=0;a<p;++a)h=r.call(t,o[a],a,o)+"",(l=u.get(h))?(i[a]=l,l.__data__=o[a],u.delete(h)):n[a]=new Bu(t,o[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(d[a])===l&&(s[a]=l)}function ju(t){return t.__data__}function qu(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Gu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Uu(t){return function(){this.removeAttribute(t)}}function $u(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Wu(t,e){return function(){this.setAttribute(t,e)}}function Hu(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Xu(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Yu(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ku(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Qu(t){return function(){this.style.removeProperty(t)}}function Ju(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tc(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ec(t,e){return t.style.getPropertyValue(e)||Ku(t).getComputedStyle(t,null).getPropertyValue(e)}function nc(t){return function(){delete this[t]}}function ic(t,e){return function(){this[t]=e}}function sc(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function oc(t){return t.trim().split(/^|\s+/)}function rc(t){return t.classList||new ac(t)}function ac(t){this._node=t,this._names=oc(t.getAttribute("class")||"")}function lc(t,e){for(var n=rc(t),i=-1,s=e.length;++i<s;)n.add(e[i])}function hc(t,e){for(var n=rc(t),i=-1,s=e.length;++i<s;)n.remove(e[i])}function uc(t){return function(){lc(this,t)}}function cc(t){return function(){hc(this,t)}}function pc(t,e){return function(){(e.apply(this,arguments)?lc:hc)(this,t)}}function dc(){this.textContent=""}function fc(t){return function(){this.textContent=t}}function _c(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function mc(){this.innerHTML=""}function gc(t){return function(){this.innerHTML=t}}function vc(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function yc(){this.nextSibling&&this.parentNode.appendChild(this)}function wc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function bc(){return null}function xc(){var t=this.parentNode;t&&t.removeChild(this)}function Tc(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Cc(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ac(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function kc(t){return function(){var e=this.__on;if(e){for(var n,i=0,s=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++s]=n:this.removeEventListener(n.type,n.listener,n.options);++s?e.length=s:delete this.__on}}}function Sc(t,e,n){return function(){var i,s=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var r=0,a=s.length;r<a;++r)if((i=s[r]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=e);this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},s?s.push(i):this.__on=[i]}}function Mc(t,e,n){var i=Ku(t),s=i.CustomEvent;"function"==typeof s?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function Ec(t,e){return function(){return Mc(this,t,e)}}function Lc(t,e){return function(){return Mc(this,t,e.apply(this,arguments))}}Bu.prototype={constructor:Bu,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},ac.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Pc=[null];function Oc(t,e){this._groups=t,this._parents=e}function Ic(){return new Oc([[document.documentElement]],Pc)}function Dc(t){return function(t){return"string"==typeof t?new Oc([[document.querySelector(t)]],[document.documentElement]):new Oc([[t]],Pc)}(Au(t).call(document.documentElement))}function Nc(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Rc(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function zc(){}Oc.prototype=Ic.prototype={constructor:Oc,select:function(t){"function"!=typeof t&&(t=Su(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o,r,a=e[s],l=a.length,h=i[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(r=t.call(o,o.__data__,u,a))&&("__data__"in o&&(r.__data__=o.__data__),h[u]=r);return new Oc(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return Mu(t.apply(this,arguments))}}(t):Lu(t);for(var e=this._groups,n=e.length,i=[],s=[],o=0;o<n;++o)for(var r,a=e[o],l=a.length,h=0;h<l;++h)(r=a[h])&&(i.push(t.call(r,r.__data__,h,a)),s.push(r));return new Oc(i,s)},selectChild:function(t){return this.select(null==t?Du:function(t){return function(){return Iu.call(this.children,t)}}("function"==typeof t?t:Ou(t)))},selectChildren:function(t){return this.selectAll(null==t?Ru:function(t){return function(){return Nu.call(this.children,t)}}("function"==typeof t?t:Ou(t)))},filter:function(t){"function"!=typeof t&&(t=Pu(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o,r=e[s],a=r.length,l=i[s]=[],h=0;h<a;++h)(o=r[h])&&t.call(o,o.__data__,h,r)&&l.push(o);return new Oc(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,ju);var n=e?Zu:Fu,i=this._parents,s=this._groups;"function"!=typeof t&&(t=Vu(t));for(var o=s.length,r=new Array(o),a=new Array(o),l=new Array(o),h=0;h<o;++h){var u=i[h],c=s[h],p=c.length,d=qu(t.call(u,u&&u.__data__,h,i)),f=d.length,_=a[h]=new Array(f),m=r[h]=new Array(f),g=l[h]=new Array(p);n(u,c,_,m,g,d,e);for(var v,y,w=0,b=0;w<f;++w)if(v=_[w]){for(w>=b&&(b=w+1);!(y=m[b])&&++b<f;);v._next=y||null}}return(r=new Oc(r,i))._enter=a,r._exit=l,r},enter:function(){return new Oc(this._enter||this._groups.map(zu),this._parents)},exit:function(){return new Oc(this._exit||this._groups.map(zu),this._parents)},join:function(t,e,n){var i=this.enter(),s=this,o=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(s=e(s))&&(s=s.selection()),null==n?o.remove():n(o),i&&s?i.merge(s).order():s},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,s=n.length,o=i.length,r=Math.min(s,o),a=new Array(s),l=0;l<r;++l)for(var h,u=n[l],c=i[l],p=u.length,d=a[l]=new Array(p),f=0;f<p;++f)(h=u[f]||c[f])&&(d[f]=h);for(;l<s;++l)a[l]=n[l];return new Oc(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,s=t[e],o=s.length-1,r=s[o];--o>=0;)(i=s[o])&&(r&&4^i.compareDocumentPosition(r)&&r.parentNode.insertBefore(i,r),r=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Gu);for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o){for(var r,a=n[o],l=a.length,h=s[o]=new Array(l),u=0;u<l;++u)(r=a[u])&&(h[u]=r);h.sort(e)}return new Oc(s,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],s=0,o=i.length;s<o;++s){var r=i[s];if(r)return r}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s,o=e[n],r=0,a=o.length;r<a;++r)(s=o[r])&&t.call(s,s.__data__,r,o);return this},attr:function(t,e){var n=xu(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?$u:Uu:"function"==typeof e?n.local?Yu:Xu:n.local?Hu:Wu)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Qu:"function"==typeof e?tc:Ju)(t,e,null==n?"":n)):ec(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?nc:"function"==typeof e?sc:ic)(t,e)):this.node()[t]},classed:function(t,e){var n=oc(t+"");if(arguments.length<2){for(var i=rc(this.node()),s=-1,o=n.length;++s<o;)if(!i.contains(n[s]))return!1;return!0}return this.each(("function"==typeof e?pc:e?uc:cc)(n,e))},text:function(t){return arguments.length?this.each(null==t?dc:("function"==typeof t?_c:fc)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?mc:("function"==typeof t?vc:gc)(t)):this.node().innerHTML},raise:function(){return this.each(yc)},lower:function(){return this.each(wc)},append:function(t){var e="function"==typeof t?t:Au(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Au(t),i=null==e?bc:"function"==typeof e?e:Su(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(xc)},clone:function(t){return this.select(t?Cc:Tc)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,s,o=Ac(t+""),r=o.length;if(!(arguments.length<2)){for(a=e?Sc:kc,i=0;i<r;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(i=0,l=a[h];i<r;++i)if((s=o[i]).type===l.type&&s.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Lc:Ec)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,s=t[e],o=0,r=s.length;o<r;++o)(i=s[o])&&(yield i)}};var Bc=.7,Vc=1/Bc,Fc="\\s*([+-]?\\d+)\\s*",Zc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qc=/^#([0-9a-f]{3,8})$/,Gc=new RegExp("^rgb\\("+[Fc,Fc,Fc]+"\\)$"),Uc=new RegExp("^rgb\\("+[jc,jc,jc]+"\\)$"),$c=new RegExp("^rgba\\("+[Fc,Fc,Fc,Zc]+"\\)$"),Wc=new RegExp("^rgba\\("+[jc,jc,jc,Zc]+"\\)$"),Hc=new RegExp("^hsl\\("+[Zc,jc,jc]+"\\)$"),Xc=new RegExp("^hsla\\("+[Zc,jc,jc,Zc]+"\\)$"),Yc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Kc(){return this.rgb().formatHex()}function Qc(){return this.rgb().formatRgb()}function Jc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?tp(e):3===n?new sp(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ep(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ep(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Gc.exec(t))?new sp(e[1],e[2],e[3],1):(e=Uc.exec(t))?new sp(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=$c.exec(t))?ep(e[1],e[2],e[3],e[4]):(e=Wc.exec(t))?ep(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Hc.exec(t))?lp(e[1],e[2]/100,e[3]/100,1):(e=Xc.exec(t))?lp(e[1],e[2]/100,e[3]/100,e[4]):Yc.hasOwnProperty(t)?tp(Yc[t]):"transparent"===t?new sp(NaN,NaN,NaN,0):null}function tp(t){return new sp(t>>16&255,t>>8&255,255&t,1)}function ep(t,e,n,i){return i<=0&&(t=e=n=NaN),new sp(t,e,n,i)}function np(t){return t instanceof zc||(t=Jc(t)),t?new sp((t=t.rgb()).r,t.g,t.b,t.opacity):new sp}function ip(t,e,n,i){return 1===arguments.length?np(t):new sp(t,e,n,null==i?1:i)}function sp(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function op(){return"#"+ap(this.r)+ap(this.g)+ap(this.b)}function rp(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ap(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function lp(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new up(t,e,n,i)}function hp(t){if(t instanceof up)return new up(t.h,t.s,t.l,t.opacity);if(t instanceof zc||(t=Jc(t)),!t)return new up;if(t instanceof up)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,s=Math.min(e,n,i),o=Math.max(e,n,i),r=NaN,a=o-s,l=(o+s)/2;return a?(r=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=l<.5?o+s:2-o-s,r*=60):a=l>0&&l<1?0:r,new up(r,a,l,t.opacity)}function up(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function cp(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Nc(zc,Jc,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Kc,formatHex:Kc,formatHsl:function(){return hp(this).formatHsl()},formatRgb:Qc,toString:Qc}),Nc(sp,ip,Rc(zc,{brighter:function(t){return t=null==t?Vc:Math.pow(Vc,t),new sp(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Bc:Math.pow(Bc,t),new sp(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:op,formatHex:op,formatRgb:rp,toString:rp})),Nc(up,(function(t,e,n,i){return 1===arguments.length?hp(t):new up(t,e,n,null==i?1:i)}),Rc(zc,{brighter:function(t){return t=null==t?Vc:Math.pow(Vc,t),new up(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Bc:Math.pow(Bc,t),new up(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,s=2*n-i;return new sp(cp(t>=240?t-240:t+120,s,i),cp(t,s,i),cp(t<120?t+240:t-120,s,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var pp=t=>()=>t;function dp(t){return 1==(t=+t)?fp:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):pp(isNaN(e)?n:e)}}function fp(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):pp(isNaN(t)?e:t)}var _p=function t(e){var n=dp(e);function i(t,e){var i=n((t=ip(t)).r,(e=ip(e)).r),s=n(t.g,e.g),o=n(t.b,e.b),r=fp(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=s(e),t.b=o(e),t.opacity=r(e),t+""}}return i.gamma=t,i}(1);function mp(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,s=e.slice();return function(o){for(n=0;n<i;++n)s[n]=t[n]*(1-o)+e[n]*o;return s}}function gp(t,e){var n,i=e?e.length:0,s=t?Math.min(i,t.length):0,o=new Array(s),r=new Array(i);for(n=0;n<s;++n)o[n]=Cp(t[n],e[n]);for(;n<i;++n)r[n]=e[n];return function(t){for(n=0;n<s;++n)r[n]=o[n](t);return r}}function vp(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function yp(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function wp(t,e){var n,i={},s={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Cp(t[n],e[n]):s[n]=e[n];return function(t){for(n in i)s[n]=i[n](t);return s}}var bp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xp=new RegExp(bp.source,"g");function Tp(t,e){var n,i,s,o=bp.lastIndex=xp.lastIndex=0,r=-1,a=[],l=[];for(t+="",e+="";(n=bp.exec(t))&&(i=xp.exec(e));)(s=i.index)>o&&(s=e.slice(o,s),a[r]?a[r]+=s:a[++r]=s),(n=n[0])===(i=i[0])?a[r]?a[r]+=i:a[++r]=i:(a[++r]=null,l.push({i:r,x:yp(n,i)})),o=xp.lastIndex;return o<e.length&&(s=e.slice(o),a[r]?a[r]+=s:a[++r]=s),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function Cp(t,e){var n,i=typeof e;return null==e||"boolean"===i?pp(e):("number"===i?yp:"string"===i?(n=Jc(e))?(e=n,_p):Tp:e instanceof Jc?_p:e instanceof Date?vp:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?mp:Array.isArray(e)?gp:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?wp:yp)(t,e)}function Ap(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var kp,Sp=180/Math.PI,Mp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ep(t,e,n,i,s,o){var r,a,l;return(r=Math.sqrt(t*t+e*e))&&(t/=r,e/=r),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,r=-r),{translateX:s,translateY:o,rotate:Math.atan2(e,t)*Sp,skewX:Math.atan(l)*Sp,scaleX:r,scaleY:a}}function Lp(t,e,n,i){function s(t){return t.length?t.pop()+" ":""}return function(o,r){var a=[],l=[];return o=t(o),r=t(r),function(t,i,s,o,r,a){if(t!==s||i!==o){var l=r.push("translate(",null,e,null,n);a.push({i:l-4,x:yp(t,s)},{i:l-2,x:yp(i,o)})}else(s||o)&&r.push("translate("+s+e+o+n)}(o.translateX,o.translateY,r.translateX,r.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(s(n)+"rotate(",null,i)-2,x:yp(t,e)})):e&&n.push(s(n)+"rotate("+e+i)}(o.rotate,r.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(s(n)+"skewX(",null,i)-2,x:yp(t,e)}):e&&n.push(s(n)+"skewX("+e+i)}(o.skewX,r.skewX,a,l),function(t,e,n,i,o,r){if(t!==n||e!==i){var a=o.push(s(o)+"scale(",null,",",null,")");r.push({i:a-4,x:yp(t,n)},{i:a-2,x:yp(e,i)})}else 1===n&&1===i||o.push(s(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,r.scaleX,r.scaleY,a,l),o=r=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Pp,Op,Ip=Lp((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Mp:Ep(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Dp=Lp((function(t){return null==t?Mp:(kp||(kp=document.createElementNS("http://www.w3.org/2000/svg","g")),kp.setAttribute("transform",t),(t=kp.transform.baseVal.consolidate())?Ep((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Mp)}),", ",")",")"),Np=0,Rp=0,zp=0,Bp=0,Vp=0,Fp=0,Zp="object"==typeof performance&&performance.now?performance:Date,jp="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qp(){return Vp||(jp(Gp),Vp=Zp.now()+Fp)}function Gp(){Vp=0}function Up(){this._call=this._time=this._next=null}function $p(t,e,n){var i=new Up;return i.restart(t,e,n),i}function Wp(){Vp=(Bp=Zp.now())+Fp,Np=Rp=0;try{!function(){qp(),++Np;for(var t,e=Pp;e;)(t=Vp-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Np}()}finally{Np=0,function(){var t,e,n=Pp,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Pp=e);Op=t,Xp(i)}(),Vp=0}}function Hp(){var t=Zp.now(),e=t-Bp;e>1e3&&(Fp-=e,Bp=t)}function Xp(t){Np||(Rp&&(Rp=clearTimeout(Rp)),t-Vp>24?(t<1/0&&(Rp=setTimeout(Wp,t-Zp.now()-Fp)),zp&&(zp=clearInterval(zp))):(zp||(Bp=Zp.now(),zp=setInterval(Hp,1e3)),Np=1,jp(Wp)))}function Yp(t,e,n){var i=new Up;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}Up.prototype=$p.prototype={constructor:Up,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?qp():+n)+(null==e?0:+e),this._next||Op===this||(Op?Op._next=this:Pp=this,Op=this),this._call=t,this._time=n,Xp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xp())}};var Kp=_u("start","end","cancel","interrupt"),Qp=[];function Jp(t,e,n,i,s,o){var r=t.__transition;if(r){if(n in r)return}else t.__transition={};!function(t,e,n){var i,s=t.__transition;function o(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}function r(o){var h,u,c,p;if(1!==n.state)return l();for(h in s)if((p=s[h]).name===n.name){if(3===p.state)return Yp(r);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete s[h]):+h<e&&(p.state=6,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete s[h])}if(Yp((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(c=n.tween.length),h=0,u=-1;h<c;++h)(p=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=p);i.length=u+1}}function a(e){for(var s=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,r=i.length;++o<r;)i[o].call(t,s);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=6,n.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=n,n.timer=$p(o,0,n.time)}(t,n,{name:e,index:i,group:s,on:Kp,tween:Qp,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function td(t,e){var n=nd(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ed(t,e){var n=nd(t,e);if(n.state>3)throw new Error("too late; already running");return n}function nd(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function id(t,e){var n,i;return function(){var s=ed(this,t),o=s.tween;if(o!==n)for(var r=0,a=(i=n=o).length;r<a;++r)if(i[r].name===e){(i=i.slice()).splice(r,1);break}s.tween=i}}function sd(t,e,n){var i,s;if("function"!=typeof n)throw new Error;return function(){var o=ed(this,t),r=o.tween;if(r!==i){s=(i=r).slice();for(var a={name:e,value:n},l=0,h=s.length;l<h;++l)if(s[l].name===e){s[l]=a;break}l===h&&s.push(a)}o.tween=s}}function od(t,e,n){var i=t._id;return t.each((function(){var t=ed(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return nd(t,i).value[e]}}function rd(t,e){var n;return("number"==typeof e?yp:e instanceof Jc?_p:(n=Jc(e))?(e=n,_p):Tp)(t,e)}function ad(t){return function(){this.removeAttribute(t)}}function ld(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hd(t,e,n){var i,s,o=n+"";return function(){var r=this.getAttribute(t);return r===o?null:r===i?s:s=e(i=r,n)}}function ud(t,e,n){var i,s,o=n+"";return function(){var r=this.getAttributeNS(t.space,t.local);return r===o?null:r===i?s:s=e(i=r,n)}}function cd(t,e,n){var i,s,o;return function(){var r,a,l=n(this);if(null!=l)return(r=this.getAttribute(t))===(a=l+"")?null:r===i&&a===s?o:(s=a,o=e(i=r,l));this.removeAttribute(t)}}function pd(t,e,n){var i,s,o;return function(){var r,a,l=n(this);if(null!=l)return(r=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:r===i&&a===s?o:(s=a,o=e(i=r,l));this.removeAttributeNS(t.space,t.local)}}function dd(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fd(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function _d(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&fd(t,s)),n}return s._value=e,s}function md(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&dd(t,s)),n}return s._value=e,s}function gd(t,e){return function(){td(this,t).delay=+e.apply(this,arguments)}}function vd(t,e){return e=+e,function(){td(this,t).delay=e}}function yd(t,e){return function(){ed(this,t).duration=+e.apply(this,arguments)}}function wd(t,e){return e=+e,function(){ed(this,t).duration=e}}function bd(t,e){if("function"!=typeof e)throw new Error;return function(){ed(this,t).ease=e}}function xd(t,e,n){var i,s,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?td:ed;return function(){var r=o(this,t),a=r.on;a!==i&&(s=(i=a).copy()).on(e,n),r.on=s}}var Td=Ic.prototype.constructor;function Cd(t){return function(){this.style.removeProperty(t)}}function Ad(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function kd(t,e,n){var i,s;function o(){var o=e.apply(this,arguments);return o!==s&&(i=(s=o)&&Ad(t,o,n)),i}return o._value=e,o}function Sd(t){return function(e){this.textContent=t.call(this,e)}}function Md(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Sd(i)),e}return i._value=t,i}var Ed=0;function Ld(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Pd(){return++Ed}var Od=Ic.prototype;Ld.prototype={constructor:Ld,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Su(t));for(var i=this._groups,s=i.length,o=new Array(s),r=0;r<s;++r)for(var a,l,h=i[r],u=h.length,c=o[r]=new Array(u),p=0;p<u;++p)(a=h[p])&&(l=t.call(a,a.__data__,p,h))&&("__data__"in a&&(l.__data__=a.__data__),c[p]=l,Jp(c[p],e,n,p,c,nd(a,n)));return new Ld(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Lu(t));for(var i=this._groups,s=i.length,o=[],r=[],a=0;a<s;++a)for(var l,h=i[a],u=h.length,c=0;c<u;++c)if(l=h[c]){for(var p,d=t.call(l,l.__data__,c,h),f=nd(l,n),_=0,m=d.length;_<m;++_)(p=d[_])&&Jp(p,e,n,_,d,f);o.push(d),r.push(l)}return new Ld(o,r,e,n)},selectChild:Od.selectChild,selectChildren:Od.selectChildren,filter:function(t){"function"!=typeof t&&(t=Pu(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o,r=e[s],a=r.length,l=i[s]=[],h=0;h<a;++h)(o=r[h])&&t.call(o,o.__data__,h,r)&&l.push(o);return new Ld(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,s=n.length,o=Math.min(i,s),r=new Array(i),a=0;a<o;++a)for(var l,h=e[a],u=n[a],c=h.length,p=r[a]=new Array(c),d=0;d<c;++d)(l=h[d]||u[d])&&(p[d]=l);for(;a<i;++a)r[a]=e[a];return new Ld(r,this._parents,this._name,this._id)},selection:function(){return new Td(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Pd(),i=this._groups,s=i.length,o=0;o<s;++o)for(var r,a=i[o],l=a.length,h=0;h<l;++h)if(r=a[h]){var u=nd(r,e);Jp(r,t,n,h,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ld(i,this._parents,t,n)},call:Od.call,nodes:Od.nodes,node:Od.node,size:Od.size,empty:Od.empty,each:Od.each,on:function(t,e){var n=this._id;return arguments.length<2?nd(this.node(),n).on.on(t):this.each(xd(n,t,e))},attr:function(t,e){var n=xu(t),i="transform"===n?Dp:rd;return this.attrTween(t,"function"==typeof e?(n.local?pd:cd)(n,i,od(this,"attr."+t,e)):null==e?(n.local?ld:ad)(n):(n.local?ud:hd)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=xu(t);return this.tween(n,(i.local?_d:md)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Ip:rd;return null==e?this.styleTween(t,function(t,e){var n,i,s;return function(){var o=ec(this,t),r=(this.style.removeProperty(t),ec(this,t));return o===r?null:o===n&&r===i?s:s=e(n=o,i=r)}}(t,i)).on("end.style."+t,Cd(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,s,o;return function(){var r=ec(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=ec(this,t)),r===l?null:r===i&&l===s?o:(s=l,o=e(i=r,a))}}(t,i,od(this,"style."+t,e))).each(function(t,e){var n,i,s,o,r="style."+e,a="end."+r;return function(){var l=ed(this,t),h=l.on,u=null==l.value[r]?o||(o=Cd(e)):void 0;h===n&&s===u||(i=(n=h).copy()).on(a,s=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,s,o=n+"";return function(){var r=ec(this,t);return r===o?null:r===i?s:s=e(i=r,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,kd(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(od(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Md(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,s=nd(this.node(),n).tween,o=0,r=s.length;o<r;++o)if((i=s[o]).name===t)return i.value;return null}return this.each((null==e?id:sd)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?gd:vd)(e,t)):nd(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?yd:wd)(e,t)):nd(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(bd(e,t)):nd(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ed(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,s=n.size();return new Promise((function(o,r){var a={value:r},l={value:function(){0==--s&&o()}};n.each((function(){var n=ed(this,i),s=n.on;s!==t&&((e=(t=s).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===s&&o()}))},[Symbol.iterator]:Od[Symbol.iterator]};var Id={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Dd(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Nd(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Rd(t){return(t=Nd(Math.abs(t)))?t[1]:NaN}Ic.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,s,o=t.__transition,r=!0;if(o){for(s in e=null==e?null:e+"",o)(n=o[s]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[s]):r=!1;r&&delete t.__transition}}(this,t)}))},Ic.prototype.transition=function(t){var e,n;t instanceof Ld?(e=t._id,t=t._name):(e=Pd(),(n=Id).time=qp(),t=null==t?null:t+"");for(var i=this._groups,s=i.length,o=0;o<s;++o)for(var r,a=i[o],l=a.length,h=0;h<l;++h)(r=a[h])&&Jp(r,t,e,h,a,n||Dd(r,e));return new Ld(i,this._parents,t,e)};var zd,Bd=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vd(t){if(!(e=Bd.exec(t)))throw new Error("invalid format: "+t);var e;return new Fd({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Fd(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Zd(t,e){var n=Nd(t,e);if(!n)return t+"";var i=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}Vd.prototype=Fd.prototype,Fd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var jd={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Zd(100*t,e),r:Zd,s:function(t,e){var n=Nd(t,e);if(!n)return t+"";var i=n[0],s=n[1],o=s-(zd=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,r=i.length;return o===r?i:o>r?i+new Array(o-r+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Nd(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function qd(t){return t}var Gd,Ud,$d,Wd=Array.prototype.map,Hd=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Xd(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?qd:(e=Wd.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var s=t.length,o=[],r=0,a=e[0],l=0;s>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(t.substring(s-=a,s+a)),!((l+=a+1)>i));)a=e[r=(r+1)%e.length];return o.reverse().join(n)}),s=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",r=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?qd:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Wd.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=Vd(t)).fill,n=t.align,c=t.sign,p=t.symbol,d=t.zero,f=t.width,_=t.comma,m=t.precision,g=t.trim,v=t.type;"n"===v?(_=!0,v="g"):jd[v]||(void 0===m&&(m=12),g=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var y="$"===p?s:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===p?o:/[%p]/.test(v)?l:"",b=jd[v],x=/[defgprs%]/.test(v);function T(t){var s,o,l,p=y,T=w;if("c"===v)T=b(t)+T,t="";else{var C=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:b(Math.abs(t),m),g&&(t=function(t){t:for(var e,n=t.length,i=1,s=-1;i<n;++i)switch(t[i]){case".":s=e=i;break;case"0":0===s&&(s=i),e=i;break;default:if(!+t[i])break t;s>0&&(s=0)}return s>0?t.slice(0,s)+t.slice(e+1):t}(t)),C&&0==+t&&"+"!==c&&(C=!1),p=(C?"("===c?c:h:"-"===c||"("===c?"":c)+p,T=("s"===v?Hd[8+zd/3]:"")+T+(C&&"("===c?")":""),x)for(s=-1,o=t.length;++s<o;)if(48>(l=t.charCodeAt(s))||l>57){T=(46===l?r+t.slice(s+1):t.slice(s))+T,t=t.slice(0,s);break}}_&&!d&&(t=i(t,1/0));var A=p.length+t.length+T.length,k=A<f?new Array(f-A+1).join(e):"";switch(_&&d&&(t=i(k+t,k.length?f-T.length:1/0),k=""),n){case"<":t=p+t+T+k;break;case"=":t=p+k+t+T;break;case"^":t=k.slice(0,A=k.length>>1)+p+t+T+k.slice(A);break;default:t=k+p+t+T}return a(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),T.toString=function(){return t+""},T}return{format:c,formatPrefix:function(t,e){var n=c(((t=Vd(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Rd(e)/3))),s=Math.pow(10,-i),o=Hd[8+i/3];return function(t){return n(s*t)+o}}}}function Yd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}Gd=Xd({thousands:",",grouping:[3],currency:["$",""]}),Ud=Gd.format,$d=Gd.formatPrefix;const Kd=Symbol("implicit");function Qd(){var t=new $h,e=[],n=[],i=Kd;function s(s){let o=t.get(s);if(void 0===o){if(i!==Kd)return i;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return s.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new $h;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return s},s.range=function(t){return arguments.length?(n=Array.from(t),s):n.slice()},s.unknown=function(t){return arguments.length?(i=t,s):i},s.copy=function(){return Qd(e,n).unknown(i)},Yd.apply(s,arguments),s}function Jd(){var t,e,n=Qd().unknown(void 0),i=n.domain,s=n.range,o=0,r=1,a=!1,l=0,h=0,u=.5;function c(){var n=i().length,c=r<o,p=c?r:o,d=c?o:r;t=(d-p)/Math.max(1,n-l+2*h),a&&(t=Math.floor(t)),p+=(d-p-t*(n-l))*u,e=t*(1-l),a&&(p=Math.round(p),e=Math.round(e));var f=su(n).map((function(e){return p+t*e}));return s(c?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),c()):i()},n.range=function(t){return arguments.length?([o,r]=t,o=+o,r=+r,c()):[o,r]},n.rangeRound=function(t){return[o,r]=t,o=+o,r=+r,a=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,c()):a},n.padding=function(t){return arguments.length?(l=Math.min(1,h=+t),c()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),c()):l},n.paddingOuter=function(t){return arguments.length?(h=+t,c()):h},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.copy=function(){return Jd(i(),[o,r]).round(a).paddingInner(l).paddingOuter(h).align(u)},Yd.apply(c(),arguments)}function tf(t){return+t}var ef=[0,1];function nf(t){return t}function sf(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function of(t,e,n){var i=t[0],s=t[1],o=e[0],r=e[1];return s<i?(i=sf(s,i),o=n(r,o)):(i=sf(i,s),o=n(o,r)),function(t){return o(i(t))}}function rf(t,e,n){var i=Math.min(t.length,e.length)-1,s=new Array(i),o=new Array(i),r=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++r<i;)s[r]=sf(t[r],t[r+1]),o[r]=n(e[r],e[r+1]);return function(e){var n=Uh(t,e,1,i)-1;return o[n](s[n](e))}}function af(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function lf(){var t,e,n,i,s,o,r=ef,a=ef,l=Cp,h=nf;function u(){var t=Math.min(r.length,a.length);return h!==nf&&(h=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(r[0],r[t-1])),i=t>2?rf:of,s=o=null,c}function c(e){return null==e||isNaN(e=+e)?n:(s||(s=i(r.map(t),a,l)))(t(h(e)))}return c.invert=function(n){return h(e((o||(o=i(a,r.map(t),yp)))(n)))},c.domain=function(t){return arguments.length?(r=Array.from(t,tf),u()):r.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),u()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),l=Ap,u()},c.clamp=function(t){return arguments.length?(h=!!t||nf,u()):h!==nf},c.interpolate=function(t){return arguments.length?(l=t,u()):l},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,i){return t=n,e=i,u()}}function hf(){return lf()(nf,nf)}function uf(t,e,n,i){var s,o=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/s;return o>=Qh?s*=10:o>=Jh?s*=5:o>=tu&&(s*=2),e<t?-s:s}(t,e,n);switch((i=Vd(null==i?",f":i)).type){case"s":var r=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(s=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Rd(e)/3)))-Rd(Math.abs(t)))}(o,r))||(i.precision=s),$d(i,r);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(s=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Rd(e)-Rd(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=s-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(s=function(t){return Math.max(0,-Rd(Math.abs(t)))}(o))||(i.precision=s-2*("%"===i.type))}return Ud(i)}function cf(t){var e=t.domain;return t.ticks=function(t){var n=e();return eu(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return uf(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,s,o=e(),r=0,a=o.length-1,l=o[r],h=o[a],u=10;for(h<l&&(s=l,l=h,h=s,s=r,r=a,a=s);u-- >0;){if((s=nu(l,h,n))===i)return o[r]=l,o[a]=h,e(o);if(s>0)l=Math.floor(l/s)*s,h=Math.ceil(h/s)*s;else{if(!(s<0))break;l=Math.ceil(l*s)/s,h=Math.floor(h*s)/s}i=s}return t},t}function pf(){var t=hf();return t.copy=function(){return af(t,pf())},Yd.apply(t,arguments),cf(t)}function df(t){return Math.log(t)}function ff(t){return Math.exp(t)}function _f(t){return-Math.log(-t)}function mf(t){return-Math.exp(-t)}function gf(t){return isFinite(t)?+("1e"+t):t<0?0:t}function vf(t){return(e,n)=>-t(-e,n)}function yf(t){const e=t(df,ff),n=e.domain;let i,s,o=10;function r(){return i=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),s=function(t){return 10===t?gf:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(i=vf(i),s=vf(s),t(_f,mf)):t(df,ff),e}return e.base=function(t){return arguments.length?(o=+t,r()):o},e.domain=function(t){return arguments.length?(n(t),r()):n()},e.ticks=t=>{const e=n();let r=e[0],a=e[e.length-1];const l=a<r;l&&([r,a]=[a,r]);let h,u,c=i(r),p=i(a);const d=null==t?10:+t;let f=[];if(!(o%1)&&p-c<d){if(c=Math.floor(c),p=Math.ceil(p),r>0){for(;c<=p;++c)for(h=1;h<o;++h)if(u=c<0?h/s(-c):h*s(c),!(u<r)){if(u>a)break;f.push(u)}}else for(;c<=p;++c)for(h=o-1;h>=1;--h)if(u=c>0?h/s(-c):h*s(c),!(u<r)){if(u>a)break;f.push(u)}2*f.length<d&&(f=eu(r,a,d))}else f=eu(c,p,Math.min(p-c,d)).map(s);return l?f.reverse():f},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=Vd(n)).precision||(n.trim=!0),n=Ud(n)),t===1/0)return n;const r=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/s(Math.round(i(t)));return e*o<o-.5&&(e*=o),e<=r?n(t):""}},e.nice=()=>n(function(t,e){var n,i=0,s=(t=t.slice()).length-1,o=t[i],r=t[s];return r<o&&(n=i,i=s,s=n,n=o,o=r,r=n),t[i]=e.floor(o),t[s]=e.ceil(r),t}(n(),{floor:t=>s(Math.floor(i(t))),ceil:t=>s(Math.ceil(i(t)))})),e}function wf(){const t=yf(lf()).domain([1,10]);return t.copy=()=>af(t,wf()).base(t.base()),Yd.apply(t,arguments),t}function bf(t,{x:e=((t,e)=>e),y:n=(t=>t),marginTop:i=10,marginRight:s=0,marginBottom:o=30,marginLeft:r=60,width:a=640,height:l=400,xDomain:h,xRange:u=[r,a-s],yType:c=pf,yDomain:p,yRange:d=[l-o,i],xPadding:f=.1,yFormat:_,yLabel:m,xTicks:g=!0,color:v="currentColor",duration:y=250,delay:w=((t,e)=>20*e)}={}){const b=ou(t,e),x=ou(t,n);void 0===h&&(h=b),void 0===p&&(p=[0,iu(x)]),h=new Wh(h);const T=su(b.length).filter((t=>h.has(b[t]))),C=Jd(h,u).padding(f),A=c(p,d),k=(S=C,du(3,S)).tickSizeOuter(0);var S;const M=function(t){return du(4,t)}(A).ticks(l/40,_),E=A.tickFormat(100,_),L=Dc("svg").attr("width",a).attr("height",l).attr("viewBox",[0,0,a,l]).attr("style","max-width: 100%; height: auto; height: intrinsic;"),P=L.append("g").attr("transform",`translate(${r},0)`).call(M).call((t=>t.select(".domain").remove())).call((t=>t.selectAll(".tick").attr("stroke-opacity",.1).call(N))).call((t=>t.append("text").attr("x",-r).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(m)));let O=L.append("g").attr("fill",v).attr("id","all-bars").selectAll("rect").data(T).join("rect").attr("class","chart-bar").property("key",(t=>b[t])).call(D,(t=>C(b[t])),(t=>A(x[t]))).style("mix-blend-mode","multiply").call((t=>t.append("title").text((t=>[b[t],E(x[t])].join("\n")))));const I=L.append("g").attr("transform",`translate(0,${l-o})`).call(k).call((t=>t.selectAll(".tick").attr("stroke-opacity",g?0:1)));function D(t,e,n){return t.attr("x",e).attr("y",n).attr("height","function"==typeof n?t=>A(p[0])-n(t):t=>A(p[0])-n).attr("width",C.bandwidth())}function N(t){return t.append("line").attr("class","grid").attr("x2",a-r-s).attr("stroke","currentColor").attr("stroke-opacity",.1)}return Object.assign(L.node(),{update:function(t,{xDomain:i,yDomain:s,duration:o=y,delay:r=w}={}){const a=ou(t,e),l=ou(t,n);void 0===i&&(i=a),void 0===s&&(s=[0,iu(l)]),i=new Wh(i);const h=su(a.length).filter((t=>i.has(a[t])));C.domain(i),A.domain(s);const u=L.transition().duration(o);O=O.data(h,(function(t){return"rect"===this.tagName?this.key:a[t]})).join((t=>t.append("rect").attr("class","chart-bar").property("key",(t=>a[t])).call(D,(t=>C(a[t])),A(0)).style("mix-blend-mode","multiply").call((t=>t.append("title")))),(t=>t),(t=>t.transition(u).delay(r).attr("y",A(0)).attr("height",0).remove())),O.select("title").text((t=>[a[t],E(l[t])].join("\n"))),O.transition(u).delay(r).call(D,(t=>C(a[t])),(t=>A(l[t]))),I.transition(u).call(k).call((t=>t.selectAll(".tick").delay(r))),P.transition(u).call(M).selection().call((t=>t.select(".domain").remove())).call((t=>t.selectAll(".tick").selectAll(".grid").data([,]).join(N)))},highlight:function(t=null){null!==t?L.node().querySelectorAll(".chart-bar").forEach(((e,n)=>{e.classList.remove("active"),n===t&&e.classList.add("active")})):L.node().querySelectorAll(".chart-bar").forEach((t=>t.classList.remove("active")))}})}function xf(t,e=null,n){return null===e&&(e=[Math.min(...t),Math.max(...t)]),t.map((t=>(t-e[0])/(e[1]-e[0])*(n[1]-n[0])+n[0]))}function Tf(t,e){return t.map((t=>Math.min(Math.max(t,e[0]),e[1])))}function Cf(t,e){if(t.length!==e.length)throw new Error("The two arrays must have the same length to be multiplied!");const n=Array(t.length);for(let i=0;i<t.length;i++)n[i]=t[i]+e[i];return n}function Af(t,e){return t.map((t=>t*e))}const kf={Am:["A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7","D7","E7","F7","G7"],A:["A1","B1","Db2","D2","E2","Gb2","Ab2","A2","B2","Db3","D3","E3","Gb3","Ab3","A3","B3","Db4","D4","E4","Gb4","Ab4","A4","B4","Db5","D5","E5","Gb5","Ab5","A5","B5","Db6","D6","E6","Gb6","Ab6","A6","B6","Db7","D7","E7","Gb7","Ab7"],Arabic_1_D:["D1","Eb1","Gb1","G1","A1","C2","D2","Eb2","Gb2","G2","A2","C3","D3","Eb3","Gb3","G3","A3","C4","D4","Eb4","Gb4","G4","A4","C5","D5","Eb5","Gb5","G5","A5","C6","D6","Eb6","Gb6","G6","A6","C7","D7"],C_penta:["C1","D1","E1","G1","A1","C2","D2","E2","G2","A2","C3","D3","E3","G3","A3","C4","D4","E4","G4","A4","C5","D5","E5","G5","A5","C6","D6","E6","G6","A6","C7","D7","E7","G7","A7"],C_G_bass:["C2","G2","C3"],A_E_bass:["A1","E2","A2","E3"],D_A_bass:["D2","A2","D3"],C_chord:["C4","E4","G4","C5"],A_chord:["A3","Db4","E4","A4"],Am_chord:["A3","C4","E4","A4","C5"],D_chord:["A3","D4","F4","A4"]},Sf=[{id:"Am",label:"Minor scale in A",piano:"Am",bass:"A_E_bass",drum:"Am_chord"},{id:"A",label:"Major scale in A",piano:"A",bass:"A_E_bass",drum:"A_chord"},{id:"C_penta",label:"Pentatonic scale in C",piano:"C_penta",bass:"C_G_bass",drum:"C_chord"},{id:"Arabic_1_D",label:"Arabic scale in D",piano:"Arabic_1_D",bass:"D_A_bass",drum:"D_chord"}],Mf=[{id:"blues",label:"Blues",pattern:[{hihatclose_low:1,snare_mid:0,bd6:1,ride_hi:1},{hihatclose_low:.53,snare_mid:0,bd6:0},{hihatclose_low:.43,snare_mid:.1,bd6:0},{hihatclose_low:.9,snare_mid:.96,bd6:0},{hihatclose_low:.45,snare_mid:.04,bd6:0},{hihatclose_low:.55,snare_mid:0,bd6:.75},{hihatclose_low:.95,snare_mid:0,bd6:0,china_low:.5},{hihatclose_low:.33,snare_mid:.15,bd6:0},{hihatclose_low:.43,snare_mid:0,bd6:0},{hihatclose_low:.9,snare_mid:.66,bd6:0},{hihatclose_low:.54,snare_mid:.04,bd6:0},{hihatclose_low:.44,snare_mid:0,bd6:.2}]},{id:"arabic",label:"Arabic",pattern:[{snare_low:0,ridebell:.93,hihatclose_low:1,bd6:1},{snare_low:0,ridebell:0,hihatclose_low:.33,bd6:0},{snare_low:1,ridebell:0,hihatclose_low:0,bd6:0},{snare_low:.33,ridebell:0,hihatclose_low:.69,bd6:0},{snare_low:.8,ridebell:.63,hihatclose_low:0,bd6:0},{snare_low:.56,ridebell:0,hihatclose_low:0,bd6:0},{snare_low:0,ridebell:0,hihatclose_low:.88,bd6:0},{snare_low:0,ridebell:0,hihatclose_low:.38,bd6:0},{snare_low:.75,ridebell:.56,hihatclose_low:0,bd6:0},{snare_low:0,ridebell:0,hihatclose_low:.56,bd6:0},{snare_low:.68,ridebell:0,hihatclose_low:0,bd6:0},{snare_low:.23,ridebell:0,hihatclose_low:0,bd6:.2}]},{id:"flamenco",label:"Flamenco",pattern:[{snare_low:0,ride_hi:0,hihatclose_low:1,bd6:1,ridebell:1},{snare_low:0,ride_hi:0,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:.99,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:0,hihatclose_low:.03,bd6:0},{snare_low:.98,ride_hi:0,hihatclose_low:.97,bd6:0},{snare_low:0,ride_hi:.6,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:0,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:.86,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:0,hihatclose_low:.99,bd6:0},{snare_low:.5,ride_hi:.55,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:0,hihatclose_low:.03,bd6:0},{snare_low:0,ride_hi:.58,hihatclose_low:.03,bd6:.2}]},{id:"funk",label:"Funk",pattern:[{hihatclose_low:1,snare_mid:0,bd6:1,ride_hi:1},{hihatclose_low:0,snare_mid:.11,bd6:0},{hihatclose_low:.6,snare_mid:0,bd6:.7},{hihatclose_low:.45,snare_mid:0,bd6:0},{hihatclose_low:0,snare_mid:.87,bd6:0},{hihatclose_low:.87,snare_mid:0,bd6:0},{hihatclose_low:0,snare_mid:.12,bd6:0},{hihatclose_low:.46,snare_mid:0,bd6:.94},{hihatclose_low:.6,snare_mid:0,bd6:0},{hihatclose_low:0,snare_mid:.76,bd6:0},{hihatclose_low:.54,snare_mid:0,bd6:0},{hihatclose_low:0,snare_mid:.13,bd6:0}]}],Ef=["A0","Bb0","B0","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","C8"];const Lf=function(){const t={};return Ef.forEach((e=>{t[e]=`sounds/piano/${e.toLowerCase()}_loud.ogg`})),t}(),Pf=["E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4"];const Of=function(){const t={};return Pf.forEach((e=>{t[e]=`sounds/bass/${e}.ogg`})),t}(),If=["C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5"],Df={};If.forEach((t=>{Df[t]=`sounds/hangdrum/${t}.ogg`}));const Nf=function(){const t={};return If.forEach((e=>{t[e]=`sounds/hangdrum/${e}.ogg`})),t}(),Rf=["bd1","bd2","bd3","bd4","bd5","bd6","china_hi","china_low","cowbell_hi","cowbell_hihi","crash1_hi","crash1_hihi","crash2_hi","crash2_hihi","hihatclose_hi","hihatclose_low","hihat_hi","hihat_low","hihat_mid","openhihat_hi","openhihat_mid","ride_hi","ride_mid","ridebell","snare_hi","snare_low_mid","snare_low","snare_mid","splash1_hi","splash1_hihi","splash2_hi","splash2_hihi","stahloverbassdrum","kick_drum"];const zf=function(){const t={};return Rf.forEach((e=>{t[e]=`sounds/drumkit/${e.replace(/\_/g,"-")}.ogg`})),t}(),Bf=["January","February","Marsh","April","May","June","July","August","September","October","November","December"];const Vf=vt(0),Ff=vt(null),Zf=vt({arrangement:"Am",bpm:300,bpm_auto:!0,inverted_pitch:!1,volume:.8,med:!0,max:!0,min:!0,drum:!1,drum_pattern:"blues"}),jf=yt([Ff,Zf],(([t,e])=>{const n=u(jf);return t?(n.meanMonthlyPS=function(t,e=null,n){const i=t.data.monthly_medium,s=t.data.monthly_volume,o=i.map(((t,e)=>[Bf[e].slice(0,3),t])),r=Sf.find((t=>t.id===n.arrangement)).piano,a=kf[r];if(e)return e.part.dispose(),e.plot.update(o,{yDomain:[0,.5]}),e.plot.highlight(null),n.med?(e.part=i_(i,s,e.plot.highlight,a,n.inverted_pitch),e):e;{const t=bf(o,{x:(t,e)=>t[0],y:(t,e)=>t[1],height:200,yDomain:[0,.5],yFormat:".0%",marginLeft:40}),e=i_(i,s,t.highlight,a,n.inverted_pitch);return n.med||e.dispose(),{plot:t,part:e}}}(t,n.meanMonthlyPS,e),n.maxMonthlyPS=function(t,e,n){const i=t.data.monthly_max,s=i.map(((t,e)=>[Bf[e].slice(0,3),t])),o=Sf.find((t=>t.id===n.arrangement)).bass,r=kf[o];if(e)return e.part.dispose(),e.plot.update(s,{yDomain:[0,1]}),e.plot.highlight(null),n.max?(e.part=s_(i,e.plot.highlight,r),e):e;{const t=bf(s,{x:(t,e)=>t[0],y:(t,e)=>t[1],height:200,yDomain:[0,1],yFormat:".0%",marginLeft:40}),e=s_(i,t.highlight,r);return n.max||e.dispose(),{plot:t,part:e}}}(t,n.maxMonthlyPS,e),n.minMonthlyPS=function(t,e,n){const i=t.data.monthly_min,s=i.map(((t,e)=>[Bf[e].slice(0,3),t])),o=Sf.find((t=>t.id===n.arrangement)).drum,r=kf[o];if(e)return e.part.dispose(),e.plot.update(s,{yDomain:[0,1]}),e.plot.highlight(null),n.min?(e.part=o_(i,e.plot.highlight,r),e):e;{const t=bf(s,{x:(t,e)=>t[0],y:(t,e)=>t[1],height:200,yDomain:[0,1],yFormat:".0%",marginLeft:40}),e=o_(i,t.highlight,r);return n.min||e.dispose(),{plot:t,part:e}}}(t,n.minMonthlyPS,e),n.sizePS=function(t,e){const n=t.data.size,i={val:Math.log(n.val),min:Math.log(n.min),max:Math.log(n.max)},s=[480,240],o=[["",n.val]];if(e)return e.plot.update(o,{yDomain:[n.min,n.max]}),e.bpm=xf([i.val],[i.min,i.max],s)[0],e;{const t=bf(o,{x:(t,e)=>t[0],y:(t,e)=>t[1],yType:wf,height:700,width:60,yDomain:[n.min,n.max],marginLeft:40,marginRight:0,marginBottom:30,marginTop:40});return{plot:t,bpm:xf([i.val],[i.min,i.max],s)[0]}}}(t,n.sizePS),n.drumPS=function(t,e){const n=Mf.find((t=>t.id===e.drum_pattern)).pattern;if(t)return t.part.dispose(),e.drum?(t.part=r_(n),t):t;{const t=r_(n);return e.drum||t.dispose(t),{part:t}}}(n.drumPS,e),e.bpm_auto&&n.sizePS.bpm!=e.bpm&&Zf.update((t=>({...t,bpm:n.sizePS.bpm}))),i=e.bpm,Fh.bpm.set({value:i}),s=function(t){return Math.log(t**12)}(s=e.volume),wl().destination.volume.set({value:s}),n):(n&&(n.meanMonthlyPS&&n.meanMonthlyPS.part.dispose(),n.maxMonthlyPS&&n.maxMonthlyPS.part.dispose(),n.minMonthlyPS&&n.minMonthlyPS.part.dispose(),n.drumPS&&n.drumPS.part.dispose()),{});var i,s}),{});const qf=function(){const{subscribe:t,set:e,update:n}=vt([]);return{subscribe:t,set:e,update:n,getStationById:function(t){const e=u(qf).filter((e=>e.info.id===t));return 1===e.length?e[0]:null},getStationsInfo:function(){return u(qf).map((t=>t.info))}}}();const Gf=vt(null),Uf=vt(null),$f=vt(!1),Wf=vt(!0),Hf=vt(!0),Xf=vt(!1),Yf=vt(!1),Kf=yt([Gf,Uf],(([t,e])=>t&&e),!1),Qf=(new Oh).toDestination(),Jf=(new Oh).toDestination(),t_=(new Oh).toDestination(),e_=new class{constructor(){this.sampler=(new Oh).toDestination(),this.note_keys=["A0","Bb0","B0","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","C8"],this.index=0,this.notes={}}add(t,e,n){this.notes[t]=this.note_keys[this.index],this.index++,this.sampler.add(this.notes[t],e,n)}triggerAttackRelease(t,e,n,i){this.sampler.triggerAttackRelease(this.notes[t],e,n,i)}};async function n_(){await yl.resume(),Fh.loop=!0,Fh.loopStart=0,Fh.loopEnd="0:12"}function i_(t,e,n,i,s=!1){t=xf(t,[0,1],s?[.5,1]:[.6,.1]),e=xf(e,null,[.02,.15]);const o=12/Fh.bpm.value*16,r=Af(e,16),a=i.length,l=Array(a+1).fill(0).map(((t,e)=>1*e/a)),h=t.map(((t,n)=>{let s;for(let e=0;e<a;e++)if(t>l[e]&&t<=l[e+1]){s=`${i[e]}`;break}return{time:`0:${n}`,note:s,velocity:e[n],index:n,duration:r[n]*o}}));return new Dh(((t,e)=>{const i=e.duration;Jf.triggerAttackRelease(e.note,i,t,e.velocity),Zh.schedule((()=>{n(e.index)}))}),h).start(0)}function s_(t,e,n){let i=xf(t,null,[0,1]),s=t;s=xf(Af(s,1),[0,1],[.02,.4]),i=xf(Af(i,1),null,[-.1,0]);const o=Tf(Cf(i,s),[.02,1]),r=12/Fh.bpm.value*6,a=function(t,e){const n=t.length,i=Array(n);for(let s=0;s<n;s++){let o=Array(n-1),r=s;for(let i=1;i<n;i++){s+i>=n&&(r=s-n);let a=t[r+i]/t[s];o[i-1]=!isFinite(a)||isNaN(a)?null:a<e}let a=1;for(let t=0;t<n-1&&o[t];t++)a++;i[s]=a}return i}(o,.5),l=o.map(((e,n)=>0===t[n]?0:e));t=xf(t,[0,1],[1,0]);const h=n.length,u=Array(h+1).fill(0).map(((t,e)=>1*e/h)),c=t.map(((t,e)=>{let i;for(let e=0;e<h;e++)if(t>u[e]&&t<=u[e+1]){i=`${n[e]}`;break}return{time:`0:${e}`,note:i,velocity:l[e],index:e,duration:a[e]*r}})),p=new Dh(((t,n)=>{Qf.triggerAttackRelease(n.note,n.duration,t,n.velocity),Zh.schedule((()=>{e(n.index)}))}),c.filter((t=>t))).start(0);return p}function o_(t,e,n){let i=xf(t,null,[0,1]),s=t;s=xf(Af(s,1),[0,1],[.02,.3]),i=xf(Af(i,1),null,[-.1,0]);const o=Tf(Cf(i,s),[.03,1]).map(((e,n)=>0===t[n]?0:e));t=xf(t,[0,1],[.01,1]);const r=12/Fh.bpm.value*16,a=Af(t,12),l=n.length,h=Array(l+1).fill(0).map(((t,e)=>1*e/l)),u=t.map(((t,e)=>{let i;for(let e=0;e<l;e++)if(t>h[e]&&t<=h[e+1]){i=`${n[e]}`;break}return{time:`0:${e}`,note:i,velocity:o[e],index:e,duration:a[e]*r}})),c=new Dh(((t,n)=>{t_.triggerAttackRelease(n.note,n.duration,t,n.velocity),Zh.schedule((()=>{e(n.index)}))}),u.filter((t=>t))).start(0);return c}function r_(t){const e=Array(12).fill("").map(((t,e)=>({time:`0:${e}`,index:e})));return new Dh(((e,n)=>{Object.keys(t[n.index]).map((i=>{e_.triggerAttackRelease(i,20,e,.7*t[n.index][i])}))}),e).start(0)}function a_(t=!1,e=!1,n=!1){let i,s,o;return Wf.update((e=>(i=e,t))),$f.update((t=>(s=t,e))),Yf.update((t=>(o=t,n))),()=>{Wf.set(i),$f.set(s),Yf.set(o)}}let l_={};const h_=[{highlight:{selector:"#map",circle:!1,offset:{top:60}},action:()=>{a_(!1,!1,!1);let t=u(Uf),e=u(Gf);return l_.zoom=t.getZoom(),l_.center=t.getCenter(),l_.station=u(Ff),Uf.update((t=>t.panTo({lat:e.info.lat,lng:e.info.lon},{animate:!0,duration:1}))),null},cleanup:()=>{Ff.set(l_.station),Uf.update((t=>(t.setView(l_.center,l_.zoom,{animate:!0,duration:1}),t.$example_pin.marker.setIcon(t.$example_pin.icon_default),t)))},text:"tutorial.1"},{highlight:{selector:"#pin-example",circle:!0},action:()=>{a_(!1,!1,!1);let t=u(Gf);return Ff.set(t),Uf.update((e=>(e.setView({lat:t.info.lat,lng:t.info.lon},6,{animate:!0,duration:1}),e.$example_pin.marker.setIcon(e.$example_pin.icon_selected),e))),null},text:"tutorial.2"},{highlight:{selector:"#plots-panel",circle:!1},action:()=>(a_(!0,!1,!1),null),text:"tutorial.3"},{highlight:{selector:"#toggle-plots",circle:!0},action:()=>(a_(!0,!1,!1),()=>{a_(!1,!1,!1)}),text:"tutorial.4"},{highlight:{selector:"#sound-controller",circle:!0},action:()=>(a_(!0,!1,!1),null),text:"tutorial.5"},{highlight:{selector:"#toggle-options",circle:!0},action:()=>(a_(!1,!0,!1),()=>{a_(!1,!1,!1)}),text:"tutorial.6"},{text:"tutorial.7"}];function u_(t,e,n,i=null){i=i||{};const s={top:0,right:0,bottom:0,left:0,...i},o=t.getBoundingClientRect(),r=o.width-s.left-s.right,a=o.height-s.top-s.bottom;let l;if(n){l=10;const t=Math.max(r,a);e.style.width=`${t+2*l}px`,e.style.height=`${t+2*l}px`,e.style.top=o.y+s.top-l-(t-a)/2+"px",e.style.left=o.x+s.left-l-(t-r)/2+"px",e.style.borderRadius="50%"}else l=-4,e.style.width=`${r+2*l}px`,e.style.height=`${a+2*l}px`,e.style.top=o.y+s.top-l+"px",e.style.left=o.x+s.left-l+"px",e.style.borderRadius="0"}class c_{constructor(t,e,n,i=(()=>{})){this.on_change=i,this.step=0,this.panels=a_(!1,!1,!1),Ff.update((t=>(this.station=t,null))),this.highlighting_element=t,this.explaination_element=e,this.nohighlight_element=n,this.resize_observer=new ResizeObserver((t=>{this.onResize()})),this.current_element=null,this.cleanup_function=null}onResize(){u_(this.current_element,this.highlighting_element,h_[this.step].highlight.circle,h_[this.step].highlight.offset)}length(){return h_.length}current(){return this.step}stop(){this.panels(),Ff.set(this.station),this.cleanup_function&&(this.cleanup_function(),this.cleanup_function=null),this.current_element&&this.resize_observer.unobserve(this.current_element);for(let t of h_)t.cleanup&&t.cleanup();this.on_change()}hasNextStep(){return!(this.step>=h_.length-1)}nextStep(){this.step>=h_.length-1||this.hasNextStep()&&(this.step++,this.setupStep(),this.on_change())}hasPreviousStep(){return!(this.step<=0)}previousStep(){this.hasPreviousStep()&&(this.step--,this.setupStep(),this.on_change())}async setupStep(){if(this.cleanup_function&&(this.cleanup_function(),this.cleanup_function=null),h_[this.step].action&&(this.cleanup_function=h_[this.step].action()),this.current_element&&this.resize_observer.unobserve(this.current_element),h_[this.step].highlight){const t=await function(t){let e,n,i=0;return new Promise(((s,o)=>{e=document.querySelector(t),e?s(e):n=setInterval((()=>{i++,e=document.querySelector(t),e?(clearInterval(n),s(e)):i>500&&(clearInterval(n),s(null))}),10)}))}(h_[this.step].highlight.selector);t&&(this.current_element=t),this.resize_observer.observe(this.current_element),u_(this.current_element,this.highlighting_element,h_[this.step].highlight.circle,h_[this.step].highlight.offset)}else u_(this.nohighlight_element,this.highlighting_element,!0);this.explaination_element.textContent=u(Vn)(h_[this.step].text),this.on_change()}}function p_(t,e,n){const i=t.slice();return i[15]=e[n],i}function d_(t){let e;return{c(){e=A("div"),P(e,"class","svelte-vx6wqn"),R(e,"done",t[15])},m(t,n){x(t,e,n)},p(t,n){64&n&&R(e,"done",t[15])},d(t){t&&T(e)}}}function f_(e){let n,i,o,r,a,l,h,u,c,p,d,f,_,m,g,v,w,b,k,L,O,I=e[6],D=[];for(let t=0;t<I.length;t+=1)D[t]=d_(p_(e,I,t));return{c(){n=A("div"),i=A("div"),o=M(),r=A("div"),a=M(),l=A("div"),h=A("div"),u=A("div"),c=M(),p=A("div"),d=A("button"),f=S("Previous"),_=M(),m=A("button"),g=S("Next"),v=M(),w=A("button"),w.textContent="Quit",b=M(),k=A("div");for(let t=0;t<D.length;t+=1)D[t].c();P(i,"id","no-highlight"),P(i,"class","svelte-vx6wqn"),P(r,"class","highlight svelte-vx6wqn"),P(u,"class","explaination svelte-vx6wqn"),d.disabled=e[4],P(d,"class","svelte-vx6wqn"),m.disabled=e[5],P(m,"class","svelte-vx6wqn"),P(w,"class","svelte-vx6wqn"),P(p,"class","actions svelte-vx6wqn"),P(k,"class","progress svelte-vx6wqn"),P(h,"class","svelte-vx6wqn"),P(l,"class","details svelte-vx6wqn"),P(n,"class","container svelte-vx6wqn")},m(t,s){x(t,n,s),y(n,i),e[9](i),y(n,o),y(n,r),e[10](r),y(n,a),y(n,l),y(l,h),y(h,u),e[11](u),y(h,c),y(h,p),y(p,d),y(d,f),y(p,_),y(p,m),y(m,g),y(p,v),y(p,w),y(h,b),y(h,k);for(let t=0;t<D.length;t+=1)D[t].m(k,null);L||(O=[E(window,"resize",e[8]),E(d,"click",e[12]),E(m,"click",e[13]),E(w,"click",e[14])],L=!0)},p(t,[e]){if(16&e&&(d.disabled=t[4]),32&e&&(m.disabled=t[5]),64&e){let n;for(I=t[6],n=0;n<I.length;n+=1){const i=p_(t,I,n);D[n]?D[n].p(i,e):(D[n]=d_(i),D[n].c(),D[n].m(k,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=I.length}},i:t,o:t,d(t){t&&T(n),e[9](null),e[10](null),e[11](null),C(D,t),L=!1,s(O)}}}function __(t,e,n){let i,s,o,r,a;c(t,Xf,(t=>n(7,i=t)));let l=!1,h=!0,u=[];q((()=>{n(3,a=new c_(s,o,r,(()=>{n(4,l=!a.hasPreviousStep()),n(5,h=!a.hasNextStep())}))),n(6,u=Array(a.length()).fill(!1)),a.setupStep(),n(6,u[0]=!0,u)}));return[s,o,r,a,l,h,u,i,()=>{a.onResize()},function(t){U[t?"unshift":"push"]((()=>{r=t,n(2,r)}))},function(t){U[t?"unshift":"push"]((()=>{s=t,n(0,s)}))},function(t){U[t?"unshift":"push"]((()=>{o=t,n(1,o)}))},()=>{a.previousStep();let t=a.current();n(6,u=u.map(((e,n)=>n<=t)))},()=>{a.nextStep();let t=a.current();n(6,u=u.map(((e,n)=>n<=t)))},()=>{a.stop(),d(Xf,i=!1,i)}]}class m_ extends mt{constructor(t){super(),_t(this,t,__,f_,r,{})}}function g_(e){let n,i,s,o,r,a,l,h,u,c,p,d,f,_,m,g,v,w,b,C,k,E,L,O,D,N,R,z,B,V,F,Z,j,q,G,U,$,W,H,X,Y,K,Q,J,tt,et,nt,it,st,ot,rt,at,lt,ht,ut,ct=e[0]("app_description.why")+"",pt=e[0]("app_description.how.1")+"",dt=e[0]("app_description.how.2")+"",ft=e[0]("app_description.how.3")+"",_t=e[0]("app_description.how.4")+"",mt=e[0]("app_description.how.5")+"",gt=e[0]("app_description.what")+"",vt=e[0]("app_description.average_flow.1")+"",yt=e[0]("app_description.average_flow.2")+"",wt=e[0]("app_description.monthly_mean_flow.1")+"",bt=e[0]("app_description.monthly_mean_flow.2")+"",xt=e[0]("app_description.monthly_max_flow.1")+"",Tt=e[0]("app_description.monthly_max_flow.2")+"",Ct=e[0]("app_description.monthly_min_flow.1")+"",At=e[0]("app_description.monthly_min_flow.2")+"",kt=e[0]("app_description.monthly_min_flow.3")+"",St=e[0]("app_description.headphone")+"";return{c(){n=A("div"),i=A("p"),s=S(ct),o=M(),r=A("p"),a=S(pt),l=M(),h=A("span"),u=S(dt),c=M(),p=S(ft),d=M(),f=A("span"),_=S(_t),m=M(),g=S(mt),v=M(),w=A("p"),b=S(gt),C=M(),k=A("ul"),E=A("li"),L=A("span"),O=S(vt),D=M(),N=A("span"),R=S(yt),z=M(),B=A("li"),V=A("span"),F=S(wt),Z=M(),j=A("span"),q=S(bt),G=M(),U=A("li"),$=A("span"),W=S(xt),H=M(),X=A("span"),Y=S(Tt),K=M(),Q=A("li"),J=A("span"),tt=S(Ct),et=M(),nt=A("span"),it=S(At),st=M(),ot=A("a"),rt=S(kt),lt=M(),ht=A("p"),ut=S(St),P(i,"class","svelte-1rl61i6"),P(h,"class","highlight svelte-1rl61i6"),P(f,"class","highlight svelte-1rl61i6"),P(r,"class","svelte-1rl61i6"),P(w,"class","svelte-1rl61i6"),P(L,"class","highlight svelte-1rl61i6"),P(E,"class","svelte-1rl61i6"),P(V,"class","highlight svelte-1rl61i6"),P(B,"class","svelte-1rl61i6"),P($,"class","highlight svelte-1rl61i6"),P(U,"class","svelte-1rl61i6"),P(J,"class","highlight svelte-1rl61i6"),P(ot,"href",at=e[0]("app_description.monthly_min_flow.4")),P(ot,"target","_blank"),P(Q,"class","svelte-1rl61i6"),P(k,"class","svelte-1rl61i6"),P(ht,"class","svelte-1rl61i6"),P(n,"class","container svelte-1rl61i6")},m(t,e){x(t,n,e),y(n,i),y(i,s),y(n,o),y(n,r),y(r,a),y(r,l),y(r,h),y(h,u),y(r,c),y(r,p),y(r,d),y(r,f),y(f,_),y(r,m),y(r,g),y(n,v),y(n,w),y(w,b),y(n,C),y(n,k),y(k,E),y(E,L),y(L,O),y(E,D),y(E,N),y(N,R),y(k,z),y(k,B),y(B,V),y(V,F),y(B,Z),y(B,j),y(j,q),y(k,G),y(k,U),y(U,$),y($,W),y(U,H),y(U,X),y(X,Y),y(k,K),y(k,Q),y(Q,J),y(J,tt),y(Q,et),y(Q,nt),y(nt,it),y(nt,st),y(nt,ot),y(ot,rt),y(n,lt),y(n,ht),y(ht,ut)},p(t,[e]){1&e&&ct!==(ct=t[0]("app_description.why")+"")&&I(s,ct),1&e&&pt!==(pt=t[0]("app_description.how.1")+"")&&I(a,pt),1&e&&dt!==(dt=t[0]("app_description.how.2")+"")&&I(u,dt),1&e&&ft!==(ft=t[0]("app_description.how.3")+"")&&I(p,ft),1&e&&_t!==(_t=t[0]("app_description.how.4")+"")&&I(_,_t),1&e&&mt!==(mt=t[0]("app_description.how.5")+"")&&I(g,mt),1&e&&gt!==(gt=t[0]("app_description.what")+"")&&I(b,gt),1&e&&vt!==(vt=t[0]("app_description.average_flow.1")+"")&&I(O,vt),1&e&&yt!==(yt=t[0]("app_description.average_flow.2")+"")&&I(R,yt),1&e&&wt!==(wt=t[0]("app_description.monthly_mean_flow.1")+"")&&I(F,wt),1&e&&bt!==(bt=t[0]("app_description.monthly_mean_flow.2")+"")&&I(q,bt),1&e&&xt!==(xt=t[0]("app_description.monthly_max_flow.1")+"")&&I(W,xt),1&e&&Tt!==(Tt=t[0]("app_description.monthly_max_flow.2")+"")&&I(Y,Tt),1&e&&Ct!==(Ct=t[0]("app_description.monthly_min_flow.1")+"")&&I(tt,Ct),1&e&&At!==(At=t[0]("app_description.monthly_min_flow.2")+"")&&I(it,At),1&e&&kt!==(kt=t[0]("app_description.monthly_min_flow.3")+"")&&I(rt,kt),1&e&&at!==(at=t[0]("app_description.monthly_min_flow.4"))&&P(ot,"href",at),1&e&&St!==(St=t[0]("app_description.headphone")+"")&&I(ut,St)},i:t,o:t,d(t){t&&T(n)}}}function v_(t,e,n){let i;return c(t,Vn,(t=>n(0,i=t))),[i]}class y_ extends mt{constructor(t){super(),_t(this,t,v_,g_,r,{})}}function w_(t,e,n){const i=t.slice();return i[3]=e[n],i}function b_(t){let e,n,i,s,o=`${t[3].label} - ${t[0](`languages.${t[3].id}`)}`;return{c(){e=A("option"),n=S(o),e.__value=i=t[3].id,e.value=e.__value,e.selected=s=t[1]===t[3].id,P(e,"class","svelte-19w0pjy")},m(t,i){x(t,e,i),y(e,n)},p(t,i){1&i&&o!==(o=`${t[3].label} - ${t[0](`languages.${t[3].id}`)}`)&&I(n,o),2&i&&s!==(s=t[1]===t[3].id)&&(e.selected=s)},d(t){t&&T(e)}}}function x_(e){let n,i,s,o,r,a,l,h,u=e[0]("languages.select")+"",c=Zn,p=[];for(let t=0;t<c.length;t+=1)p[t]=b_(w_(e,c,t));return{c(){n=A("div"),i=A("label"),s=S(u),o=S(":"),r=M(),a=A("select");for(let t=0;t<p.length;t+=1)p[t].c();P(i,"for","language"),P(i,"class","svelte-19w0pjy"),P(a,"name","language"),P(a,"id","language"),P(a,"class","svelte-19w0pjy"),void 0===e[1]&&Y((()=>e[2].call(a))),P(n,"class","container svelte-19w0pjy")},m(t,u){x(t,n,u),y(n,i),y(i,s),y(i,o),y(n,r),y(n,a);for(let t=0;t<p.length;t+=1)p[t].m(a,null);N(a,e[1]),l||(h=E(a,"change",e[2]),l=!0)},p(t,[e]){if(1&e&&u!==(u=t[0]("languages.select")+"")&&I(s,u),3&e){let n;for(c=Zn,n=0;n<c.length;n+=1){const i=w_(t,c,n);p[n]?p[n].p(i,e):(p[n]=b_(i),p[n].c(),p[n].m(a,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=c.length}2&e&&N(a,t[1])},i:t,o:t,d(t){t&&T(n),C(p,t),l=!1,h()}}}function T_(t,e,n){let i,s;return c(t,Vn,(t=>n(0,i=t))),c(t,Sn,(t=>n(1,s=t))),[i,s,function(){s=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),Sn.set(s)}]}class C_ extends mt{constructor(t){super(),_t(this,t,T_,x_,r,{})}}function A_(t){let e,n,i,o,r,a,h,u,c,p,d,f,_,m,g,v,w,b,C,k,L,O,D,N,R,z,B,V,F,Z,j=t[0]("app_welcome.header")+"",q=t[0]("app_welcome.tutorial_invite")+"",G=t[0]("app_welcome.tutorial_btn")+"",U=t[0]("app_welcome.start_btn")+"";return f=new C_({}),g=new y_({}),{c(){e=A("div"),n=M(),i=A("div"),o=A("div"),r=A("img"),h=M(),u=A("h2"),c=S(j),p=M(),d=A("div"),ct(f.$$.fragment),_=M(),m=A("div"),ct(g.$$.fragment),v=M(),w=A("div"),b=A("p"),C=S(q),k=M(),L=A("div"),O=A("button"),D=S(G),R=M(),z=A("button"),B=S(U),P(e,"class","disable-page svelte-1drb2dz"),l(r.src,a="/images/hydrosound_icon_96.png")||P(r,"src","/images/hydrosound_icon_96.png"),P(r,"alt","Hydrological soundscapes icon"),P(r,"class","svelte-1drb2dz"),P(u,"class","svelte-1drb2dz"),P(o,"class","header svelte-1drb2dz"),P(d,"class","svelte-1drb2dz"),P(m,"class","svelte-1drb2dz"),P(b,"class","svelte-1drb2dz"),O.disabled=N=!t[3],P(L,"class","buttons svelte-1drb2dz"),P(w,"class","actions svelte-1drb2dz"),P(i,"class","container svelte-1drb2dz")},m(s,a){x(s,e,a),x(s,n,a),x(s,i,a),y(i,o),y(o,r),y(o,h),y(o,u),y(u,c),y(i,p),y(i,d),pt(f,d,null),y(i,_),y(i,m),pt(g,m,null),y(i,v),y(i,w),y(w,b),y(b,C),y(w,k),y(w,L),y(L,O),y(O,D),y(L,R),y(L,z),y(z,B),V=!0,F||(Z=[E(O,"click",t[4]),E(z,"click",t[5])],F=!0)},p(t,[e]){(!V||1&e)&&j!==(j=t[0]("app_welcome.header")+"")&&I(c,j),(!V||1&e)&&q!==(q=t[0]("app_welcome.tutorial_invite")+"")&&I(C,q),(!V||1&e)&&G!==(G=t[0]("app_welcome.tutorial_btn")+"")&&I(D,G),(!V||8&e&&N!==(N=!t[3]))&&(O.disabled=N),(!V||1&e)&&U!==(U=t[0]("app_welcome.start_btn")+"")&&I(B,U)},i(t){V||(at(f.$$.fragment,t),at(g.$$.fragment,t),V=!0)},o(t){lt(f.$$.fragment,t),lt(g.$$.fragment,t),V=!1},d(t){t&&T(e),t&&T(n),t&&T(i),dt(f),dt(g),F=!1,s(Z)}}}function k_(t,e,n){let i,s,o,r;c(t,Vn,(t=>n(0,i=t))),c(t,Hf,(t=>n(1,s=t))),c(t,Xf,(t=>n(2,o=t))),c(t,Kf,(t=>n(3,r=t)));return[i,s,o,r,()=>{d(Hf,s=!1,s),d(Xf,o=!0,o)},()=>d(Hf,s=!1,s)]}class S_ extends mt{constructor(t){super(),_t(this,t,k_,A_,r,{})}}
/* @preserve
     * Leaflet 1.7.1, a JS library for interactive maps. http://leafletjs.com
     * (c) 2010-2019 Vladimir Agafonkin, (c) 2010-2011 CloudMade
     */var M_=Un((function(t,e){!function(t){var e="1.7.1";function n(t){var e,n,i,s;for(n=1,i=arguments.length;n<i;n++)for(e in s=arguments[n])t[e]=s[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function s(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var o=0;function r(t){return t._leaflet_id=t._leaflet_id||++o,t._leaflet_id}function a(t,e,n){var i,s,o,r;return r=function(){i=!1,s&&(o.apply(n,s),s=!1)},o=function(){i?s=arguments:(t.apply(n,arguments),setTimeout(r,e),i=!0)},o}function l(t,e,n){var i=e[1],s=e[0],o=i-s;return t===i&&n?t:((t-s)%o+o)%o+s}function h(){return!1}function u(t,e){var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function c(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function p(t){return c(t).split(/\s+/)}function d(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function f(t,e,n){var i=[];for(var s in t)i.push(encodeURIComponent(n?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var _=/\{ *([\w_-]+) *\}/g;function m(t,e){return t.replace(_,(function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i}))}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function v(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var b=0;function x(t){var e=+new Date,n=Math.max(0,16-(e-b));return b=e+n,window.setTimeout(t,n)}var T=window.requestAnimationFrame||w("RequestAnimationFrame")||x,C=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function A(t,e,n){if(!n||T!==x)return T.call(window,s(t,e));t.call(e)}function k(t){t&&C.call(window,t)}var S={extend:n,create:i,bind:s,lastId:o,stamp:r,throttle:a,wrapNum:l,falseFn:h,formatNum:u,trim:c,splitWords:p,setOptions:d,getParamString:f,template:m,isArray:g,indexOf:v,emptyImageUrl:y,requestFn:T,cancelFn:C,requestAnimFrame:A,cancelAnimFrame:k};function M(){}function E(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e],L.Mixin.Events}}M.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=e.__super__=this.prototype,o=i(s);for(var r in o.constructor=e,e.prototype=o,this)Object.prototype.hasOwnProperty.call(this,r)&&"prototype"!==r&&"__super__"!==r&&(e[r]=this[r]);return t.statics&&(n(e,t.statics),delete t.statics),t.includes&&(E(t.includes),n.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=n(i(o.options),t.options)),n(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},M.include=function(t){return n(this.prototype,t),this},M.mergeOptions=function(t){return n(this.prototype.options,t),this},M.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var P={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var s=0,o=(t=p(t)).length;s<o;s++)this._on(t[s],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else for(var s=0,o=(t=p(t)).length;s<o;s++)this._off(t[s],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=void 0);for(var s={fn:e,ctx:n},o=i,r=0,a=o.length;r<a;r++)if(o[r].fn===e&&o[r].ctx===n)return;o.push(s)},_off:function(t,e,n){var i,s,o;if(this._events&&(i=this._events[t]))if(e){if(n===this&&(n=void 0),i)for(s=0,o=i.length;s<o;s++){var r=i[s];if(r.ctx===n&&r.fn===e)return r.fn=h,this._firingCount&&(this._events[t]=i=i.slice()),void i.splice(s,1)}}else{for(s=0,o=i.length;s<o;s++)i[s].fn=h;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var s=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var r=0,a=o.length;r<a;r++){var l=o[r];l.fn.call(l.ctx||this,s)}this._firingCount--}}return i&&this._propagateEvent(s),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var i in t)this.once(i,t[i],e);return this}var o=s((function(){this.off(t,e,n).off(t,o,n)}),this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};P.addEventListener=P.on,P.removeEventListener=P.clearAllEventListeners=P.off,P.addOneTimeEventListener=P.once,P.fireEvent=P.fire,P.hasEventListeners=P.listens;var O=M.extend(P);function I(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var D=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function N(t,e,n){return t instanceof I?t:g(t)?new I(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new I(t.x,t.y):new I(t,e,n)}function R(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function z(t,e){return!t||t instanceof R?t:new R(t,e)}function B(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function V(t,e){return t instanceof B?t:new B(t,e)}function F(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function Z(t,e,n){return t instanceof F?t:g(t)&&"object"!=typeof t[0]?3===t.length?new F(t[0],t[1],t[2]):2===t.length?new F(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new F(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new F(t,e,n)}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(t){return this.clone()._add(N(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(N(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new I(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new I(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=D(this.x),this.y=D(this.y),this},distanceTo:function(t){var e=(t=N(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=N(t)).x===this.x&&t.y===this.y},contains:function(t){return t=N(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},R.prototype={extend:function(t){return t=N(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new I((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new I(this.min.x,this.max.y)},getTopRight:function(){return new I(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof I?N(t):z(t))instanceof R?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=z(t);var e=this.min,n=this.max,i=t.min,s=t.max,o=s.x>=e.x&&i.x<=n.x,r=s.y>=e.y&&i.y<=n.y;return o&&r},overlaps:function(t){t=z(t);var e=this.min,n=this.max,i=t.min,s=t.max,o=s.x>e.x&&i.x<n.x,r=s.y>e.y&&i.y<n.y;return o&&r},isValid:function(){return!(!this.min||!this.max)}},B.prototype={extend:function(t){var e,n,i=this._southWest,s=this._northEast;if(t instanceof F)e=t,n=t;else{if(!(t instanceof B))return t?this.extend(Z(t)||V(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||s?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),s.lat=Math.max(n.lat,s.lat),s.lng=Math.max(n.lng,s.lng)):(this._southWest=new F(e.lat,e.lng),this._northEast=new F(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,s=Math.abs(e.lng-n.lng)*t;return new B(new F(e.lat-i,e.lng-s),new F(n.lat+i,n.lng+s))},getCenter:function(){return new F((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new F(this.getNorth(),this.getWest())},getSouthEast:function(){return new F(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof F||"lat"in t?Z(t):V(t);var e,n,i=this._southWest,s=this._northEast;return t instanceof B?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=s.lat&&e.lng>=i.lng&&n.lng<=s.lng},intersects:function(t){t=V(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>=e.lat&&i.lat<=n.lat,r=s.lng>=e.lng&&i.lng<=n.lng;return o&&r},overlaps:function(t){t=V(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>e.lat&&i.lat<n.lat,r=s.lng>e.lng&&i.lng<n.lng;return o&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=V(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},F.prototype={equals:function(t,e){return!!t&&(t=Z(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+u(this.lat,t)+", "+u(this.lng,t)+")"},distanceTo:function(t){return q.distance(this,Z(t))},wrap:function(){return q.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return V([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new F(this.lat,this.lng,this.alt)}};var j={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new R(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new F(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,s=e.lng-n.lng;if(0===i&&0===s)return t;var o=t.getSouthWest(),r=t.getNorthEast();return new B(new F(o.lat-i,o.lng-s),new F(r.lat-i,r.lng-s))}},q=n({},j,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,s=e.lat*n,o=Math.sin((e.lat-t.lat)*n/2),r=Math.sin((e.lng-t.lng)*n/2),a=o*o+Math.cos(i)*Math.cos(s)*r*r,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),G=6378137,U={R:G,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),s=Math.sin(i*e);return new I(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new F((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=G*Math.PI;return new R([-t,-t],[t,t])}()};function $(t,e,n,i){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function W(t,e,n,i){return new $(t,e,n,i)}$.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new I((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var H=n({},q,{code:"EPSG:3857",projection:U,transformation:function(){var t=.5/(Math.PI*U.R);return W(t,.5,-t,.5)}()}),X=n({},H,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t,e){var n,i,s,o,r,a,l="";for(n=0,s=t.length;n<s;n++){for(i=0,o=(r=t[n]).length;i<o;i++)l+=(i?"L":"M")+(a=r[i]).x+" "+a.y;l+=e?Et?"z":"x":""}return l||"M0 0"}var Q=document.documentElement.style,J="ActiveXObject"in window,tt=J&&!document.addEventListener,et="msLaunchUri"in navigator&&!("documentMode"in document),nt=Pt("webkit"),it=Pt("android"),st=Pt("android 2")||Pt("android 3"),ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),rt=it&&Pt("Google")&&ot<537&&!("AudioNode"in window),at=!!window.opera,lt=!et&&Pt("chrome"),ht=Pt("gecko")&&!nt&&!at&&!J,ut=!lt&&Pt("safari"),ct=Pt("phantom"),pt="OTransition"in Q,dt=0===navigator.platform.indexOf("Win"),ft=J&&"transition"in Q,_t="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!st,mt="MozPerspective"in Q,gt=!window.L_DISABLE_3D&&(ft||_t||mt)&&!pt&&!ct,vt="undefined"!=typeof orientation||Pt("mobile"),yt=vt&&nt,wt=vt&&_t,bt=!window.PointerEvent&&window.MSPointerEvent,xt=!(!window.PointerEvent&&!bt),Tt=!window.L_NO_TOUCH&&(xt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Ct=vt&&at,At=vt&&ht,kt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,St=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",h,e),window.removeEventListener("testPassiveEventSupport",h,e)}catch(t){}return t}(),Mt=!!document.createElement("canvas").getContext,Et=!(!document.createElementNS||!Y("svg").createSVGRect),Lt=!Et&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Pt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Ot={ie:J,ielt9:tt,edge:et,webkit:nt,android:it,android23:st,androidStock:rt,opera:at,chrome:lt,gecko:ht,safari:ut,phantom:ct,opera12:pt,win:dt,ie3d:ft,webkit3d:_t,gecko3d:mt,any3d:gt,mobile:vt,mobileWebkit:yt,mobileWebkit3d:wt,msPointer:bt,pointer:xt,touch:Tt,mobileOpera:Ct,mobileGecko:At,retina:kt,passiveEvents:St,canvas:Mt,svg:Et,vml:Lt},It=bt?"MSPointerDown":"pointerdown",Dt=bt?"MSPointerMove":"pointermove",Nt=bt?"MSPointerUp":"pointerup",Rt=bt?"MSPointerCancel":"pointercancel",zt={},Bt=!1;function Vt(t,e,n,i){return"touchstart"===e?Zt(t,n,i):"touchmove"===e?$t(t,n,i):"touchend"===e&&Wt(t,n,i),this}function Ft(t,e,n){var i=t["_leaflet_"+e+n];return"touchstart"===e?t.removeEventListener(It,i,!1):"touchmove"===e?t.removeEventListener(Dt,i,!1):"touchend"===e&&(t.removeEventListener(Nt,i,!1),t.removeEventListener(Rt,i,!1)),this}function Zt(t,e,n){var i=s((function(t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&qe(t),Ut(t,e)}));t["_leaflet_touchstart"+n]=i,t.addEventListener(It,i,!1),Bt||(document.addEventListener(It,jt,!0),document.addEventListener(Dt,qt,!0),document.addEventListener(Nt,Gt,!0),document.addEventListener(Rt,Gt,!0),Bt=!0)}function jt(t){zt[t.pointerId]=t}function qt(t){zt[t.pointerId]&&(zt[t.pointerId]=t)}function Gt(t){delete zt[t.pointerId]}function Ut(t,e){for(var n in t.touches=[],zt)t.touches.push(zt[n]);t.changedTouches=[t],e(t)}function $t(t,e,n){var i=function(t){t.pointerType===(t.MSPOINTER_TYPE_MOUSE||"mouse")&&0===t.buttons||Ut(t,e)};t["_leaflet_touchmove"+n]=i,t.addEventListener(Dt,i,!1)}function Wt(t,e,n){var i=function(t){Ut(t,e)};t["_leaflet_touchend"+n]=i,t.addEventListener(Nt,i,!1),t.addEventListener(Rt,i,!1)}var Ht=bt?"MSPointerDown":xt?"pointerdown":"touchstart",Xt=bt?"MSPointerUp":xt?"pointerup":"touchend",Yt="_leaflet_";function Kt(t,e,n){var i,s,o=!1,r=250;function a(t){if(xt){if(!t.isPrimary)return;if("mouse"===t.pointerType)return}else if(t.touches.length>1)return;var e=Date.now(),n=e-(i||e);s=t.touches?t.touches[0]:t,o=n>0&&n<=r,i=e}function l(t){if(o&&!s.cancelBubble){if(xt){if("mouse"===t.pointerType)return;var n,r,a={};for(r in s)n=s[r],a[r]=n&&n.bind?n.bind(s):n;s=a}s.type="dblclick",s.button=0,e(s),i=null}}return t[Yt+Ht+n]=a,t[Yt+Xt+n]=l,t[Yt+"dblclick"+n]=e,t.addEventListener(Ht,a,!!St&&{passive:!1}),t.addEventListener(Xt,l,!!St&&{passive:!1}),t.addEventListener("dblclick",e,!1),this}function Qt(t,e){var n=t[Yt+Ht+e],i=t[Yt+Xt+e],s=t[Yt+"dblclick"+e];return t.removeEventListener(Ht,n,!!St&&{passive:!1}),t.removeEventListener(Xt,i,!!St&&{passive:!1}),t.removeEventListener("dblclick",s,!1),this}var Jt,te,ee,ne,ie,se=be(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),oe=be(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),re="webkitTransition"===oe||"OTransition"===oe?oe+"End":"transitionend";function ae(t){return"string"==typeof t?document.getElementById(t):t}function le(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function he(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function ue(t){var e=t.parentNode;e&&e.removeChild(t)}function ce(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function pe(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function de(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function fe(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=ve(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function _e(t,e){if(void 0!==t.classList)for(var n=p(e),i=0,s=n.length;i<s;i++)t.classList.add(n[i]);else if(!fe(t,e)){var o=ve(t);ge(t,(o?o+" ":"")+e)}}function me(t,e){void 0!==t.classList?t.classList.remove(e):ge(t,c((" "+ve(t)+" ").replace(" "+e+" "," ")))}function ge(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function ve(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function ye(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&we(t,e)}function we(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function be(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function xe(t,e,n){var i=e||new I(0,0);t.style[se]=(ft?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Te(t,e){t._leaflet_pos=e,gt?xe(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Ce(t){return t._leaflet_pos||new I(0,0)}if("onselectstart"in document)Jt=function(){Ie(window,"selectstart",qe)},te=function(){Ne(window,"selectstart",qe)};else{var Ae=be(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Jt=function(){if(Ae){var t=document.documentElement.style;ee=t[Ae],t[Ae]="none"}},te=function(){Ae&&(document.documentElement.style[Ae]=ee,ee=void 0)}}function ke(){Ie(window,"dragstart",qe)}function Se(){Ne(window,"dragstart",qe)}function Me(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ee(),ne=t,ie=t.style.outline,t.style.outline="none",Ie(window,"keydown",Ee))}function Ee(){ne&&(ne.style.outline=ie,ne=void 0,ie=void 0,Ne(window,"keydown",Ee))}function Le(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Pe(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Oe={TRANSFORM:se,TRANSITION:oe,TRANSITION_END:re,get:ae,getStyle:le,create:he,remove:ue,empty:ce,toFront:pe,toBack:de,hasClass:fe,addClass:_e,removeClass:me,setClass:ge,getClass:ve,setOpacity:ye,testProp:be,setTransform:xe,setPosition:Te,getPosition:Ce,disableTextSelection:Jt,enableTextSelection:te,disableImageDrag:ke,enableImageDrag:Se,preventOutline:Me,restoreOutline:Ee,getSizedParentNode:Le,getScale:Pe};function Ie(t,e,n,i){if("object"==typeof e)for(var s in e)Be(t,s,e[s],n);else for(var o=0,r=(e=p(e)).length;o<r;o++)Be(t,e[o],n,i);return this}var De="_leaflet_events";function Ne(t,e,n,i){if("object"==typeof e)for(var s in e)Ve(t,s,e[s],n);else if(e)for(var o=0,r=(e=p(e)).length;o<r;o++)Ve(t,e[o],n,i);else{for(var a in t[De])Ve(t,a,t[De][a]);delete t[De]}return this}function Re(){if(xt)return!(et||ut)}var ze={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Be(t,e,n,i){var s=e+r(n)+(i?"_"+r(i):"");if(t[De]&&t[De][s])return this;var o=function(e){return n.call(i||t,e||window.event)},a=o;xt&&0===e.indexOf("touch")?Vt(t,e,o,s):Tt&&"dblclick"===e&&!Re()?Kt(t,o,s):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(ze[e]||e,o,!!St&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,Ke(t,e)&&a(e)},t.addEventListener(ze[e],o,!1)):t.addEventListener(e,a,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[De]=t[De]||{},t[De][s]=o}function Ve(t,e,n,i){var s=e+r(n)+(i?"_"+r(i):""),o=t[De]&&t[De][s];if(!o)return this;xt&&0===e.indexOf("touch")?Ft(t,e,s):Tt&&"dblclick"===e&&!Re()?Qt(t,s):"removeEventListener"in t?t.removeEventListener(ze[e]||e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o),t[De][s]=null}function Fe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Ye(t),this}function Ze(t){return Be(t,"wheel",Fe),this}function je(t){return Ie(t,"mousedown touchstart dblclick",Fe),Be(t,"click",Xe),this}function qe(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ge(t){return qe(t),Fe(t),this}function Ue(t,e){if(!e)return new I(t.clientX,t.clientY);var n=Pe(e),i=n.boundingClientRect;return new I((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var $e=dt&&lt?2*window.devicePixelRatio:ht?window.devicePixelRatio:1;function We(t){return et?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/$e:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var He={};function Xe(t){He[t.type]=!0}function Ye(t){var e=He[t.type];return He[t.type]=!1,e}function Ke(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var Qe={on:Ie,off:Ne,stopPropagation:Fe,disableScrollPropagation:Ze,disableClickPropagation:je,preventDefault:qe,stop:Ge,getMousePosition:Ue,getWheelDelta:We,fakeStop:Xe,skipped:Ye,isExternalTarget:Ke,addListener:Ie,removeListener:Ne},Je=O.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Ce(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=A(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),Te(this._el,n),this.fire("step")},_complete:function(){k(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),tn=O.extend({options:{crs:H,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=d(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(Z(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=oe&&gt&&!Ct&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ie(this._proxy,re,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(Z(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(gt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(gt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),s=this.getSize().divideBy(2),o=(t instanceof I?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/i),r=this.containerPointToLatLng(s.add(o));return this.setView(r,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():V(t);var n=N(e.paddingTopLeft||e.padding||[0,0]),i=N(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,n.add(i));if((s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s)===1/0)return{center:t.getCenter(),zoom:s};var o=i.subtract(n).divideBy(2),r=this.project(t.getSouthWest(),s),a=this.project(t.getNorthEast(),s);return{center:this.unproject(r.add(a).divideBy(2).add(o),s),zoom:s}},fitBounds:function(t,e){if(!(t=V(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=N(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Je,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){_e(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!gt)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),s=this.project(t),o=this.getSize(),r=this._zoom;t=Z(t),e=void 0===e?r:e;var a=Math.max(o.x,o.y),l=a*this.getZoomScale(r,e),h=s.distanceTo(i)||1,u=1.42,c=u*u;function p(t){var e=(l*l-a*a+(t?-1:1)*c*c*h*h)/(2*(t?l:a)*c*h),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function d(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}function _(t){return d(t)/f(t)}var m=p(0);function g(t){return a*(f(m)/f(m+u*t))}function v(t){return a*(f(m)*_(m+u*t)-d(m))/c}function y(t){return 1-Math.pow(1-t,1.5)}var w=Date.now(),b=(p(1)-m)/u,x=n.duration?1e3*n.duration:1e3*b*.8;function T(){var n=(Date.now()-w)/x,o=y(n)*b;n<=1?(this._flyToFrame=A(T,this),this._move(this.unproject(i.add(s.subtract(i).multiplyBy(v(o)/h)),r),this.getScaleZoom(a/g(o),r),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),T.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=V(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,V(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=N((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=N(e.paddingBottomRight||e.padding||[0,0]),s=this.getCenter(),o=this.project(s),r=this.project(t),a=this.getPixelBounds(),l=a.getSize().divideBy(2),h=z([a.min.add(n),a.max.subtract(i)]);if(!h.contains(r)){this._enforcingBounds=!0;var u=o.subtract(r),c=N(r.x+u.x,r.y+u.y);(r.x<h.min.x||r.x>h.max.x)&&(c.x=o.x-u.x,u.x>0?c.x+=l.x-n.x:c.x-=l.x-i.x),(r.y<h.min.y||r.y>h.max.y)&&(c.y=o.y-u.y,u.y>0?c.y+=l.y-n.y:c.y-=l.y-i.y),this.panTo(this.unproject(c),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),r=i.divideBy(2).round(),a=o.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s(this._handleGeolocationResponse,this),i=s(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new F(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var s=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(s,i.maxZoom):s)}var o={latlng:e,bounds:n,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(o[r]=t.coords[r]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ue(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(k(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ue(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=he("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new B(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=V(t),n=N(n||[0,0]);var i=this.getZoom()||0,s=this.getMinZoom(),o=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(n),h=z(this.project(a,i),this.project(r,i)).getSize(),u=gt?this.options.zoomSnap:1,c=l.x/h.x,p=l.y/h.y,d=e?Math.max(c,p):Math.min(c,p);return i=this.getScaleZoom(d,i),u&&(i=Math.round(i/(u/100))*(u/100),i=e?Math.ceil(i/u)*u:Math.floor(i/u)*u),Math.max(s,Math.min(o,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new I(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new R(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(Z(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(N(t),e)},layerPointToLatLng:function(t){var e=N(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(Z(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(Z(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(V(t))},distance:function(t,e){return this.options.crs.distance(Z(t),Z(e))},containerPointToLayerPoint:function(t){return N(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return N(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(N(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Z(t)))},mouseEventToContainerPoint:function(t){return Ue(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ae(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ie(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&gt,_e(t,"leaflet-container"+(Tt?" leaflet-touch":"")+(kt?" leaflet-retina":"")+(tt?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=le(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Te(this._mapPane,new I(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(_e(t.markerPane,"leaflet-zoom-hide"),_e(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){Te(this._mapPane,new I(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var i=this._zoom!==e;this._moveStart(i,!1)._move(t,e)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n){void 0===e&&(e=this._zoom);var i=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return k(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Te(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Ne:Ie;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),gt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){k(this._resizeRequest),this._resizeRequest=A((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],s="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((n=this._targets[r(o)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(s&&!Ke(o,t))break;if(i.push(n),s)break}if(o===this._container)break;o=o.parentNode}return i.length||a||s||!Ke(o,t)||(i=[this]),i},_handleDOMEvent:function(t){if(this._loaded&&!Ye(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||Me(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if("click"===t.type){var s=n({},t);s.type="preclick",this._fireDOMEvent(s,s.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e))).length){var o=i[0];"contextmenu"===e&&o.listens(e,!0)&&qe(t);var r={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var a=o.getLatLng&&(!o._radius||o._radius<=10);r.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?o.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var l=0;l<i.length;l++)if(i[l].fire(e,r,!0),r.originalEvent._stopped||!1===i[l].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Ce(this._mapPane)||new I(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return z([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),s=this.getSize().divideBy(2),o=new R(i.subtract(s),i.add(s)),r=this._getBoundsOffset(o,n,e);return r.round().equals([0,0])?t:this.unproject(i.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new R(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=z(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),s=i.min.subtract(t.min),o=i.max.subtract(t.max);return new I(this._rebound(s.x,-o.x),this._rebound(s.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=gt?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){me(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=he("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=se,n=this._proxy.style[e];xe(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ue(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();xe(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(s)||(A((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,_e(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&me(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),A((function(){this._moveEnd(!0)}),this))}});function en(t,e){return new tn(t,e)}var nn=M.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return _e(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ue(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),sn=function(t){return new nn(t)};tn.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=he("div",e+"control-container",this._container);function i(i,s){var o=e+i+" "+e+s;t[i+s]=he("div",o,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ue(this._controlCorners[t]);ue(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var on=nn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in d(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return nn.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){_e(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(_e(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):me(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return me(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=he("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),je(e),Ze(e);var i=this._section=he("section",t+"-list");n&&(this._map.on("click",this.collapse,this),it||Ie(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var s=this._layersLink=he("a",t+"-toggle",e);s.href="#",s.title="Layers",Tt?(Ie(s,"click",Ge),Ie(s,"click",this.expand,this)):Ie(s,"focus",this.expand,this),n||this.expand(),this._baseLayersList=he("div",t+"-base",i),this._separator=he("div",t+"-separator",i),this._overlaysList=he("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(s((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ce(this._baseLayersList),ce(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,s=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,s+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+r(this),i),this._layerControlInputs.push(e),e.layerId=r(t.layer),Ie(e,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+t.name;var o=document.createElement("div");return n.appendChild(o),o.appendChild(e),o.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,i=[],s=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||s.push(e);for(o=0;o<s.length;o++)this._map.hasLayer(s[o])&&this._map.removeLayer(s[o]);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])||this._map.addLayer(i[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),s=n.length-1;s>=0;s--)t=n[s],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),rn=function(t,e,n){return new on(t,e,n)},an=nn.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=he("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,s){var o=he("a",n,i);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),je(o),Ie(o,"click",Ge),Ie(o,"click",s,this),Ie(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";me(this._zoomInButton,e),me(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&_e(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&_e(this._zoomInButton,e)}});tn.mergeOptions({zoomControl:!0}),tn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new an,this.addControl(this.zoomControl))}));var ln=function(t){return new an(t)},hn=nn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=he("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=he("div",e,n)),t.imperial&&(this._iScale=he("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,s=3.2808399*t;s>5280?(e=s/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(s),this._updateScale(this._iScale,i+" ft",i/s))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),un=function(t){return new hn(t)},cn=nn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=he("div","leaflet-control-attribution"),je(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});tn.mergeOptions({attributionControl:!0}),tn.addInitHook((function(){this.options.attributionControl&&(new cn).addTo(this)}));var pn=function(t){return new cn(t)};nn.Layers=on,nn.Zoom=an,nn.Scale=hn,nn.Attribution=cn,sn.layers=rn,sn.zoom=ln,sn.scale=un,sn.attribution=pn;var dn=M.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});dn.addTo=function(t,e){return t.addHandler(e,this),this};var fn,_n={Events:P},mn=Tt?"touchstart mousedown":"mousedown",gn={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},vn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},yn=O.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){d(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Ie(this._dragStartTarget,mn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(yn._dragging===this&&this.finishDrag(),Ne(this._dragStartTarget,mn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!fe(this._element,"leaflet-zoom-anim")&&!(yn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(yn._dragging=this,this._preventOutline&&Me(this._element),ke(),Jt(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,n=Le(this._element);this._startPoint=new I(e.clientX,e.clientY),this._parentScale=Pe(n),Ie(document,vn[t.type],this._onMove,this),Ie(document,gn[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new I(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,qe(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Ce(this._element).subtract(n),_e(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),_e(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,k(this._animRequest),this._lastEvent=t,this._animRequest=A(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Te(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in me(document.body,"leaflet-dragging"),this._lastTarget&&(me(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),vn)Ne(document,vn[t],this._onMove,this),Ne(document,gn[t],this._onUp,this);Se(),te(),this._moved&&this._moving&&(k(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,yn._dragging=!1}});function wn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=Tn(t=An(t,n),n)}function bn(t,e,n){return Math.sqrt(Ln(t,e,n,!0))}function xn(t,e,n){return Ln(t,e,n)}function Tn(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,Cn(t,i,e,0,n-1);var s,o=[];for(s=0;s<n;s++)i[s]&&o.push(t[s]);return o}function Cn(t,e,n,i,s){var o,r,a,l=0;for(r=i+1;r<=s-1;r++)(a=Ln(t[r],t[i],t[s],!0))>l&&(o=r,l=a);l>n&&(e[o]=1,Cn(t,e,n,i,o),Cn(t,e,n,o,s))}function An(t,e){for(var n=[t[0]],i=1,s=0,o=t.length;i<o;i++)En(t[i],t[s])>e&&(n.push(t[i]),s=i);return s<o-1&&n.push(t[o-1]),n}function kn(t,e,n,i,s){var o,r,a,l=i?fn:Mn(t,n),h=Mn(e,n);for(fn=h;;){if(!(l|h))return[t,e];if(l&h)return!1;a=Mn(r=Sn(t,e,o=l||h,n,s),n),o===l?(t=r,l=a):(e=r,h=a)}}function Sn(t,e,n,i,s){var o,r,a=e.x-t.x,l=e.y-t.y,h=i.min,u=i.max;return 8&n?(o=t.x+a*(u.y-t.y)/l,r=u.y):4&n?(o=t.x+a*(h.y-t.y)/l,r=h.y):2&n?(o=u.x,r=t.y+l*(u.x-t.x)/a):1&n&&(o=h.x,r=t.y+l*(h.x-t.x)/a),new I(o,r,s)}function Mn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function En(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function Ln(t,e,n,i){var s,o=e.x,r=e.y,a=n.x-o,l=n.y-r,h=a*a+l*l;return h>0&&((s=((t.x-o)*a+(t.y-r)*l)/h)>1?(o=n.x,r=n.y):s>0&&(o+=a*s,r+=l*s)),a=t.x-o,l=t.y-r,i?a*a+l*l:new I(o,r)}function Pn(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function On(t){return Pn(t)}var In={simplify:wn,pointToSegmentDistance:bn,closestPointOnSegment:xn,clipSegment:kn,_getEdgeIntersection:Sn,_getBitCode:Mn,_sqClosestPointOnSegment:Ln,isFlat:Pn,_flat:On};function Dn(t,e,n){var i,s,o,r,a,l,h,u,c,p=[1,4,2,8];for(s=0,h=t.length;s<h;s++)t[s]._code=Mn(t[s],e);for(r=0;r<4;r++){for(u=p[r],i=[],s=0,o=(h=t.length)-1;s<h;o=s++)a=t[s],l=t[o],a._code&u?l._code&u||((c=Sn(l,a,u,e,n))._code=Mn(c,e),i.push(c)):(l._code&u&&((c=Sn(l,a,u,e,n))._code=Mn(c,e),i.push(c)),i.push(a));t=i}return t}var Nn={clipPolygon:Dn},Rn={project:function(t){return new I(t.lng,t.lat)},unproject:function(t){return new F(t.y,t.x)},bounds:new R([-180,-90],[180,90])},zn={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,s=this.R_MINOR/n,o=Math.sqrt(1-s*s),r=o*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-r)/(1+r),o/2);return i=-n*Math.log(Math.max(a,1e-10)),new I(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,s=this.R_MINOR/i,o=Math.sqrt(1-s*s),r=Math.exp(-t.y/i),a=Math.PI/2-2*Math.atan(r),l=0,h=.1;l<15&&Math.abs(h)>1e-7;l++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=h=Math.PI/2-2*Math.atan(r*e)-a;return new F(a*n,t.x*n/i)}},Bn={LonLat:Rn,Mercator:zn,SphericalMercator:U},Vn=n({},q,{code:"EPSG:3395",projection:zn,transformation:function(){var t=.5/(Math.PI*zn.R);return W(t,.5,-t,.5)}()}),Fn=n({},q,{code:"EPSG:4326",projection:Rn,transformation:W(1/180,1,-1/180,.5)}),Zn=n({},j,{projection:Rn,transformation:W(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});j.Earth=q,j.EPSG3395=Vn,j.EPSG3857=H,j.EPSG900913=X,j.EPSG4326=Fn,j.Simple=Zn;var jn=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});tn.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&r(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?g(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var s=this._zoomBoundLayers[i].options;t=void 0===s.minZoom?t:Math.min(t,s.minZoom),e=void 0===s.maxZoom?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var qn=jn.extend({initialize:function(t,e){var n,i;if(d(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),Gn=function(t,e){return new qn(t,e)},Un=qn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),qn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),qn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new B;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),$n=function(t,e){return new Un(t,e)},Wn=M.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var s=N(i),o=N("shadow"===e&&n.shadowAnchor||n.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return kt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Hn(t){return new Wn(t)}var Xn=Wn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Xn.imagePath||(Xn.imagePath=this._detectIconPath()),(this.options.imagePath||Xn.imagePath)+Wn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=he("div","leaflet-default-icon-path",document.body),e=le(t,"background-image")||le(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Yn=dn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new yn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),_e(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&me(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,o=Ce(e._icon),r=n.getPixelBounds(),a=n.getPixelOrigin(),l=z(r.min._subtract(a).add(s),r.max._subtract(a).subtract(s));if(!l.contains(o)){var h=N((Math.max(l.max.x,o.x)-l.max.x)/(r.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(r.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(r.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(r.min.y-l.min.y)).multiplyBy(i);n.panBy(h,{animate:!1}),this._draggable._newPos._add(h),this._draggable._startPos._add(h),Te(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=A(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(k(this._panRequest),this._panRequest=A(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=Ce(e._icon),s=e._map.layerPointToLatLng(i);n&&Te(n,i),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){k(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Kn=jn.extend({options:{icon:new Xn,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=Z(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=Z(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),_e(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=t.icon.createShadow(this._shadow),o=!1;s!==this._shadow&&(this._removeShadow(),o=!0),s&&(_e(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ue(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ue(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Te(this._icon,t),this._shadow&&Te(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(_e(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Yn)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Yn(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ye(this._icon,t),this._shadow&&ye(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Qn(t,e){return new Kn(t,e)}var Jn=jn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),ti=Jn.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=Z(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=Z(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Jn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new R(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ei(t,e){return new ti(t,e)}var ni=ti.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=n({},i,{radius:e})),d(this,e),this._latlng=Z(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new B(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Jn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===q.distance){var s=Math.PI/180,o=this._mRadius/q.R/s,r=n.project([e+o,t]),a=n.project([e-o,t]),l=r.add(a).divideBy(2),h=n.unproject(l).lat,u=Math.acos((Math.cos(o*s)-Math.sin(e*s)*Math.sin(h*s))/(Math.cos(e*s)*Math.cos(h*s)))/s;(isNaN(u)||0===u)&&(u=o/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([h,t-u]).x,this._radiusY=l.y-r.y}else{var c=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(c).x}this._updateBounds()}});function ii(t,e,n){return new ni(t,e,n)}var si=Jn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,s=null,o=Ln,r=0,a=this._parts.length;r<a;r++)for(var l=this._parts[r],h=1,u=l.length;h<u;h++){var c=o(t,e=l[h-1],n=l[h],!0);c<i&&(i=c,s=o(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,s,o,r,a=this._rings[0],l=a.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,i=0;t<l-1;t++)if(s=a[t],o=a[t+1],(i+=n=s.distanceTo(o))>e)return r=(i-e)/n,this._map.layerPointToLatLng([o.x-r*(o.x-s.x),o.y-r*(o.y-s.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=Z(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new B,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Pn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=Pn(t),i=0,s=t.length;i<s;i++)n?(e[i]=Z(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new I(t,t);this._pxBounds=new R([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,n){var i,s,o=t[0]instanceof F,r=t.length;if(o){for(s=[],i=0;i<r;i++)s[i]=this._map.latLngToLayerPoint(t[i]),n.extend(s[i]);e.push(s)}else for(i=0;i<r;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,s,o,r,a,l=this._parts;for(e=0,i=0,s=this._rings.length;e<s;e++)for(n=0,o=(a=this._rings[e]).length;n<o-1;n++)(r=kn(a[n],a[n+1],t,n,!0))&&(l[i]=l[i]||[],l[i].push(r[0]),r[1]===a[n+1]&&n!==o-2||(l[i].push(r[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=wn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,s,o,r,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(i=0,s=(r=(a=this._parts[n]).length)-1;i<r;s=i++)if((e||0!==i)&&bn(t,a[s],a[i])<=l)return!0;return!1}});function oi(t,e){return new si(t,e)}si._flat=On;var ri=si.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,s,o,r,a,l,h=this._rings[0],u=h.length;if(!u)return null;for(o=r=a=0,t=0,e=u-1;t<u;e=t++)n=h[t],i=h[e],s=n.y*i.x-i.y*n.x,r+=(n.x+i.x)*s,a+=(n.y+i.y)*s,o+=3*s;return l=0===o?h[0]:[r/o,a/o],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=si.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof F&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){si.prototype._setLatLngs.call(this,t),Pn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Pn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new I(e,e);if(t=new R(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,s=0,o=this._rings.length;s<o;s++)(i=Dn(this._rings[s],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,s,o,r,a,l,h=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(s=0,a=this._parts.length;s<a;s++)for(o=0,r=(l=(e=this._parts[s]).length)-1;o<l;r=o++)n=e[o],i=e[r],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(h=!h);return h||si.prototype._containsPoint.call(this,t,!0)}});function ai(t,e){return new ri(t,e)}var li=Un.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,s=g(t)?t:t.features;if(s){for(e=0,n=s.length;e<n;e++)((i=s[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var r=hi(t,o);return r?(r.feature=mi(t),r.defaultOptions=r.options,this.resetStyle(r),o.onEachFeature&&o.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function hi(t,e){var n,i,s,o,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,l=[],h=e&&e.pointToLayer,u=e&&e.coordsToLatLng||ci;if(!a&&!r)return null;switch(r.type){case"Point":return ui(h,t,n=u(a),e);case"MultiPoint":for(s=0,o=a.length;s<o;s++)n=u(a[s]),l.push(ui(h,t,n,e));return new Un(l);case"LineString":case"MultiLineString":return i=pi(a,"LineString"===r.type?0:1,u),new si(i,e);case"Polygon":case"MultiPolygon":return i=pi(a,"Polygon"===r.type?1:2,u),new ri(i,e);case"GeometryCollection":for(s=0,o=r.geometries.length;s<o;s++){var c=hi({geometry:r.geometries[s],type:"Feature",properties:t.properties},e);c&&l.push(c)}return new Un(l);default:throw new Error("Invalid GeoJSON object.")}}function ui(t,e,n,i){return t?t(e,n):new Kn(n,i&&i.markersInheritOptions&&i)}function ci(t){return new F(t[1],t[0],t[2])}function pi(t,e,n){for(var i,s=[],o=0,r=t.length;o<r;o++)i=e?pi(t[o],e-1,n):(n||ci)(t[o]),s.push(i);return s}function di(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[u(t.lng,e),u(t.lat,e),u(t.alt,e)]:[u(t.lng,e),u(t.lat,e)]}function fi(t,e,n,i){for(var s=[],o=0,r=t.length;o<r;o++)s.push(e?fi(t[o],e-1,n,i):di(t[o],i));return!e&&n&&s.push(s[0]),s}function _i(t,e){return t.feature?n({},t.feature,{geometry:e}):mi(e)}function mi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var gi={toGeoJSON:function(t){return _i(this,{type:"Point",coordinates:di(this.getLatLng(),t)})}};function vi(t,e){return new li(t,e)}Kn.include(gi),ni.include(gi),ti.include(gi),si.include({toGeoJSON:function(t){var e=!Pn(this._latlngs);return _i(this,{type:(e?"Multi":"")+"LineString",coordinates:fi(this._latlngs,e?1:0,!1,t)})}}),ri.include({toGeoJSON:function(t){var e=!Pn(this._latlngs),n=e&&!Pn(this._latlngs[0]),i=fi(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),_i(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),qn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),_i(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer((function(e){if(e.toGeoJSON){var s=e.toGeoJSON(t);if(n)i.push(s.geometry);else{var o=mi(s);"FeatureCollection"===o.type?i.push.apply(i,o.features):i.push(o)}}})),n?_i(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var yi=vi,wi=jn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=V(e),d(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(_e(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ue(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&pe(this._image),this},bringToBack:function(){return this._map&&de(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=V(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:he("img");_e(e,"leaflet-image-layer"),this._zoomAnimated&&_e(e,"leaflet-zoom-animated"),this.options.className&&_e(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onload=s(this.fire,this,"load"),e.onerror=s(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;xe(this._image,n,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();Te(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){ye(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),bi=function(t,e,n){return new wi(t,e,n)},xi=wi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:he("video");if(_e(e,"leaflet-image-layer"),this._zoomAnimated&&_e(e,"leaflet-zoom-animated"),this.options.className&&_e(e,this.options.className),e.onselectstart=h,e.onmousemove=h,e.onloadeddata=s(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),i=[],o=0;o<n.length;o++)i.push(n[o].src);this._url=n.length>0?i:[e.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted;for(var r=0;r<this._url.length;r++){var a=he("source");a.src=this._url[r],e.appendChild(a)}}}});function Ti(t,e,n){return new xi(t,e,n)}var Ci=wi.extend({_initImage:function(){var t=this._image=this._url;_e(t,"leaflet-image-layer"),this._zoomAnimated&&_e(t,"leaflet-zoom-animated"),this.options.className&&_e(t,this.options.className),t.onselectstart=h,t.onmousemove=h}});function Ai(t,e,n){return new Ci(t,e,n)}var ki=jn.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){d(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ye(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ye(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(ye(this._container,0),this._removeTimeout=setTimeout(s(ue,void 0,this._container),200)):ue(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=Z(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&pe(this._container),this},bringToBack:function(){return this._map&&de(this._container),this},_prepareOpen:function(t,e,n){if(e instanceof jn||(n=e,e=t),e instanceof Un)for(var i in t._layers){e=t._layers[i];break}if(!n)if(e.getCenter)n=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");n=e.getLatLng()}return this._source=e,this.update(),n},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=N(this.options.offset),n=this._getAnchor();this._zoomAnimated?Te(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}}),Si=ki.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){ki.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Jn||this._source.on("preclick",Fe))},onRemove:function(t){ki.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Jn||this._source.off("preclick",Fe))},getEvents:function(){var t=ki.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=he("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=he("div",t+"-content-wrapper",e);if(this._contentNode=he("div",t+"-content",n),je(e),Ze(this._contentNode),Ie(e,"contextmenu",Fe),this._tipContainer=he("div",t+"-tip-container",e),this._tip=he("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=he("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",Ie(i,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,s=this.options.maxHeight,o="leaflet-popup-scrolled";s&&i>s?(e.height=s+"px",_e(t,o)):me(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();Te(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(le(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,s=new I(this._containerLeft,-n-this._containerBottom);s._add(Ce(this._container));var o=t.layerPointToContainerPoint(s),r=N(this.options.autoPanPadding),a=N(this.options.autoPanPaddingTopLeft||r),l=N(this.options.autoPanPaddingBottomRight||r),h=t.getSize(),u=0,c=0;o.x+i+l.x>h.x&&(u=o.x+i-h.x+l.x),o.x-u-a.x<0&&(u=o.x-a.x),o.y+n+l.y>h.y&&(c=o.y+n-h.y+l.y),o.y-c-a.y<0&&(c=o.y-a.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),Ge(t)},_getAnchor:function(){return N(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Mi=function(t,e){return new Si(t,e)};tn.mergeOptions({closePopupOnClick:!0}),tn.include({openPopup:function(t,e,n){return t instanceof Si||(t=new Si(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),jn.include({bindPopup:function(t,e){return t instanceof Si?(d(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Si(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Ge(t),e instanceof Jn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Ei=ki.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){ki.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){ki.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=ki.prototype.getEvents.call(this);return Tt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=he("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,s=this._container,o=i.latLngToContainerPoint(i.getCenter()),r=i.layerPointToContainerPoint(t),a=this.options.direction,l=s.offsetWidth,h=s.offsetHeight,u=N(this.options.offset),c=this._getAnchor();"top"===a?(e=l/2,n=h):"bottom"===a?(e=l/2,n=0):"center"===a?(e=l/2,n=h/2):"right"===a?(e=0,n=h/2):"left"===a?(e=l,n=h/2):r.x<o.x?(a="right",e=0,n=h/2):(a="left",e=l+2*(u.x+c.x),n=h/2),t=t.subtract(N(e,n,!0)).add(u).add(c),me(s,"leaflet-tooltip-right"),me(s,"leaflet-tooltip-left"),me(s,"leaflet-tooltip-top"),me(s,"leaflet-tooltip-bottom"),_e(s,"leaflet-tooltip-"+a),Te(s,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ye(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return N(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Li=function(t,e){return new Ei(t,e)};tn.include({openTooltip:function(t,e,n){return t instanceof Ei||(t=new Ei(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),jn.include({bindTooltip:function(t,e){return t instanceof Ei?(d(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new Ei(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),Tt&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(_e(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(me(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Pi=Wn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(ce(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=N(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Oi(t){return new Pi(t)}Wn.Default=Xn;var Ii=jn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:vt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ue(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(pe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(de(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof I?t:new I(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),s=0,o=n.length;s<o;s++)e=n[s].style.zIndex,n[s]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt){ye(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var s=this._tiles[i];if(s.current&&s.loaded){var o=Math.min(1,(t-s.loaded)/200);ye(s.el,o),o<1?e=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(k(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=he("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(ue(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],s=this._map;return i||((i=this._levels[t]={}).el=he("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,s.getCenter(),s.getZoom()),h(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ue(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var s=Math.floor(t/2),o=Math.floor(e/2),r=n-1,a=new I(+s,+o);a.z=+r;var l=this._tileCoordsToKey(a),h=this._tiles[l];return h&&h.active?(h.retain=!0,!0):(h&&h.loaded&&(h.retain=!0),r>i&&this._retainParent(s,o,r,i))},_retainChildren:function(t,e,n,i){for(var s=2*t;s<2*t+2;s++)for(var o=2*e;o<2*e+2;o++){var r=new I(s,o);r.z=n+1;var a=this._tileCoordsToKey(r),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(s,o,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var s=Math.round(e);s=void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom?void 0:this._clampZoom(s);var o=this.options.updateWhenZooming&&s!==this._tileZoom;i&&!o||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),s=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();gt?xe(t.el,s,i):Te(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),s=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*i);return new R(s.subtract(o),s.add(o))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(i),o=s.getCenter(),r=[],a=this.options.keepBuffer,l=new R(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var h in this._tiles){var u=this._tiles[h].coords;u.z===this._tileZoom&&l.contains(new I(u.x,u.y))||(this._tiles[h].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var c=s.min.y;c<=s.max.y;c++)for(var p=s.min.x;p<=s.max.x;p++){var d=new I(p,c);if(d.z=this._tileZoom,this._isValidTile(d)){var f=this._tiles[this._tileCoordsToKey(d)];f?f.current=!0:r.push(d)}}if(r.sort((function(t,e){return t.distanceTo(o)-e.distanceTo(o)})),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var _=document.createDocumentFragment();for(p=0;p<r.length;p++)this._addTile(r[p],_);this._level.el.appendChild(_)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return V(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),s=i.add(n);return[e.unproject(i,t.z),e.unproject(s,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new B(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new I(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(ue(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){_e(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=h,t.onmousemove=h,tt&&this.options.opacity<1&&ye(t,this.options.opacity),it&&!st&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),i=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),s(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&A(s(this._tileReady,this,t,null,o)),Te(o,n),this._tiles[i]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var i=this._tileCoordsToKey(t);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(ye(n.el,0),k(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(_e(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt||!this._map._fadeAnimated?A(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new I(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Di(t){return new Ii(t)}var Ni=Ii.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=d(this,e)).detectRetina&&kt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),it||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Ie(n,"load",s(this._tileOnLoad,this,e,n)),Ie(n,"error",s(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:kt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return m(this._url,n(e,this.options))},_tileOnLoad:function(t,e){tt?setTimeout(s(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=h,e.onerror=h,e.complete||(e.src=y,ue(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return rt||e.el.setAttribute("src",y),Ii.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==y))return Ii.prototype._tileReady.call(this,t,e,n)}});function Ri(t,e){return new Ni(t,e)}var zi=Ni.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=n({},this.defaultWmsParams);for(var s in e)s in this.options||(i[s]=e[s]);var o=(e=d(this,e)).detectRetina&&kt?2:1,r=this.getTileSize();i.width=r.x*o,i.height=r.y*o,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Ni.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=z(n.project(e[0]),n.project(e[1])),s=i.min,o=i.max,r=(this._wmsVersion>=1.3&&this._crs===Fn?[s.y,s.x,o.y,o.x]:[s.x,s.y,o.x,o.y]).join(","),a=Ni.prototype.getTileUrl.call(this,t);return a+f(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});function Bi(t,e){return new zi(t,e)}Ni.WMS=zi,Ri.wms=Bi;var Vi=jn.extend({options:{padding:.1,tolerance:0},initialize:function(t){d(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&_e(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=Ce(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),r=this._map.project(t,e).subtract(o),a=s.multiplyBy(-n).add(i).add(s).subtract(r);gt?xe(this._container,a,n):Te(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Fi=Vi.extend({getEvents:function(){var t=Vi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Vi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ie(t,"mousemove",this._onMouseMove,this),Ie(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ie(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){k(this._redrawRequest),delete this._ctx,ue(this._container),Ne(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vi.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=kt?2:1;Te(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",kt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Vi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),s=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;s.push(e)}t.options._dashArray=s}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||A(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,s,o,r=t._parts,a=r.length,l=this._ctx;if(a){for(l.beginPath(),n=0;n<a;n++){for(i=0,s=r[n].length;i<s;i++)o=r[n][i],l[i?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),s=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==s&&(n.save(),n.scale(1,s)),n.beginPath(),n.arc(e.x,e.y/s,i,0,2*Math.PI,!1),1!==s&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"===t.type||!this._map._draggableMoved(e))&&(n=e);n&&(Xe(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(me(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,i,o=this._drawFirst;o;o=o.next)(n=o.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(_e(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(s((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function Zi(t){return Mt?new Fi(t):null}var ji=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),qi={_initContainer:function(){this._container=he("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Vi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=ji("shape");_e(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=ji("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ue(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,s=t._container;s.stroked=!!i.stroke,s.filled=!!i.fill,i.stroke?(e||(e=t._stroke=ji("stroke")),s.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=g(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(s.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=ji("fill")),s.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(s.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){pe(t._container)},_bringToBack:function(t){de(t._container)}},Gi=Lt?ji:Y,Ui=Vi.extend({getEvents:function(){var t=Vi.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=Gi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Gi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ue(this._container),Ne(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vi.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),Te(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Gi("path");t.options.className&&_e(e,t.options.className),t.options.interactive&&_e(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ue(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,K(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){pe(t._path)},_bringToBack:function(t){de(t._path)}});function $i(t){return Et||Lt?new Ui(t):null}Lt&&Ui.include(qi),tn.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Zi(t)||$i(t)}});var Wi=ri.extend({initialize:function(t,e){ri.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=V(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Hi(t,e){return new Wi(t,e)}Ui.create=Gi,Ui.pointsToPath=K,li.geometryToLayer=hi,li.coordsToLatLng=ci,li.coordsToLatLngs=pi,li.latLngToCoords=di,li.latLngsToCoords=fi,li.getFeature=_i,li.asFeature=mi,tn.mergeOptions({boxZoom:!0});var Xi=dn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ie(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ne(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ue(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Jt(),ke(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ie(document,{contextmenu:Ge,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=he("div","leaflet-zoom-box",this._container),_e(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),n=e.getSize();Te(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ue(this._box),me(this._container,"leaflet-crosshair")),te(),Se(),Ne(document,{contextmenu:Ge,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0);var e=new B(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});tn.addInitHook("addHandler","boxZoom",Xi),tn.mergeOptions({doubleClickZoom:!0});var Yi=dn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,s=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(s):e.setZoomAround(t.containerPoint,s)}});tn.addInitHook("addHandler","doubleClickZoom",Yi),tn.mergeOptions({dragging:!0,inertia:!st,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ki=dn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new yn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}_e(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){me(this._map._container,"leaflet-grab"),me(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=V(this._map.options.maxBounds);this._offsetLimit=z(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,s=(i-e+n)%t+e-n,o=(i+e+n)%t-e-n,r=Math.abs(s+n)<Math.abs(o+n)?s:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,r=n.easeLinearity,a=s.multiplyBy(r/o),l=a.distanceTo([0,0]),h=Math.min(n.inertiaMaxSpeed,l),u=a.multiplyBy(h/l),c=h/(n.inertiaDeceleration*r),p=u.multiplyBy(-c/2).round();p.x||p.y?(p=e._limitOffset(p,e.options.maxBounds),A((function(){e.panBy(p,{duration:c,easeLinearity:r,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});tn.addInitHook("addHandler","dragging",Ki),tn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Qi=dn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ie(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ne(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},s=this.keyCodes;for(e=0,n=s.left.length;e<n;e++)i[s.left[e]]=[-1*t,0];for(e=0,n=s.right.length;e<n;e++)i[s.right[e]]=[t,0];for(e=0,n=s.down.length;e<n;e++)i[s.down[e]]=[0,t];for(e=0,n=s.up.length;e<n;e++)i[s.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},s=this.keyCodes;for(e=0,n=s.zoomIn.length;e<n;e++)i[s.zoomIn[e]]=t;for(e=0,n=s.zoomOut.length;e<n;e++)i[s.zoomOut[e]]=-t},_addHooks:function(){Ie(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ne(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys)i._panAnim&&i._panAnim._inProgress||(e=this._panKeys[n],t.shiftKey&&(e=N(e).multiplyBy(3)),i.panBy(e),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds));else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Ge(t)}}});tn.addInitHook("addHandler","keyboard",Qi),tn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ji=dn.extend({addHooks:function(){Ie(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ne(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=We(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),i),Ge(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,o=n?Math.ceil(s/n)*n:s,r=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});tn.addInitHook("addHandler","scrollWheelZoom",Ji),tn.mergeOptions({tap:!0,tapTolerance:15});var ts=dn.extend({addHooks:function(){Ie(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ne(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(qe(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new I(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&_e(n,"leaflet-active"),this._holdTimeout=setTimeout(s((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Ie(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Ne(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&me(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new I(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});!Tt||xt&&!ut||tn.addInitHook("addHandler","tap",ts),tn.mergeOptions({touchZoom:Tt&&!st,bounceAtZoomLimits:!0});var es=dn.extend({addHooks:function(){_e(this._map._container,"leaflet-touch-zoom"),Ie(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){me(this._map._container,"leaflet-touch-zoom"),Ne(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ie(document,"touchmove",this._onTouchMove,this),Ie(document,"touchend",this._onTouchEnd,this),qe(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),k(this._animRequest);var a=s(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=A(a,this,!0),qe(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,k(this._animRequest),Ne(document,"touchmove",this._onTouchMove,this),Ne(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});tn.addInitHook("addHandler","touchZoom",es),tn.BoxZoom=Xi,tn.DoubleClickZoom=Yi,tn.Drag=Ki,tn.Keyboard=Qi,tn.ScrollWheelZoom=Ji,tn.Tap=ts,tn.TouchZoom=es,t.version=e,t.Control=nn,t.control=sn,t.Browser=Ot,t.Evented=O,t.Mixin=_n,t.Util=S,t.Class=M,t.Handler=dn,t.extend=n,t.bind=s,t.stamp=r,t.setOptions=d,t.DomEvent=Qe,t.DomUtil=Oe,t.PosAnimation=Je,t.Draggable=yn,t.LineUtil=In,t.PolyUtil=Nn,t.Point=I,t.point=N,t.Bounds=R,t.bounds=z,t.Transformation=$,t.transformation=W,t.Projection=Bn,t.LatLng=F,t.latLng=Z,t.LatLngBounds=B,t.latLngBounds=V,t.CRS=j,t.GeoJSON=li,t.geoJSON=vi,t.geoJson=yi,t.Layer=jn,t.LayerGroup=qn,t.layerGroup=Gn,t.FeatureGroup=Un,t.featureGroup=$n,t.ImageOverlay=wi,t.imageOverlay=bi,t.VideoOverlay=xi,t.videoOverlay=Ti,t.SVGOverlay=Ci,t.svgOverlay=Ai,t.DivOverlay=ki,t.Popup=Si,t.popup=Mi,t.Tooltip=Ei,t.tooltip=Li,t.Icon=Wn,t.icon=Hn,t.DivIcon=Pi,t.divIcon=Oi,t.Marker=Kn,t.marker=Qn,t.TileLayer=Ni,t.tileLayer=Ri,t.GridLayer=Ii,t.gridLayer=Di,t.SVG=Ui,t.svg=$i,t.Renderer=Vi,t.Canvas=Fi,t.canvas=Zi,t.Path=Jn,t.CircleMarker=ti,t.circleMarker=ei,t.Circle=ni,t.circle=ii,t.Polyline=si,t.polyline=oi,t.Polygon=ri,t.polygon=ai,t.Rectangle=Wi,t.rectangle=Hi,t.Map=tn,t.map=en;var ns=window.L;t.noConflict=function(){return window.L=ns,this},window.L=t}(e)})),E_=Un((function(t,e){!function(t){var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,n=this._zoom;if(t.__parent)for(;e.__parent._zoom>=n;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var n,i=this._featureGroup,s=this._nonPointGroup,o=this.options.chunkedLoading,r=this.options.chunkInterval,a=this.options.chunkProgress,l=t.length,h=0,u=!0;if(this._map){var c=(new Date).getTime(),p=L.bind((function(){var d=(new Date).getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();h<l&&!(o&&h%200==0&&(new Date).getTime()-d>r);h++)if((n=t[h])instanceof L.LayerGroup)u&&(t=t.slice(),u=!1),this._extractNonGroupLayers(n,t),l=t.length;else if(n.getLatLng){if(!this.hasLayer(n)&&(this._addLayer(n,this._maxZoom),e||this.fire("layeradd",{layer:n}),n.__parent&&2===n.__parent.getChildCount())){var f=n.__parent.getAllChildMarkers(),_=f[0]===n?f[1]:f[0];i.removeLayer(_)}}else s.addLayer(n),e||this.fire("layeradd",{layer:n});a&&a(h,l,(new Date).getTime()-c),h===l?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(p,this.options.chunkDelay)}),this);p()}else for(var d=this._needsClustering;h<l;h++)(n=t[h])instanceof L.LayerGroup?(u&&(t=t.slice(),u=!1),this._extractNonGroupLayers(n,t),l=t.length):n.getLatLng?this.hasLayer(n)||d.push(n):s.addLayer(n);return this},removeLayers:function(t){var e,n,i=t.length,s=this._featureGroup,o=this._nonPointGroup,r=!0;if(!this._map){for(e=0;e<i;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),i=t.length):(this._arraySplice(this._needsClustering,n),o.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push({layer:n,latlng:n._latlng}),this.fire("layerremove",{layer:n}));return this}if(this._unspiderfy){this._unspiderfy();var a=t.slice(),l=i;for(e=0;e<l;e++)(n=a[e])instanceof L.LayerGroup?(this._extractNonGroupLayers(n,a),l=a.length):this._unspiderfyLayer(n)}for(e=0;e<i;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),i=t.length):n.__parent?(this._removeLayer(n,!0,!0),this.fire("layerremove",{layer:n}),s.hasLayer(n)&&(s.removeLayer(n),n.clusterShow&&n.clusterShow())):(o.removeLayer(n),this.fire("layerremove",{layer:n}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer((function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent}),this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var n,i,s,o=this._needsClustering.slice(),r=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),i=o.length-1;i>=0;i--){for(n=!0,s=r.length-1;s>=0;s--)if(r[s].layer===o[i]){n=!1;break}n&&t.call(e,o[i])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer((function(e){t.push(e)})),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer((function(n){L.stamp(n)===t&&(e=n)})),e},hasLayer:function(t){if(!t)return!1;var e,n=this._needsClustering;for(e=n.length-1;e>=0;e--)if(n[e]===t)return!0;for(e=(n=this._needsRemoving).length-1;e>=0;e--)if(n[e].layer===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var n=this._map;"function"!=typeof e&&(e=function(){});var i=function(){!n.hasLayer(t)&&!n.hasLayer(t.__parent)||this._inZoomAnimation||(this._map.off("moveend",i,this),this.off("animationend",i,this),n.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",i,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),t.__parent.zoomToBounds())},onAdd:function(t){var e,n,i;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,n=this._needsRemoving.length;e<n;e++)(i=this._needsRemoving[e]).newlatlng=i.layer._latlng,i.layer._latlng=i.latlng;for(e=0,n=this._needsRemoving.length;e<n;e++)i=this._needsRemoving[e],this._removeLayer(i.layer,!0),i.layer._latlng=i.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return t.splice(n,1),!0},_removeFromGridUnclustered:function(t,e){for(var n=this._map,i=this._gridUnclustered,s=Math.floor(this._map.getMinZoom());e>=s&&i[e].removeObject(t,n.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,n){t._latlng=e,this.removeLayer(t),t._latlng=n,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,n){var i=this._gridClusters,s=this._gridUnclustered,o=this._featureGroup,r=this._map,a=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var l,h=t.__parent,u=h._markers;for(this._arraySplice(u,t);h&&(h._childCount--,h._boundsNeedUpdate=!0,!(h._zoom<a));)e&&h._childCount<=1?(l=h._markers[0]===t?h._markers[1]:h._markers[0],i[h._zoom].removeObject(h,r.project(h._cLatLng,h._zoom)),s[h._zoom].addObject(l,r.project(l.getLatLng(),h._zoom)),this._arraySplice(h.__parent._childClusters,h),h.__parent._markers.push(l),l.__parent=h.__parent,h._icon&&(o.removeLayer(h),n||o.addLayer(l))):h._iconNeedsUpdate=!0,h=h.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,n){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,n)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),n=" marker-cluster-";return n+=e<10?"small":e<100?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+n,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,n=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,s=this.options.spiderfyOnEveryZoom;(e||i||s)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,n=e;if("clusterkeypress"!==t.type||!t.originalEvent||13===t.originalEvent.keyCode){for(;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&13===t.originalEvent.keyCode&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,i=this.options.spiderfyOnEveryZoom,s=this._map;(t||n||i)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),s.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),n=this.options.maxClusterRadius,i=n;"function"!=typeof n&&(i=function(){return n}),null!==this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var s=t;s>=e;s--)this._gridClusters[s]=new L.DistanceGrid(i(s)),this._gridUnclustered[s]=new L.DistanceGrid(i(s));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var n,i,s=this._gridClusters,o=this._gridUnclustered,r=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=r;e--){n=this._map.project(t.getLatLng(),e);var a=s[e].getNearObject(n);if(a)return a._addChild(t),void(t.__parent=a);if(a=o[e].getNearObject(n)){var l=a.__parent;l&&this._removeLayer(a,!1);var h=new this._markerCluster(this,e,a,t);s[e].addObject(h,this._map.project(h._cLatLng,e)),a.__parent=h,t.__parent=h;var u=h;for(i=e-1;i>l._zoom;i--)u=new this._markerCluster(this,i,u),s[i].addObject(u,this._map.project(a.getLatLng(),i));return l._addChild(u),void this._removeFromGridUnclustered(a,e)}o[e].addObject(t,n)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer((function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}))},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(t){var e=this._maxLat;return void 0!==e&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var n=e.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var n,i=t.getLayers(),s=0;for(e=e||[];s<i.length;s++)(n=i[s])instanceof L.LayerGroup?this._extractNonGroupLayers(n,e):e.push(n);return e},_overrideMarkerIcon:function(t){return t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var n,i=this._getExpandedVisibleBounds(),s=this._featureGroup,o=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(i,t,o,(function(o){var r,a=o._latlng,l=o._markers;for(i.contains(a)||(a=null),o._isSingleParent()&&t+1===e?(s.removeLayer(o),o._recursivelyAddChildrenToMap(null,e,i)):(o.clusterHide(),o._recursivelyAddChildrenToMap(a,e,i)),n=l.length-1;n>=0;n--)r=l[n],i.contains(r._latlng)||s.removeLayer(r)})),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,e),s.eachLayer((function(t){t instanceof L.MarkerCluster||!t._icon||t.clusterShow()})),this._topClusterLevel._recursively(i,t,e,(function(t){t._recursivelyRestoreChildPositions(e)})),this._ignoreMove=!1,this._enqueue((function(){this._topClusterLevel._recursively(i,t,o,(function(t){s.removeLayer(t),t.clusterShow()})),this._animationEnd()}))},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var n=this,i=this._featureGroup;i.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue((function(){i.removeLayer(t),t.clusterShow(),n._animationEnd()}))):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,n){var i=this._getExpandedVisibleBounds(),s=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(i,s,e+1,n);var o=this;this._forceLayout(),t._recursivelyBecomeVisible(i,n),this._enqueue((function(){if(1===t._childCount){var r=t._markers[0];this._ignoreMove=!0,r.setLatLng(r.getLatLng()),this._ignoreMove=!1,r.clusterShow&&r.clusterShow()}else t._recursively(i,n,s,(function(t){t._recursivelyRemoveChildrenFromMap(i,s,e+1)}));o._animationEnd()}))},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var n=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,n,i){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),i&&this._addChild(i)},getAllChildMarkers:function(t,e){t=t||[];for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n].getAllChildMarkers(t,e);for(var i=this._markers.length-1;i>=0;i--)e&&this._markers[i].__dragStart||t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e,n=this._childClusters.slice(),i=this._group._map,s=i.getBoundsZoom(this._bounds),o=this._zoom+1,r=i.getZoom();n.length>0&&s>o;){o++;var a=[];for(e=0;e<n.length;e++)a=a.concat(n[e]._childClusters);n=a}s>o?this._group._map.setView(this._latlng,o):s<=r?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t,e,n,i,s=this._markers,o=this._childClusters,r=0,a=0,l=this._childCount;if(0!==l){for(this._resetBounds(),t=0;t<s.length;t++)n=s[t]._latlng,this._bounds.extend(n),r+=n.lat,a+=n.lng;for(t=0;t<o.length;t++)(e=o[t])._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),n=e._wLatLng,i=e._childCount,r+=n.lat*i,a+=n.lng*i;this._latlng=this._wLatLng=new L.LatLng(r/l,a/l),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,n){this._recursively(t,this._group._map.getMinZoom(),n-1,(function(t){var n,i,s=t._markers;for(n=s.length-1;n>=0;n--)(i=s[n])._icon&&(i._setPos(e),i.clusterHide())}),(function(t){var n,i,s=t._childClusters;for(n=s.length-1;n>=0;n--)(i=s[n])._icon&&(i._setPos(e),i.clusterHide())}))},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,n,i){this._recursively(t,i,e,(function(s){s._recursivelyAnimateChildrenIn(t,s._group._map.latLngToLayerPoint(s.getLatLng()).round(),n),s._isSingleParent()&&n-1===i?(s.clusterShow(),s._recursivelyRemoveChildrenFromMap(t,e,n)):s.clusterHide(),s._addToMap()}))},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,(function(t){t.clusterShow()}))},_recursivelyAddChildrenToMap:function(t,e,n){this._recursively(n,this._group._map.getMinZoom()-1,e,(function(i){if(e!==i._zoom)for(var s=i._markers.length-1;s>=0;s--){var o=i._markers[s];n.contains(o._latlng)&&(t&&(o._backupLatlng=o.getLatLng(),o.setLatLng(t),o.clusterHide&&o.clusterHide()),i._group._featureGroup.addLayer(o))}}),(function(e){e._addToMap(t)}))},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var n=this._markers[e];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(t-1===this._zoom)for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._restorePosition();else for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,n,i){var s,o;this._recursively(t,e-1,n-1,(function(t){for(o=t._markers.length-1;o>=0;o--)s=t._markers[o],i&&i.contains(s._latlng)||(t._group._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow())}),(function(t){for(o=t._childClusters.length-1;o>=0;o--)s=t._childClusters[o],i&&i.contains(s._latlng)||(t._group._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow())}))},_recursively:function(t,e,n,i,s){var o,r,a=this._childClusters,l=this._zoom;if(e<=l&&(i&&i(this),s&&l===n&&s(this)),l<e||l<n)for(o=a.length-1;o>=0;o--)(r=a[o])._boundsNeedUpdate&&r._recalculateBounds(),t.intersects(r._bounds)&&r._recursively(t,e,n,i,s)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var n=this._getCoord(e.x),i=this._getCoord(e.y),s=this._grid,o=s[i]=s[i]||{},r=o[n]=o[n]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,r.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var n,i,s=this._getCoord(e.x),o=this._getCoord(e.y),r=this._grid,a=r[o]=r[o]||{},l=a[s]=a[s]||[];for(delete this._objectPoint[L.Util.stamp(t)],n=0,i=l.length;n<i;n++)if(l[n]===t)return l.splice(n,1),1===i&&delete a[s],!0},eachObject:function(t,e){var n,i,s,o,r,a,l=this._grid;for(n in l)for(i in r=l[n])for(s=0,o=(a=r[i]).length;s<o;s++)t.call(e,a[s])&&(s--,o--)},getNearObject:function(t){var e,n,i,s,o,r,a,l,h=this._getCoord(t.x),u=this._getCoord(t.y),c=this._objectPoint,p=this._sqCellSize,d=null;for(e=u-1;e<=u+1;e++)if(s=this._grid[e])for(n=h-1;n<=h+1;n++)if(o=s[n])for(i=0,r=o.length;i<r;i++)a=o[i],((l=this._sqDist(c[L.Util.stamp(a)],t))<p||l<=p&&null===d)&&(p=l,d=a);return d},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}},L.QuickHull={getDistant:function(t,e){var n=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+n*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var n,i,s,o=0,r=null,a=[];for(n=e.length-1;n>=0;n--)i=e[n],(s=this.getDistant(i,t))>0&&(a.push(i),s>o&&(o=s,r=i));return{maxPoint:r,newPoints:a}},buildConvexHull:function(t,e){var n=[],i=this.findMostDistantPointFromBaseLine(t,e);return i.maxPoint?n=(n=n.concat(this.buildConvexHull([t[0],i.maxPoint],i.newPoints))).concat(this.buildConvexHull([i.maxPoint,t[1]],i.newPoints)):[t[0]]},getConvexHull:function(t){var e,n=!1,i=!1,s=!1,o=!1,r=null,a=null,l=null,h=null,u=null,c=null;for(e=t.length-1;e>=0;e--){var p=t[e];(!1===n||p.lat>n)&&(r=p,n=p.lat),(!1===i||p.lat<i)&&(a=p,i=p.lat),(!1===s||p.lng>s)&&(l=p,s=p.lng),(!1===o||p.lng<o)&&(h=p,o=p.lng)}return i!==n?(c=a,u=r):(c=h,u=l),[].concat(this.buildConvexHull([c,u],t),this.buildConvexHull([u,c],t))}},L.MarkerCluster.include({getConvexHull:function(){var t,e,n=this.getAllChildMarkers(),i=[];for(e=n.length-1;e>=0;e--)t=n[e].getLatLng(),i.push(t);return L.QuickHull.getConvexHull(i)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(null,!0),n=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?t=this._group.options.spiderfyShapePositions(e.length,n):e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,n):(n.y+=10,t=this._generatePointsCircle(e.length,n)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var n,i,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,o=this._2PI/t,r=[];for(s=Math.max(s,35),r.length=t,n=0;n<t;n++)i=this._circleStartAngle+n*o,r[n]=new L.Point(e.x+s*Math.cos(i),e.y+s*Math.sin(i))._round();return r},_generatePointsSpiral:function(t,e){var n,i=this._group.options.spiderfyDistanceMultiplier,s=i*this._spiralLengthStart,o=i*this._spiralFootSeparation,r=i*this._spiralLengthFactor*this._2PI,a=0,l=[];for(l.length=t,n=t;n>=0;n--)n<t&&(l[n]=new L.Point(e.x+s*Math.cos(a),e.y+s*Math.sin(a))._round()),s+=r/(a+=o/s+5e-4*n);return l},_noanimationUnspiderfy:function(){var t,e,n=this._group,i=n._map,s=n._featureGroup,o=this.getAllChildMarkers(null,!0);for(n._ignoreMove=!0,this.setOpacity(1),e=o.length-1;e>=0;e--)t=o[e],s.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(i.removeLayer(t._spiderLeg),delete t._spiderLeg);n.fire("unspiderfied",{cluster:this,markers:o}),n._ignoreMove=!1,n._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var n,i,s,o,r=this._group,a=r._map,l=r._featureGroup,h=this._group.options.spiderLegPolylineOptions;for(r._ignoreMove=!0,n=0;n<t.length;n++)o=a.layerPointToLatLng(e[n]),i=t[n],s=new L.Polyline([this._latlng,o],h),a.addLayer(s),i._spiderLeg=s,i._preSpiderfyLatlng=i._latlng,i.setLatLng(o),i.setZIndexOffset&&i.setZIndexOffset(1e6),l.addLayer(i);this.setOpacity(.3),r._ignoreMove=!1,r.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var n,i,s,o,r,a,l=this,h=this._group,u=h._map,c=h._featureGroup,p=this._latlng,d=u.latLngToLayerPoint(p),f=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),m=_.opacity;for(void 0===m&&(m=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),f?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=m,h._ignoreMove=!0,n=0;n<t.length;n++)i=t[n],a=u.layerPointToLatLng(e[n]),s=new L.Polyline([p,a],_),u.addLayer(s),i._spiderLeg=s,f&&(r=(o=s._path).getTotalLength()+.1,o.style.strokeDasharray=r,o.style.strokeDashoffset=r),i.setZIndexOffset&&i.setZIndexOffset(1e6),i.clusterHide&&i.clusterHide(),c.addLayer(i),i._setPos&&i._setPos(d);for(h._forceLayout(),h._animationStart(),n=t.length-1;n>=0;n--)a=u.layerPointToLatLng(e[n]),(i=t[n])._preSpiderfyLatlng=i._latlng,i.setLatLng(a),i.clusterShow&&i.clusterShow(),f&&((o=(s=i._spiderLeg)._path).style.strokeDashoffset=0,s.setStyle({opacity:m}));this.setOpacity(.3),h._ignoreMove=!1,setTimeout((function(){h._animationEnd(),h.fire("spiderfied",{cluster:l,markers:t})}),200)},_animationUnspiderfy:function(t){var e,n,i,s,o,r,a=this,l=this._group,h=l._map,u=l._featureGroup,c=t?h._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):h.latLngToLayerPoint(this._latlng),p=this.getAllChildMarkers(null,!0),d=L.Path.SVG;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),n=p.length-1;n>=0;n--)(e=p[n])._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,r=!0,e._setPos&&(e._setPos(c),r=!1),e.clusterHide&&(e.clusterHide(),r=!1),r&&u.removeLayer(e),d&&(o=(s=(i=e._spiderLeg)._path).getTotalLength()+.1,s.style.strokeDashoffset=o,i.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout((function(){var t=0;for(n=p.length-1;n>=0;n--)(e=p[n])._spiderLeg&&t++;for(n=p.length-1;n>=0;n--)(e=p[n])._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),t>1&&u.removeLayer(e),h.removeLayer(e._spiderLeg),delete e._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:a,markers:p})}),200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,n;for(e in t)for(n=t[e].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,n;for(e in t)n=t[e],this.hasLayer(n)&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(t,e){var n=this.options.icon;return L.setOptions(n,t),this.setIcon(n),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),t.MarkerClusterGroup=e,t.MarkerCluster=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)})),L_=Gn(E_);function P_(e){let n,i,s,o,r;return{c(){n=A("link"),i=A("link"),s=A("link"),o=M(),r=A("div"),P(n,"rel","stylesheet"),P(n,"href","https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"),P(n,"integrity","sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="),P(n,"crossorigin",""),P(i,"rel","stylesheet"),P(i,"href","https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css"),P(i,"crossorigin",""),P(s,"rel","stylesheet"),P(s,"href","https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css"),P(s,"crossorigin",""),P(r,"id","map"),P(r,"class","svelte-dvd1cb")},m(t,e){y(document.head,n),y(document.head,i),y(document.head,s),x(t,o,e),x(t,r,e)},p:t,i:t,o:t,d(t){T(n),T(i),T(s),t&&T(o),t&&T(r)}}}const O_=30;function I_(t){return t<6?80:1}function D_(t,e,n){let i,s,o,r;c(t,Gf,(t=>n(2,i=t))),c(t,qf,(t=>n(3,s=t))),c(t,Ff,(t=>n(9,o=t))),c(t,Uf,(t=>n(10,r=t)));let a=null;const l=[.5,1];let h,u,p,f,_,m,g=[];return q((()=>{n(0,h=M_.map("map",{zoomControl:!1,zoomAnimation:!0}).setView([51.505,-.09],3)),d(Uf,r=h,r),M_.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',updateWhenZooming:!1}).addTo(h),new M_.Control.Zoom({position:"bottomright"}).addTo(h),p=M_.divIcon({html:' <svg width="30" height="30" version="1.1" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg">\n  <path d="m26.551 1.2067-11.722 26.703-11.838-26.705z" fill="#5790db" stroke="#000" stroke-linecap="square"/>\n</svg>\n',iconSize:[O_,O_],className:"",iconAnchor:[O_*l[0],O_*l[1]]}),f=M_.divIcon({html:'<svg width="30" height="30" version="1.1" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg">\n  <path d="m26.551 1.2067-11.722 26.703-11.838-26.705z" fill="#e99c0e" stroke="#000" stroke-linecap="square"/>\n</svg>',iconSize:[O_,O_],className:"",iconAnchor:[O_*l[0],O_*l[1]]}),n(1,m=M_.divIcon({html:'<svg id="pin-example" width="30" height="30" version="1.1" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg">\n  <path d="m26.551 1.2067-11.722 26.703-11.838-26.705z" fill="transparent" stroke="transparent" stroke-linecap="square"/>\n</svg>',iconSize:[O_,O_],className:"",iconAnchor:[O_*l[0],O_*l[1]]})),_=M_.divIcon({html:'<svg id="pin-example" width="30" height="30" version="1.1" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg">\n  <path d="m26.551 1.2067-11.722 26.703-11.838-26.705z" fill="#1b487eff" stroke="#000" stroke-linecap="square"/>\n</svg>',iconSize:[O_,O_],className:"",iconAnchor:[O_*l[0],O_*l[1]]})})),t.$$.update=()=>{if(15&t.$$.dirty&&i&&s&&h){h.setView([i.info.lat,i.info.lon],3,{animate:!1}),e=s,r=i.info.index,u=new L_.MarkerClusterGroup({maxClusterRadius:I_,showCoverageOnHover:!1}),e.forEach(((t,e)=>{let i=M_.marker([t.info.lat,t.info.lon],{icon:p});g.push(i),i.on("click",(n=>{if(e!==a){if(null!==a){let t=p;s[a].info.has_been_selected&&(t=_),g[a].setIcon(t)}a=e,i.setIcon(f),t.info.has_been_selected=!0,d(Ff,o=t,o),u.removeLayer(i),i.addTo(h)}})),r===e&&n(0,h.$example_pin={marker:i,icon_default:p,icon_selected:f},h),u.addLayer(i)})),h.addLayer(u);M_.marker([i.info.lat,i.info.lon],{icon:m}).addTo(h)._icon.id="pin-example"}var e,r},[h,m,i,s]}class N_ extends mt{constructor(t){super(),_t(this,t,D_,P_,r,{})}}function R_(e){let n,i,s,o,r,a,h,u,c,p,d,f,_,m,g,v,w,b,C,k,E,L,O,D,N,R,z,B,V,F,Z,j,q,G,U,$,W,H,X,Y,K,Q,J=e[0]("app_credits.funding.1")+"",tt=e[0]("app_credits.funding.2")+"",et=e[0]("app_credits.data.1")+"",nt=e[0]("app_credits.data.2")+"",it=e[0]("app_credits.samples")+"",st=e[0]("app_credits.designed.1")+"",ot=e[0]("app_credits.designed.2")+"",rt=e[0]("app_credits.coded")+"",at=e[0]("app_credits.source")+"";return{c(){n=A("div"),i=A("div"),s=A("div"),o=A("p"),r=S(J),a=M(),h=A("a"),u=S(tt),c=M(),p=A("img"),f=M(),_=A("div"),m=S(et),g=M(),v=A("a"),w=S(nt),b=M(),C=A("div"),k=A("div"),E=S(it),L=M(),O=A("a"),O.textContent="http://theremin.music.uiowa.edu/",D=M(),N=A("div"),R=A("div"),z=S(st),B=S("\r\n      Ivan Horner\r\n      "),V=S(ot),F=M(),Z=A("a"),Z.textContent="Benjamin Renard",j=M(),q=A("div"),G=S(rt),U=M(),$=A("a"),$.textContent="Ivan Horner (ihdev.fr)",W=S(" ; "),H=S(at),X=M(),Y=A("a"),Y.textContent="Github",K=M(),Q=A("div"),P(h,"href","https://cordis.europa.eu/project/id/835496"),P(h,"target","_blank"),P(o,"class","svelte-10m5pj1"),l(p.src,d="./images/eu_icon.svg")||P(p,"src","./images/eu_icon.svg"),P(p,"alt","European Union Logo"),P(p,"height","100"),P(s,"class","funding svelte-10m5pj1"),P(v,"href","https://doi.org/10.1594/PANGAEA.887470"),P(v,"target","_blank"),P(_,"class","data svelte-10m5pj1"),P(i,"class","block svelte-10m5pj1"),P(O,"href","http://theremin.music.uiowa.edu/"),P(O,"target","_blank"),P(k,"class","materials svelte-10m5pj1"),P(C,"class","block svelte-10m5pj1"),P(Z,"href","https://globxblog.inrae.fr/"),P(Z,"target","_blank"),P(R,"class","designed svelte-10m5pj1"),P($,"href","https://ihdev.fr"),P($,"target","_blank"),P(Y,"href","https://github.com/IvanHeriver/HydrologicalSoundscapes"),P(q,"class","coded svelte-10m5pj1"),P(Q,"class","source svelte-10m5pj1"),P(N,"class","block svelte-10m5pj1"),P(n,"class","container svelte-10m5pj1")},m(t,e){x(t,n,e),y(n,i),y(i,s),y(s,o),y(o,r),y(o,a),y(o,h),y(h,u),y(s,c),y(s,p),y(i,f),y(i,_),y(_,m),y(_,g),y(_,v),y(v,w),y(n,b),y(n,C),y(C,k),y(k,E),y(k,L),y(k,O),y(n,D),y(n,N),y(N,R),y(R,z),y(R,B),y(R,V),y(R,F),y(R,Z),y(N,j),y(N,q),y(q,G),y(q,U),y(q,$),y(q,W),y(q,H),y(q,X),y(q,Y),y(N,K),y(N,Q)},p(t,[e]){1&e&&J!==(J=t[0]("app_credits.funding.1")+"")&&I(r,J),1&e&&tt!==(tt=t[0]("app_credits.funding.2")+"")&&I(u,tt),1&e&&et!==(et=t[0]("app_credits.data.1")+"")&&I(m,et),1&e&&nt!==(nt=t[0]("app_credits.data.2")+"")&&I(w,nt),1&e&&it!==(it=t[0]("app_credits.samples")+"")&&I(E,it),1&e&&st!==(st=t[0]("app_credits.designed.1")+"")&&I(z,st),1&e&&ot!==(ot=t[0]("app_credits.designed.2")+"")&&I(V,ot),1&e&&rt!==(rt=t[0]("app_credits.coded")+"")&&I(G,rt),1&e&&at!==(at=t[0]("app_credits.source")+"")&&I(H,at)},i:t,o:t,d(t){t&&T(n)}}}function z_(t,e,n){let i;return c(t,Vn,(t=>n(0,i=t))),[i]}class B_ extends mt{constructor(t){super(),_t(this,t,z_,R_,r,{})}}function V_(t){const e=t-1;return e*e*e+1}function F_(t,{delay:e=0,duration:n=400,easing:i=V_}={}){const s=getComputedStyle(t),o=+s.opacity,r=parseFloat(s.height),a=parseFloat(s.paddingTop),l=parseFloat(s.paddingBottom),h=parseFloat(s.marginTop),u=parseFloat(s.marginBottom),c=parseFloat(s.borderTopWidth),p=parseFloat(s.borderBottomWidth);return{delay:e,duration:n,easing:i,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*o};height: ${t*r}px;padding-top: ${t*a}px;padding-bottom: ${t*l}px;margin-top: ${t*h}px;margin-bottom: ${t*u}px;border-top-width: ${t*c}px;border-bottom-width: ${t*p}px;`}}function Z_(t){let e,n,i,s,o,r,a,h,u,c,p,d,f,_,m,g,v,w,b,C,k,L,O,D,N,R,z,B,V,F,Z=t[0]("title")+"",j=t[0]("app_description.label")+"",q=t[0]("app_description.tutorial_btn")+"",G=t[0]("app_credits.label")+"";return u=new C_({}),_=new y_({}),R=new B_({}),{c(){e=A("div"),n=A("div"),i=A("img"),o=M(),r=A("h2"),a=S(Z),h=M(),ct(u.$$.fragment),c=M(),p=A("h3"),d=S(j),f=M(),ct(_.$$.fragment),m=M(),g=A("div"),v=A("p"),w=M(),b=A("button"),C=S(q),L=M(),O=A("h3"),D=S(G),N=M(),ct(R.$$.fragment),l(i.src,s="/images/hydrosound_icon_96.png")||P(i,"src","/images/hydrosound_icon_96.png"),P(i,"alt","Hydrological soundscapes icon"),P(i,"class","svelte-1qu9qc5"),P(r,"class","svelte-1qu9qc5"),P(n,"class","header svelte-1qu9qc5"),P(p,"class","svelte-1qu9qc5"),b.disabled=k=!t[2],P(g,"class","tutorial"),P(O,"class","svelte-1qu9qc5"),P(e,"class","container svelte-1qu9qc5")},m(s,l){x(s,e,l),y(e,n),y(n,i),y(n,o),y(n,r),y(r,a),y(e,h),pt(u,e,null),y(e,c),y(e,p),y(p,d),y(e,f),pt(_,e,null),y(e,m),y(e,g),y(g,v),y(g,w),y(g,b),y(b,C),y(e,L),y(e,O),y(O,D),y(e,N),pt(R,e,null),B=!0,V||(F=E(b,"click",t[3]),V=!0)},p(t,[e]){(!B||1&e)&&Z!==(Z=t[0]("title")+"")&&I(a,Z),(!B||1&e)&&j!==(j=t[0]("app_description.label")+"")&&I(d,j),(!B||1&e)&&q!==(q=t[0]("app_description.tutorial_btn")+"")&&I(C,q),(!B||4&e&&k!==(k=!t[2]))&&(b.disabled=k),(!B||1&e)&&G!==(G=t[0]("app_credits.label")+"")&&I(D,G)},i(t){B||(at(u.$$.fragment,t),at(_.$$.fragment,t),at(R.$$.fragment,t),Y((()=>{z||(z=ut(e,F_,{},!0)),z.run(1)})),B=!0)},o(t){lt(u.$$.fragment,t),lt(_.$$.fragment,t),lt(R.$$.fragment,t),z||(z=ut(e,F_,{},!1)),z.run(0),B=!1},d(t){t&&T(e),dt(u),dt(_),dt(R),t&&z&&z.end(),V=!1,F()}}}function j_(t,e,n){let i,s,o;c(t,Vn,(t=>n(0,i=t))),c(t,Xf,(t=>n(1,s=t))),c(t,Kf,(t=>n(2,o=t)));return[i,s,o,()=>{d(Xf,s=!0,s)}]}class q_ extends mt{constructor(t){super(),_t(this,t,j_,Z_,r,{})}}function G_(t){let e,n,i,s,o,r,a,l,h,u,c,p,d,f,_,m,g,v,w,b,C,k,E,L,O,D,N,z,B,V,F,Z,j,q,G=(t[4]?t[4].info.label:"")+"",U=t[5]("charts.monthly_mean_flow")+"",$=t[5]("charts.monthly_max_flow")+"",W=t[5]("charts.monthly_min_flow")+"",H=t[5]("charts.average_flow")+"",X=t[5]("charts.select_station")+"";return{c(){e=A("div"),n=A("div"),i=A("div"),s=S(G),o=M(),r=A("div"),a=A("div"),l=A("label"),h=S(U),u=M(),c=A("div"),p=M(),d=A("div"),f=A("label"),_=S($),m=M(),g=A("div"),v=M(),w=A("div"),b=A("label"),C=S(W),k=M(),E=A("div"),L=M(),O=A("div"),D=A("label"),N=M(),z=A("div"),B=M(),V=A("div"),F=A("p"),Z=S(X),P(i,"class","header svelte-plggd1"),P(l,"for","mean"),P(l,"class","svelte-plggd1"),P(c,"id","mean"),P(c,"class","plot svelte-plggd1"),P(a,"class","mean svelte-plggd1"),P(f,"for","mean"),P(f,"class","svelte-plggd1"),P(g,"id","max"),P(g,"class","plot svelte-plggd1"),P(d,"class","max svelte-plggd1"),P(b,"for","mean"),P(b,"class","svelte-plggd1"),P(E,"id","min"),P(E,"class","plot svelte-plggd1"),P(w,"class","min svelte-plggd1"),P(D,"for","size"),P(D,"class","svelte-plggd1"),P(z,"id","size"),P(z,"class","plot svelte-plggd1"),P(O,"class","size svelte-plggd1"),P(r,"class","plots svelte-plggd1"),P(n,"class","data svelte-plggd1"),P(V,"class","no-data svelte-plggd1"),P(e,"class","container svelte-plggd1"),P(e,"id","plots-panel"),R(e,"station",!!t[4])},m(T,A){x(T,e,A),y(e,n),y(n,i),y(i,s),y(n,o),y(n,r),y(r,a),y(a,l),y(l,h),y(a,u),y(a,c),t[8](c),y(r,p),y(r,d),y(d,f),y(f,_),y(d,m),y(d,g),t[9](g),y(r,v),y(r,w),y(w,b),y(b,C),y(w,k),y(w,E),t[10](E),y(r,L),y(r,O),y(O,D),D.innerHTML=H,y(O,N),y(O,z),t[11](z),y(e,B),y(e,V),y(V,F),y(F,Z),q=!0},p(t,[n]){(!q||16&n)&&G!==(G=(t[4]?t[4].info.label:"")+"")&&I(s,G),(!q||32&n)&&U!==(U=t[5]("charts.monthly_mean_flow")+"")&&I(h,U),(!q||32&n)&&$!==($=t[5]("charts.monthly_max_flow")+"")&&I(_,$),(!q||32&n)&&W!==(W=t[5]("charts.monthly_min_flow")+"")&&I(C,W),(!q||32&n)&&H!==(H=t[5]("charts.average_flow")+"")&&(D.innerHTML=H),(!q||32&n)&&X!==(X=t[5]("charts.select_station")+"")&&I(Z,X),16&n&&R(e,"station",!!t[4])},i(t){q||(Y((()=>{j||(j=ut(e,F_,{},!0)),j.run(1)})),q=!0)},o(t){j||(j=ut(e,F_,{},!1)),j.run(0),q=!1},d(n){n&&T(e),t[8](null),t[9](null),t[10](null),t[11](null),n&&j&&j.end()}}}function U_(t,e,n){let i,s,o,r,a,l,h;c(t,jf,(t=>n(7,i=t))),c(t,Ff,(t=>n(4,s=t))),c(t,Vn,(t=>n(5,o=t)));let u=!1;return t.$$.update=()=>{223&t.$$.dirty&&(r&&l&&a&&h&&s&&i?u||(n(6,u=!0),r.append(i.meanMonthlyPS.plot),a.append(i.maxMonthlyPS.plot),l.append(i.minMonthlyPS.plot),h.append(i.sizePS.plot)):(n(6,u=!1),r&&n(0,r.innerHTML="",r),a&&n(1,a.innerHTML="",a),l&&n(2,l.innerHTML="",l),h&&n(3,h.innerHTML="",h)))},[r,a,l,h,s,o,u,i,function(t){U[t?"unshift":"push"]((()=>{r=t,n(0,r),n(2,l),n(1,a),n(3,h),n(4,s),n(7,i),n(6,u)}))},function(t){U[t?"unshift":"push"]((()=>{a=t,n(1,a),n(0,r),n(2,l),n(3,h),n(4,s),n(7,i),n(6,u)}))},function(t){U[t?"unshift":"push"]((()=>{l=t,n(2,l),n(0,r),n(1,a),n(3,h),n(4,s),n(7,i),n(6,u)}))},function(t){U[t?"unshift":"push"]((()=>{h=t,n(3,h),n(0,r),n(2,l),n(1,a),n(4,s),n(7,i),n(6,u)}))}]}class $_ extends mt{constructor(t){super(),_t(this,t,U_,G_,r,{})}}function W_(t,e,n){const i=t.slice();return i[13]=e[n],i}function H_(t,e,n){const i=t.slice();return i[16]=e[n],i}function X_(t){let e,n,i,s,o,r,a,l,h,u,c,p=t[0](`options.music_scales.${t[16].id}`)+"";return{c(){e=A("div"),n=A("input"),o=M(),r=A("label"),a=S(p),h=M(),P(n,"type","radio"),P(n,"name","arrangement"),P(n,"id",i=t[16].id),n.__value=s=t[16].id,n.value=n.__value,t[8][0].push(n),P(r,"for",l=t[16].id),P(e,"class","option")},m(i,s){x(i,e,s),y(e,n),n.checked=n.__value===t[1].arrangement,y(e,o),y(e,r),y(r,a),y(e,h),u||(c=E(n,"change",t[7]),u=!0)},p(t,e){2&e&&(n.checked=n.__value===t[1].arrangement),1&e&&p!==(p=t[0](`options.music_scales.${t[16].id}`)+"")&&I(a,p)},d(i){i&&T(e),t[8][0].splice(t[8][0].indexOf(n),1),u=!1,c()}}}function Y_(t){let e,n,i,s,o,r,a,l,h,u,c,p=t[0](`options.drum_pattern.${t[13].id}`)+"";return{c(){e=A("div"),n=A("input"),o=M(),r=A("label"),a=S(p),h=M(),P(n,"type","radio"),P(n,"name","drum-pattern"),P(n,"id",i=t[13].id),n.__value=s=t[13].id,n.value=n.__value,t[8][1].push(n),P(r,"for",l=t[13].id),P(e,"class","group svelte-1l8kqr5")},m(i,s){x(i,e,s),y(e,n),n.checked=n.__value===t[1].drum_pattern,y(e,o),y(e,r),y(r,a),y(e,h),u||(c=E(n,"change",t[9]),u=!0)},p(t,e){2&e&&(n.checked=n.__value===t[1].drum_pattern),1&e&&p!==(p=t[0](`options.drum_pattern.${t[13].id}`)+"")&&I(a,p)},d(i){i&&T(e),t[8][1].splice(t[8][1].indexOf(n),1),u=!1,c()}}}function K_(t){let e,n,i,o,r,a,l,h=`${t[0]("options.tempo.select")}: `;return{c(){e=A("label"),n=S(h),i=M(),o=A("div"),r=A("input"),P(e,"for","bpm"),P(r,"type","range"),P(r,"name","bpm"),P(r,"id","bpm"),P(r,"min","180"),P(r,"max","600"),P(r,"step","3"),P(r,"class","svelte-1l8kqr5"),P(o,"class","group svelte-1l8kqr5")},m(s,h){x(s,e,h),y(e,n),x(s,i,h),x(s,o,h),y(o,r),D(r,t[1].bpm),a||(l=[E(r,"change",t[11]),E(r,"input",t[11])],a=!0)},p(t,e){1&e&&h!==(h=`${t[0]("options.tempo.select")}: `)&&I(n,h),2&e&&D(r,t[1].bpm)},d(t){t&&T(e),t&&T(i),t&&T(o),a=!1,s(l)}}}function Q_(t){let e,n,i,o,r,a,l,h,u,c,p,d,f,_,m,g,v,w,b,k,L,O,N,R,z,B,V,F,Z,j,q,G,U,$,W,H,X,K,Q,J,tt,et,nt,it,st,ot,rt,at,lt,ht,ct,pt,dt,ft,_t,mt,gt,vt,yt,wt,bt,xt,Tt,Ct,At,kt,St,Mt,Et,Lt,Pt,Ot=`${t[0]("options.volume")}:`,It=`${t[0]("options.toggle_instruments.label")}: `,Dt=t[0]("options.toggle_instruments.piano")+"",Nt=t[0]("options.toggle_instruments.bass")+"",Rt=t[0]("options.toggle_instruments.hang")+"",zt=t[0]("options.toggle_instruments.drum")+"",Bt=t[0]("options.music_scales.label")+"",Vt=t[0]("options.drum_pattern.label")+"",Ft=`${t[0]("options.tempo.label")}: ${(t[1].bpm/3).toFixed(0)} bpm`,Zt=t[0]("options.tempo.mapped")+"",jt=t[0]("options.pitch_invert.1")+"",qt=t[0]("options.pitch_invert.2")+"",Gt=Sf,Ut=[];for(let e=0;e<Gt.length;e+=1)Ut[e]=X_(H_(t,Gt,e));let $t=Mf,Wt=[];for(let e=0;e<$t.length;e+=1)Wt[e]=Y_(W_(t,$t,e));let Ht=!t[1].bpm_auto&&K_(t);return{c(){e=A("div"),n=A("h2"),n.textContent="Options",i=M(),o=A("div"),r=A("label"),a=S(Ot),l=M(),h=A("input"),u=M(),c=A("label"),p=S(It),d=M(),f=A("div"),_=A("div"),m=A("input"),g=M(),v=A("label"),w=S(Dt),b=M(),k=A("div"),L=A("input"),O=M(),N=A("label"),R=S(Nt),z=M(),B=A("div"),V=A("input"),F=M(),Z=A("label"),j=S(Rt),q=M(),G=A("div"),U=A("input"),$=M(),W=A("label"),H=S(zt),X=M(),K=A("label"),Q=S(Bt),J=M(),tt=A("div");for(let t=0;t<Ut.length;t+=1)Ut[t].c();et=M(),nt=A("label"),it=S(Vt),st=M(),ot=A("div");for(let t=0;t<Wt.length;t+=1)Wt[t].c();rt=M(),at=A("label"),lt=S(Ft),ht=M(),ct=A("div"),pt=A("div"),dt=A("input"),ft=M(),_t=A("label"),mt=S(Zt),gt=M(),Ht&&Ht.c(),vt=M(),yt=A("label"),wt=S(jt),bt=M(),xt=A("div"),Tt=A("div"),Ct=A("input"),At=M(),kt=A("label"),St=S(qt),n.hidden=!0,P(r,"for","volume"),P(r,"class","main-label svelte-1l8kqr5"),P(h,"type","range"),P(h,"name","volume"),P(h,"id","volume"),P(h,"min","0"),P(h,"max","1"),P(h,"step","0.01"),P(h,"class","svelte-1l8kqr5"),P(c,"for","which"),P(c,"class","main-label svelte-1l8kqr5"),P(m,"type","checkbox"),P(m,"name","which-med"),P(m,"id","which-med"),P(v,"for","which-med"),P(_,"class","group svelte-1l8kqr5"),P(L,"type","checkbox"),P(L,"name","which-max"),P(L,"id","which-max"),P(N,"for","which-max"),P(k,"class","group svelte-1l8kqr5"),P(V,"type","checkbox"),P(V,"name","which-min"),P(V,"id","which-min"),P(Z,"for","which-min"),P(B,"class","group svelte-1l8kqr5"),P(U,"type","checkbox"),P(U,"name","which-drum"),P(U,"id","which-drum"),P(W,"for","which-drum"),P(G,"class","group svelte-1l8kqr5"),P(f,"class","section svelte-1l8kqr5"),P(f,"id","which"),P(K,"for","arrangement"),P(K,"class","main-label svelte-1l8kqr5"),P(tt,"class","section svelte-1l8kqr5"),P(tt,"id","arrangement"),P(nt,"for","drum"),P(nt,"class","main-label svelte-1l8kqr5"),P(ot,"class","section svelte-1l8kqr5"),P(ot,"id","drum"),P(at,"for","speed"),P(at,"class","main-label svelte-1l8kqr5"),P(dt,"type","checkbox"),P(dt,"name","bpm-auto"),P(dt,"id","bpm-auto"),P(_t,"for","bpm-auto"),P(pt,"class","group svelte-1l8kqr5"),P(ct,"class","section svelte-1l8kqr5"),P(ct,"id","speed"),P(yt,"for","pitch"),P(yt,"class","main-label svelte-1l8kqr5"),P(Ct,"type","checkbox"),P(Ct,"name","inverted-pitch"),P(Ct,"id","inverted-pitch"),P(kt,"for","inverted-pitch"),P(Tt,"class","group svelte-1l8kqr5"),P(xt,"class","section svelte-1l8kqr5"),P(xt,"id","pitch"),P(o,"class","options svelte-1l8kqr5"),P(e,"class","container svelte-1l8kqr5")},m(s,T){x(s,e,T),y(e,n),y(e,i),y(e,o),y(o,r),y(r,a),y(o,l),y(o,h),D(h,t[1].volume),y(o,u),y(o,c),y(c,p),y(o,d),y(o,f),y(f,_),y(_,m),m.checked=t[1].med,y(_,g),y(_,v),y(v,w),y(f,b),y(f,k),y(k,L),L.checked=t[1].max,y(k,O),y(k,N),y(N,R),y(f,z),y(f,B),y(B,V),V.checked=t[1].min,y(B,F),y(B,Z),y(Z,j),y(f,q),y(f,G),y(G,U),U.checked=t[1].drum,y(G,$),y(G,W),y(W,H),y(o,X),y(o,K),y(K,Q),y(o,J),y(o,tt);for(let t=0;t<Ut.length;t+=1)Ut[t].m(tt,null);y(o,et),y(o,nt),y(nt,it),y(o,st),y(o,ot);for(let t=0;t<Wt.length;t+=1)Wt[t].m(ot,null);y(o,rt),y(o,at),y(at,lt),y(o,ht),y(o,ct),y(ct,pt),y(pt,dt),dt.checked=t[1].bpm_auto,y(pt,ft),y(pt,_t),y(_t,mt),y(ct,gt),Ht&&Ht.m(ct,null),y(o,vt),y(o,yt),y(yt,wt),y(o,bt),y(o,xt),y(xt,Tt),y(Tt,Ct),Ct.checked=t[1].inverted_pitch,y(Tt,At),y(Tt,kt),y(kt,St),Et=!0,Lt||(Pt=[E(h,"change",t[2]),E(h,"input",t[2]),E(m,"change",t[3]),E(L,"change",t[4]),E(V,"change",t[5]),E(U,"change",t[6]),E(dt,"change",t[10]),E(Ct,"change",t[12])],Lt=!0)},p(t,[e]){if((!Et||1&e)&&Ot!==(Ot=`${t[0]("options.volume")}:`)&&I(a,Ot),2&e&&D(h,t[1].volume),(!Et||1&e)&&It!==(It=`${t[0]("options.toggle_instruments.label")}: `)&&I(p,It),2&e&&(m.checked=t[1].med),(!Et||1&e)&&Dt!==(Dt=t[0]("options.toggle_instruments.piano")+"")&&I(w,Dt),2&e&&(L.checked=t[1].max),(!Et||1&e)&&Nt!==(Nt=t[0]("options.toggle_instruments.bass")+"")&&I(R,Nt),2&e&&(V.checked=t[1].min),(!Et||1&e)&&Rt!==(Rt=t[0]("options.toggle_instruments.hang")+"")&&I(j,Rt),2&e&&(U.checked=t[1].drum),(!Et||1&e)&&zt!==(zt=t[0]("options.toggle_instruments.drum")+"")&&I(H,zt),(!Et||1&e)&&Bt!==(Bt=t[0]("options.music_scales.label")+"")&&I(Q,Bt),3&e){let n;for(Gt=Sf,n=0;n<Gt.length;n+=1){const i=H_(t,Gt,n);Ut[n]?Ut[n].p(i,e):(Ut[n]=X_(i),Ut[n].c(),Ut[n].m(tt,null))}for(;n<Ut.length;n+=1)Ut[n].d(1);Ut.length=Gt.length}if((!Et||1&e)&&Vt!==(Vt=t[0]("options.drum_pattern.label")+"")&&I(it,Vt),3&e){let n;for($t=Mf,n=0;n<$t.length;n+=1){const i=W_(t,$t,n);Wt[n]?Wt[n].p(i,e):(Wt[n]=Y_(i),Wt[n].c(),Wt[n].m(ot,null))}for(;n<Wt.length;n+=1)Wt[n].d(1);Wt.length=$t.length}(!Et||3&e)&&Ft!==(Ft=`${t[0]("options.tempo.label")}: ${(t[1].bpm/3).toFixed(0)} bpm`)&&I(lt,Ft),2&e&&(dt.checked=t[1].bpm_auto),(!Et||1&e)&&Zt!==(Zt=t[0]("options.tempo.mapped")+"")&&I(mt,Zt),t[1].bpm_auto?Ht&&(Ht.d(1),Ht=null):Ht?Ht.p(t,e):(Ht=K_(t),Ht.c(),Ht.m(ct,null)),(!Et||1&e)&&jt!==(jt=t[0]("options.pitch_invert.1")+"")&&I(wt,jt),2&e&&(Ct.checked=t[1].inverted_pitch),(!Et||1&e)&&qt!==(qt=t[0]("options.pitch_invert.2")+"")&&I(St,qt)},i(t){Et||(Y((()=>{Mt||(Mt=ut(e,F_,{},!0)),Mt.run(1)})),Et=!0)},o(t){Mt||(Mt=ut(e,F_,{},!1)),Mt.run(0),Et=!1},d(t){t&&T(e),C(Ut,t),C(Wt,t),Ht&&Ht.d(),t&&Mt&&Mt.end(),Lt=!1,s(Pt)}}}function J_(t,e,n){let i,s;c(t,Vn,(t=>n(0,i=t))),c(t,Zf,(t=>n(1,s=t)));return[i,s,function(){s.volume=O(this.value),Zf.set(s)},function(){s.med=this.checked,Zf.set(s)},function(){s.max=this.checked,Zf.set(s)},function(){s.min=this.checked,Zf.set(s)},function(){s.drum=this.checked,Zf.set(s)},function(){s.arrangement=this.__value,Zf.set(s)},[[],[]],function(){s.drum_pattern=this.__value,Zf.set(s)},function(){s.bpm_auto=this.checked,Zf.set(s)},function(){s.bpm=O(this.value),Zf.set(s)},function(){s.inverted_pitch=this.checked,Zf.set(s)}]}class tm extends mt{constructor(t){super(),_t(this,t,J_,Q_,r,{})}}function em(e){let n,i,s;return{c(){n=k("svg"),i=k("g"),s=k("path"),P(s,"d","m63.971 961.77 893.87-449.81-893.81-452.54z"),P(s,"stroke-width","100"),P(i,"class","svelte-13cuzww"),P(n,"width",sm),P(n,"height",sm),P(n,"version","1.1"),P(n,"viewBox","0 0 1024 1024"),P(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){x(t,n,e),y(n,i),y(i,s)},p:t,d(t){t&&T(n)}}}function nm(e){let n,i,s,o;return{c(){n=k("svg"),i=k("g"),s=k("path"),o=k("path"),P(s,"d","m299.85 62.593v901.48"),P(o,"d","m724.15 62.593v901.48"),P(i,"stroke-width","200"),P(i,"class","svelte-13cuzww"),P(n,"width",sm),P(n,"height",sm),P(n,"version","1.1"),P(n,"viewBox","0 0 1024 1024"),P(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){x(t,n,e),y(n,i),y(i,s),y(i,o)},p:t,d(t){t&&T(n)}}}function im(e){let n,i,o,r,a,l,h,u,c,d,f,_;function m(t,e){return t[0]?nm:em}let g=m(e),v=g(e);return{c(){n=A("div"),i=A("button"),v.c(),r=M(),a=A("button"),l=k("svg"),h=k("g"),u=k("path"),P(i,"class",o=p(e[0]?"active":"")+" svelte-13cuzww"),P(u,"d","m63.298 61.4h898.97v898.97h-898.97z"),P(u,"stroke-width","100"),P(h,"class","svelte-13cuzww"),P(l,"width",sm),P(l,"height",sm),P(l,"version","1.1"),P(l,"viewBox","0 0 1024 1024"),P(l,"xmlns","http://www.w3.org/2000/svg"),P(a,"class",c=p(e[1]?"active":"")+" svelte-13cuzww"),P(n,"class",d=p("controller"+(1===e[2]&&e[3]?"":" not-ready"))+" svelte-13cuzww"),P(n,"id","sound-controller")},m(t,s){x(t,n,s),y(n,i),v.m(i,null),y(n,r),y(n,a),y(a,l),y(l,h),y(h,u),f||(_=[E(i,"click",e[4]),E(a,"click",e[5])],f=!0)},p(t,[e]){g===(g=m(t))&&v?v.p(t,e):(v.d(1),v=g(t),v&&(v.c(),v.m(i,null))),1&e&&o!==(o=p(t[0]?"active":"")+" svelte-13cuzww")&&P(i,"class",o),2&e&&c!==(c=p(t[1]?"active":"")+" svelte-13cuzww")&&P(a,"class",c),12&e&&d!==(d=p("controller"+(1===t[2]&&t[3]?"":" not-ready"))+" svelte-13cuzww")&&P(n,"class",d)},i:t,o:t,d(t){t&&T(n),v.d(),f=!1,s(_)}}}let sm=20;function om(t,e,n){let i,s,o;c(t,jf,(t=>n(6,i=t))),c(t,Vf,(t=>n(2,s=t))),c(t,Ff,(t=>n(3,o=t)));let r=!1,a=!0;return[r,a,s,o,function(){r?function(){if(a)return;"started"===Fh.state&&Fh.pause("+0.05"),n(0,r=!1),n(1,a=!1)}():("started"!==Fh.state&&Fh.start("+0.05"),n(0,r=!0),n(1,a=!1))},function(){a||"stopped"!==Fh.state&&Fh.stop("+0.05"),n(0,r=!1),n(1,a=!0),i.meanMonthlyPS.plot.highlight(null),i.minMonthlyPS.plot.highlight(null),i.maxMonthlyPS.plot.highlight(null)}]}class rm extends mt{constructor(t){super(),_t(this,t,om,im,r,{})}}function am(t){let e,n,i,o,r,a,h,u,c,p,d,f,_,m,g,v,w,b,C,L,O,D,N,z,B,V,F,Z,j,q,G,U,$,W,H,X,Y,K,Q,J=t[0]("title")+"";return d=new rm({}),{c(){var s,y,x,T;e=A("div"),n=A("div"),i=A("div"),o=A("img"),a=M(),h=A("span"),u=S(J),c=M(),p=A("div"),ct(d.$$.fragment),f=M(),_=A("div"),m=A("button"),g=k("svg"),v=k("g"),w=k("path"),b=k("path"),C=k("path"),L=M(),O=A("button"),D=k("svg"),N=k("g"),z=k("path"),B=k("path"),V=k("path"),F=k("path"),Z=k("path"),j=k("path"),q=M(),G=A("button"),U=k("svg"),$=k("g"),W=k("path"),H=k("path"),X=k("path"),l(o.src,r="/images/hydrosound_icon_96.png")||P(o,"src","/images/hydrosound_icon_96.png"),P(o,"alt","Hydrological soundscapes icon"),P(o,"class","svelte-s5mfpz"),P(h,"class","svelte-s5mfpz"),P(i,"class","title svelte-s5mfpz"),P(i,"id","logo-title"),P(n,"class","left"),P(p,"class","center svelte-s5mfpz"),P(w,"d","m215.55 957.62v-521.97"),P(b,"d","m515.63 957.62v-886.91"),P(C,"d","m815.72 957.62v-659.53"),P(v,"stroke-width","250"),P(v,"class","svelte-s5mfpz"),R(v,"active",t[1]),P(g,"id","toggle-plots"),P(g,"width",lm),P(g,"height",lm),P(g,"version","1.1"),P(g,"viewBox","0 0 1024 1024"),P(g,"xmlns","http://www.w3.org/2000/svg"),P(m,"class","svelte-s5mfpz"),P(z,"d","m77.706 260.62h868.84"),P(B,"d","m371.72 264.66a56.569 56.569 0 0 1-56.569 56.569 56.569 56.569 0 0 1-56.569-56.569 56.569 56.569 0 0 1 56.569-56.569 56.569 56.569 0 0 1 56.569 56.569z"),P(V,"d","m77.706 509.12h868.84"),P(F,"d","m842.45 513.16a56.569 56.569 0 0 1-56.569 56.569 56.569 56.569 0 0 1-56.569-56.569 56.569 56.569 0 0 1 56.569-56.569 56.569 56.569 0 0 1 56.569 56.569z"),P(Z,"d","m77.706 757.61h868.84"),P(j,"d","m476.77 761.65a56.569 56.569 0 0 1-56.569 56.569 56.569 56.569 0 0 1-56.569-56.569 56.569 56.569 0 0 1 56.569-56.569 56.569 56.569 0 0 1 56.569 56.569z"),P(N,"stroke-width","100"),P(N,"stroke-linecap","round"),P(N,"class","svelte-s5mfpz"),R(N,"active",t[2]),P(D,"id","toggle-options"),P(D,"width",lm),P(D,"height",lm),P(D,"version","1.1"),P(D,"viewBox","0 0 1024 1024"),P(D,"xmlns","http://www.w3.org/2000/svg"),P(O,"class","svelte-s5mfpz"),P(W,"d","m617.19 249.88a86.737 86.737 0 0 1-86.737 86.737 86.737 86.737 0 0 1-86.737-86.737 86.737 86.737 0 0 1 86.737-86.737 86.737 86.737 0 0 1 86.737 86.737z"),P(H,"d","m338.6 442.16 8.0452-40.743s94.176-41.74 134.56-39.08c40.384 2.6608 94.407 18.712 106.64 71.175 9.1494 39.246-13.157 126.27-30.288 189.25-12.304 45.233-29.657 114.74-24.609 137.36 5.048 22.616 23.02 27.087 38.175 28.27 17.037 1.3304 67.832-13.636 67.832-13.636l-9.4649 42.239s-65.623 27.273-85.815 32.594c-20.192 5.3215-100.64 10.31-130.93-23.947-30.115-34.062-38.491-59.202-22.085-128.38 16.406-69.179 32.496-122.06 43.854-168.62 11.358-46.563 11.831-81.485-5.5212-92.794-16.973-11.061-36.598-9.4789-56.474-4.9889-12.883 2.9103-33.916 11.308-33.916 11.308z"),P(X,"d","m977.14 512.57a465.71 465.71 0 0 1-465.71 465.71 465.71 465.71 0 0 1-465.71-465.71 465.71 465.71 0 0 1 465.71-465.71 465.71 465.71 0 0 1 465.71 465.71z"),P(X,"fill","none"),P(X,"stroke-linecap","round"),P(X,"stroke-linejoin","round"),P(X,"stroke-width","64"),s=X,y="paint-order",null===(x="fill markers stroke")?s.style.removeProperty(y):s.style.setProperty(y,x,T?"important":""),P($,"class","svelte-s5mfpz"),R($,"active",t[3]),P(U,"id","toggle-about"),P(U,"width",lm),P(U,"height",lm),P(U,"version","1.1"),P(U,"viewBox","0 0 1024 1024"),P(U,"xmlns","http://www.w3.org/2000/svg"),P(G,"class","svelte-s5mfpz"),P(_,"class","right svelte-s5mfpz"),P(e,"class","container svelte-s5mfpz")},m(s,r){x(s,e,r),y(e,n),y(n,i),y(i,o),y(i,a),y(i,h),y(h,u),y(e,c),y(e,p),pt(d,p,null),y(e,f),y(e,_),y(_,m),y(m,g),y(g,v),y(v,w),y(v,b),y(v,C),y(_,L),y(_,O),y(O,D),y(D,N),y(N,z),y(N,B),y(N,V),y(N,F),y(N,Z),y(N,j),y(_,q),y(_,G),y(G,U),y(U,$),y($,W),y($,H),y($,X),Y=!0,K||(Q=[E(m,"click",t[4]),E(O,"click",t[5]),E(G,"click",t[6])],K=!0)},p(t,[e]){(!Y||1&e)&&J!==(J=t[0]("title")+"")&&I(u,J),2&e&&R(v,"active",t[1]),4&e&&R(N,"active",t[2]),8&e&&R($,"active",t[3])},i(t){Y||(at(d.$$.fragment,t),Y=!0)},o(t){lt(d.$$.fragment,t),Y=!1},d(t){t&&T(e),dt(d),K=!1,s(Q)}}}let lm=25;function hm(t,e,n){let i,s,o,r;c(t,Vn,(t=>n(0,i=t))),c(t,Wf,(t=>n(1,s=t))),c(t,$f,(t=>n(2,o=t))),c(t,Yf,(t=>n(3,r=t)));return[i,s,o,r,()=>d(Wf,s=!s,s),()=>d($f,o=!o,o),()=>d(Yf,r=!r,r)]}class um extends mt{constructor(t){super(),_t(this,t,hm,am,r,{})}}function cm(t){let e,n,i,s,o,r,a,l=`Loading sound sample files... ${(100*t[0]).toFixed(0)}%`;return{c(){e=A("div"),n=A("div"),i=A("div"),o=M(),r=A("div"),a=S(l),P(i,"class","progress svelte-19hzrvz"),P(i,"style",s=`width: ${100*t[0]}%;`),P(r,"class","text svelte-19hzrvz"),P(n,"class","progress-bar svelte-19hzrvz"),P(e,"class","container svelte-19hzrvz")},m(t,s){x(t,e,s),y(e,n),y(n,i),y(n,o),y(n,r),y(r,a)},p(t,e){1&e&&s!==(s=`width: ${100*t[0]}%;`)&&P(i,"style",s),1&e&&l!==(l=`Loading sound sample files... ${(100*t[0]).toFixed(0)}%`)&&I(a,l)},d(t){t&&T(e)}}}function pm(e){let n,i=1!==e[0]&&cm(e);return{c(){i&&i.c(),n=S("")},m(t,e){i&&i.m(t,e),x(t,n,e)},p(t,[e]){1!==t[0]?i?i.p(t,e):(i=cm(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},i:t,o:t,d(t){i&&i.d(t),t&&T(n)}}}function dm(t,e,n){let i;return c(t,Vf,(t=>n(0,i=t))),[i]}class fm extends mt{constructor(t){super(),_t(this,t,dm,pm,r,{})}}function _m(t){let e,n;return e=new tm({}),{c(){ct(e.$$.fragment)},m(t,i){pt(e,t,i),n=!0},i(t){n||(at(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function mm(t){let e,n;return e=new $_({}),{c(){ct(e.$$.fragment)},m(t,i){pt(e,t,i),n=!0},i(t){n||(at(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function gm(t){let e,n;return e=new q_({}),{c(){ct(e.$$.fragment)},m(t,i){pt(e,t,i),n=!0},i(t){n||(at(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function vm(t){let e,n,i,s,o,r,a,l;n=new um({});let h=t[0]&&_m(),u=t[1]&&mm(),c=t[2]&&gm();return a=new fm({}),{c(){e=A("div"),ct(n.$$.fragment),i=M(),h&&h.c(),s=M(),u&&u.c(),o=M(),c&&c.c(),r=M(),ct(a.$$.fragment),P(e,"class","wrapper")},m(t,p){x(t,e,p),pt(n,e,null),y(e,i),h&&h.m(e,null),y(e,s),u&&u.m(e,null),y(e,o),c&&c.m(e,null),y(e,r),pt(a,e,null),l=!0},p(t,[n]){t[0]?h?1&n&&at(h,1):(h=_m(),h.c(),at(h,1),h.m(e,s)):h&&(ot(),lt(h,1,1,(()=>{h=null})),rt()),t[1]?u?2&n&&at(u,1):(u=mm(),u.c(),at(u,1),u.m(e,o)):u&&(ot(),lt(u,1,1,(()=>{u=null})),rt()),t[2]?c?4&n&&at(c,1):(c=gm(),c.c(),at(c,1),c.m(e,r)):c&&(ot(),lt(c,1,1,(()=>{c=null})),rt())},i(t){l||(at(n.$$.fragment,t),at(h),at(u),at(c),at(a.$$.fragment,t),l=!0)},o(t){lt(n.$$.fragment,t),lt(h),lt(u),lt(c),lt(a.$$.fragment,t),l=!1},d(t){t&&T(e),dt(n),h&&h.d(),u&&u.d(),c&&c.d(),dt(a)}}}function ym(t,e,n){let i,s,o,r;return c(t,jf,(t=>n(3,i=t))),c(t,$f,(t=>n(0,s=t))),c(t,Wf,(t=>n(1,o=t))),c(t,Yf,(t=>n(2,r=t))),t.$$.update=()=>{t.$$.dirty},[s,o,r,i]}class wm extends mt{constructor(t){super(),_t(this,t,ym,vm,r,{})}}function bm(t){let e,n,i,s,o,r,a=t[1]&&Tm(),l=t[2]&&Cm();return i=new wm({}),o=new N_({}),{c(){a&&a.c(),e=M(),l&&l.c(),n=M(),ct(i.$$.fragment),s=M(),ct(o.$$.fragment)},m(t,h){a&&a.m(t,h),x(t,e,h),l&&l.m(t,h),x(t,n,h),pt(i,t,h),x(t,s,h),pt(o,t,h),r=!0},p(t,i){t[1]?a?2&i&&at(a,1):(a=Tm(),a.c(),at(a,1),a.m(e.parentNode,e)):a&&(ot(),lt(a,1,1,(()=>{a=null})),rt()),t[2]?l?4&i&&at(l,1):(l=Cm(),l.c(),at(l,1),l.m(n.parentNode,n)):l&&(ot(),lt(l,1,1,(()=>{l=null})),rt())},i(t){r||(at(a),at(l),at(i.$$.fragment,t),at(o.$$.fragment,t),r=!0)},o(t){lt(a),lt(l),lt(i.$$.fragment,t),lt(o.$$.fragment,t),r=!1},d(t){a&&a.d(t),t&&T(e),l&&l.d(t),t&&T(n),dt(i,t),t&&T(s),dt(o,t)}}}function xm(e){let n;return{c(){n=S("loading...")},m(t,e){x(t,n,e)},p:t,i:t,o:t,d(t){t&&T(n)}}}function Tm(t){let e,n;return e=new m_({}),{c(){ct(e.$$.fragment)},m(t,i){pt(e,t,i),n=!0},i(t){n||(at(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Cm(t){let e,n;return e=new S_({}),{c(){ct(e.$$.fragment)},m(t,i){pt(e,t,i),n=!0},i(t){n||(at(e.$$.fragment,t),n=!0)},o(t){lt(e.$$.fragment,t),n=!1},d(t){dt(e,t)}}}function Am(t){let e,n,i,s;const o=[xm,bm],r=[];function a(t,e){return t[0]?1:0}return n=a(t),i=r[n]=o[n](t),{c(){e=A("main"),i.c(),P(e,"class","svelte-1tv9nbq")},m(t,i){x(t,e,i),r[n].m(e,null),s=!0},p(t,[s]){let l=n;n=a(t),n===l?r[n].p(t,s):(ot(),lt(r[l],1,1,(()=>{r[l]=null})),rt(),i=r[n],i?i.p(t,s):(i=r[n]=o[n](t),i.c()),at(i,1),i.m(e,null))},i(t){s||(at(i),s=!0)},o(t){lt(i),s=!1},d(t){t&&T(e),r[n].d()}}}function km(t,e,n){let i,s;function o(){n_(),document.removeEventListener("click",o)}c(t,Xf,(t=>n(1,i=t))),c(t,Hf,(t=>n(2,s=t))),q((async()=>{await jn(),n(0,r=!0),async function(){const t=await fetch("./GSIM.json"),e=await t.json();let n=Object.keys(e).map((t=>e[t]));n=n.map(((t,e)=>(t.info.index=e,t.info.has_been_selected=!1,t))),Gf.set(n[Math.floor(Math.random()*n.length)]);const i=n.map((t=>t.data.size)),s=Math.max(...i),o=Math.min(...i);qf.set(n.map((t=>(t.data.size={min:o,max:s,val:t.data.size},t))))}(),async function(){const t=[...Object.values(Lf),...Object.values(Of),...Object.values(Nf),...Object.values(zf)].reduce(((t,e)=>({...t,[e]:"downloading"})),{}),e=Object.keys(t).length;function n(n){t[n]&&(t[n]="done");let i=Object.values(t).filter((t=>"done"===t)).length;Vf.update((()=>i/e))}for(let t in Lf)Jf.add(t,Lf[t],(()=>{n(Lf[t])}));for(let t in Of)Qf.add(t,Of[t],(()=>{n(Of[t])}));for(let t in Nf)t_.add(t,Nf[t],(()=>{n(Nf[t])}));for(let t in zf)e_.add(t,zf[t],(()=>{n(zf[t])}))}(),document.addEventListener("click",o)}));let r=!1;return[r,i,s]}return new class extends mt{constructor(t){super(),_t(this,t,km,Am,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
